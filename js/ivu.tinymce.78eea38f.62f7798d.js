(window.webpackJsonp=window.webpackJsonp||[]).push([["ivu.tinymce.78eea38f"],{"030f":function(t,n,e){(function(t){!function(){"use strict";var n=function(t){return function(n){return function(t){var n=typeof t;return null===t?"null":"object"===n&&(Array.prototype.isPrototypeOf(t)||t.constructor&&"Array"===t.constructor.name)?"array":"object"===n&&(String.prototype.isPrototypeOf(t)||t.constructor&&"String"===t.constructor.name)?"string":n}(n)===t}},e=function(t){return function(n){return typeof n===t}},o=function(t){return function(n){return t===n}},r=n("string"),i=n("object"),u=n("array"),a=o(null),c=e("boolean"),s=o(void 0),f=function(t){return null==t},l=function(t){return!f(t)},d=e("function"),m=e("number"),g=function(t,n){if(u(t)){for(var e=0,o=t.length;e<o;++e)if(!n(t[e]))return!1;return!0}return!1},p=function(){},h=function(t){return function(){return t()}},v=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return t(n.apply(null,e))}},b=function(t){return function(){return t}},y=function(t){return t},x=function(t,n){return t===n};function w(t){for(var n=[],e=1;e<arguments.length;e++)n[e-1]=arguments[e];return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var r=n.concat(e);return t.apply(null,r)}}var S=function(t){return function(n){return!t(n)}},k=function(t){return function(){throw new Error(t)}},C=b(!1),O=b(!0),_=tinymce.util.Tools.resolve("tinymce.ThemeManager"),T=function(){return(T=Object.assign||function(t){for(var n,e=1,o=arguments.length;e<o;e++)for(var r in n=arguments[e])Object.prototype.hasOwnProperty.call(n,r)&&(t[r]=n[r]);return t}).apply(this,arguments)};function E(t,n){var e={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&n.indexOf(o)<0&&(e[o]=t[o]);if(null!=t&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(o=Object.getOwnPropertySymbols(t);r<o.length;r++)n.indexOf(o[r])<0&&Object.prototype.propertyIsEnumerable.call(t,o[r])&&(e[o[r]]=t[o[r]])}return e}function D(t,n,e){if(e||2===arguments.length)for(var o,r=0,i=n.length;r<i;r++)!o&&r in n||(o||(o=Array.prototype.slice.call(n,0,r)),o[r]=n[r]);return t.concat(o||Array.prototype.slice.call(n))}var A=function(){return B},B=function(){var t=function(t){return t()},n=y;return{fold:function(t,n){return t()},isSome:C,isNone:O,getOr:n,getOrThunk:t,getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},getOrNull:b(null),getOrUndefined:b(void 0),or:n,orThunk:t,map:A,each:p,bind:A,exists:C,forall:O,filter:function(){return A()},toArray:function(){return[]},toString:b("none()")}}(),M=function(t){var n=b(t),e=function(){return r},o=function(n){return n(t)},r={fold:function(n,e){return e(t)},isSome:O,isNone:C,getOr:n,getOrThunk:n,getOrDie:n,getOrNull:n,getOrUndefined:n,or:e,orThunk:e,map:function(n){return M(n(t))},each:function(n){n(t)},bind:o,exists:o,forall:o,filter:function(n){return n(t)?r:B},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return r},F={some:M,none:A,from:function(t){return null==t?B:M(t)}},I=Array.prototype.slice,R=Array.prototype.indexOf,N=Array.prototype.push,P=function(t,n){return R.call(t,n)},V=function(t,n){return P(t,n)>-1},H=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return!0}return!1},L=function(t,n){for(var e=[],o=0;o<t;o++)e.push(n(o));return e},z=function(t,n){for(var e=[],o=0;o<t.length;o+=n){var r=I.call(t,o,o+n);e.push(r)}return e},U=function(t,n){for(var e=t.length,o=new Array(e),r=0;r<e;r++){var i=t[r];o[r]=n(i,r)}return o},j=function(t,n){for(var e=0,o=t.length;e<o;e++){n(t[e],e)}},W=function(t,n){for(var e=[],o=[],r=0,i=t.length;r<i;r++){var u=t[r];(n(u,r)?e:o).push(u)}return{pass:e,fail:o}},G=function(t,n){for(var e=[],o=0,r=t.length;o<r;o++){var i=t[o];n(i,o)&&e.push(i)}return e},X=function(t,n,e){return function(t,n){for(var e=t.length-1;e>=0;e--){n(t[e],e)}}(t,(function(t,o){e=n(e,t,o)})),e},q=function(t,n,e){return j(t,(function(t,o){e=n(e,t,o)})),e},Y=function(t,n){return function(t,n,e){for(var o=0,r=t.length;o<r;o++){var i=t[o];if(n(i,o))return F.some(i);if(e(i,o))break}return F.none()}(t,n,C)},K=function(t,n){for(var e=0,o=t.length;e<o;e++){if(n(t[e],e))return F.some(e)}return F.none()},J=function(t){for(var n=[],e=0,o=t.length;e<o;++e){if(!u(t[e]))throw new Error("Arr.flatten item "+e+" was not an array, input: "+t);N.apply(n,t[e])}return n},$=function(t,n){return J(U(t,n))},Q=function(t,n){for(var e=0,o=t.length;e<o;++e){if(!0!==n(t[e],e))return!1}return!0},Z=function(t){var n=I.call(t,0);return n.reverse(),n},tt=function(t,n){return G(t,(function(t){return!V(n,t)}))},nt=function(t,n){for(var e={},o=0,r=t.length;o<r;o++){var i=t[o];e[String(i)]=n(i,o)}return e},et=function(t){return[t]},ot=function(t,n){var e=I.call(t,0);return e.sort(n),e},rt=function(t,n){return n>=0&&n<t.length?F.some(t[n]):F.none()},it=function(t){return rt(t,0)},ut=function(t){return rt(t,t.length-1)},at=d(Array.from)?Array.from:function(t){return I.call(t)},ct=function(t,n){for(var e=0;e<t.length;e++){var o=n(t[e],e);if(o.isSome())return o}return F.none()},st=Object.keys,ft=Object.hasOwnProperty,lt=function(t,n){for(var e=st(t),o=0,r=e.length;o<r;o++){var i=e[o];n(t[i],i)}},dt=function(t,n){return mt(t,(function(t,e){return{k:e,v:n(t,e)}}))},mt=function(t,n){var e={};return lt(t,(function(t,o){var r=n(t,o);e[r.k]=r.v})),e},gt=function(t,n){var e={};return function(t,n,e,o){lt(t,(function(t,r){(n(t,r)?e:o)(t,r)}))}(t,n,function(t){return function(n,e){t[e]=n}}(e),p),e},pt=function(t,n){var e=[];return lt(t,(function(t,o){e.push(n(t,o))})),e},ht=function(t,n){for(var e=st(t),o=0,r=e.length;o<r;o++){var i=e[o],u=t[i];if(n(u,i,t))return F.some(u)}return F.none()},vt=function(t){return pt(t,y)},bt=function(t,n){return yt(t,n)?F.from(t[n]):F.none()},yt=function(t,n){return ft.call(t,n)},xt=function(t,n){return yt(t,n)&&void 0!==t[n]&&null!==t[n]},wt=function(t,n,e){return void 0===e&&(e=x),t.exists((function(t){return e(t,n)}))},St=function(t){for(var n=[],e=function(t){n.push(t)},o=0;o<t.length;o++)t[o].each(e);return n},kt=function(t,n,e){return t.isSome()&&n.isSome()?F.some(e(t.getOrDie(),n.getOrDie())):F.none()},Ct=function(t,n){return t?F.some(n):F.none()},Ot=function(t,n,e){return""===n||t.length>=n.length&&t.substr(e,e+n.length)===n},_t=function(t,n){return-1!==t.indexOf(n)},Tt=function(t,n){return Ot(t,n,0)},Et=function(t,n){return Ot(t,n,t.length-n.length)},Dt=function(t){return function(n){return n.replace(t,"")}}(/^\s+|\s+$/g),At=function(t){return t.length>0},Bt=function(t){return void 0!==t.style&&d(t.style.getPropertyValue)},Mt=function(t){if(null==t)throw new Error("Node cannot be null or undefined");return{dom:t}},Ft={fromHtml:function(t,n){var e=(n||document).createElement("div");if(e.innerHTML=t,!e.hasChildNodes()||e.childNodes.length>1)throw console.error("HTML does not have a single root node",t),new Error("HTML must have a single root node");return Mt(e.childNodes[0])},fromTag:function(t,n){var e=(n||document).createElement(t);return Mt(e)},fromText:function(t,n){var e=(n||document).createTextNode(t);return Mt(e)},fromDom:Mt,fromPoint:function(t,n,e){return F.from(t.dom.elementFromPoint(n,e)).map(Mt)}};"undefined"!=typeof window?window:Function("return this;")();var It,Rt=function(t){return t.dom.nodeName.toLowerCase()},Nt=function(t){return function(n){return function(t){return t.dom.nodeType}(n)===t}},Pt=Nt(1),Vt=Nt(3),Ht=Nt(9),Lt=Nt(11),zt=function(t){var n,e=!1;return function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];return e||(e=!0,n=t.apply(null,o)),n}},Ut=function(){return jt(0,0)},jt=function(t,n){return{major:t,minor:n}},Wt={nu:jt,detect:function(t,n){var e=String(n).toLowerCase();return 0===t.length?Ut():function(t,n){var e=function(t,n){for(var e=0;e<t.length;e++){var o=t[e];if(o.test(n))return o}}(t,n);if(!e)return{major:0,minor:0};var o=function(t){return Number(n.replace(e,"$"+t))};return jt(o(1),o(2))}(t,e)},unknown:Ut},Gt=function(t,n){var e=String(n).toLowerCase();return Y(t,(function(t){return t.search(e)}))},Xt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qt=function(t){return function(n){return _t(n,t)}},Yt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return _t(t,"edge/")&&_t(t,"chrome")&&_t(t,"safari")&&_t(t,"applewebkit")}},{name:"Chrome",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Xt],search:function(t){return _t(t,"chrome")&&!_t(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return _t(t,"msie")||_t(t,"trident")}},{name:"Opera",versionRegexes:[Xt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qt("firefox")},{name:"Safari",versionRegexes:[Xt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(_t(t,"safari")||_t(t,"mobile/"))&&_t(t,"applewebkit")}}],Kt=[{name:"Windows",search:qt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return _t(t,"iphone")||_t(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qt("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qt("linux"),versionRegexes:[]},{name:"Solaris",search:qt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qt("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:qt("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Jt={browsers:b(Yt),oses:b(Kt)},$t="Firefox",Qt=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isEdge:o("Edge"),isChrome:o("Chrome"),isIE:o("IE"),isOpera:o("Opera"),isFirefox:o($t),isSafari:o("Safari")}},Zt={unknown:function(){return Qt({current:void 0,version:Wt.unknown()})},nu:Qt,edge:b("Edge"),chrome:b("Chrome"),ie:b("IE"),opera:b("Opera"),firefox:b($t),safari:b("Safari")},tn="Windows",nn="Android",en="Solaris",on="FreeBSD",rn="ChromeOS",un=function(t){var n=t.current,e=t.version,o=function(t){return function(){return n===t}};return{current:n,version:e,isWindows:o(tn),isiOS:o("iOS"),isAndroid:o(nn),isOSX:o("OSX"),isLinux:o("Linux"),isSolaris:o(en),isFreeBSD:o(on),isChromeOS:o(rn)}},an={unknown:function(){return un({current:void 0,version:Wt.unknown()})},nu:un,windows:b(tn),ios:b("iOS"),android:b(nn),linux:b("Linux"),osx:b("OSX"),solaris:b(en),freebsd:b(on),chromeos:b(rn)},cn=function(t,n,e){var o=Jt.browsers(),r=Jt.oses(),i=n.bind((function(t){return function(t,n){return ct(n.brands,(function(n){var e=n.brand.toLowerCase();return Y(t,(function(t){var n;return e===(null===(n=t.brand)||void 0===n?void 0:n.toLowerCase())})).map((function(t){return{current:t.name,version:Wt.nu(parseInt(n.version,10),0)}}))}))}(o,t)})).orThunk((function(){return function(t,n){return Gt(t,n).map((function(t){var e=Wt.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(o,t)})).fold(Zt.unknown,Zt.nu),u=function(t,n){return Gt(t,n).map((function(t){var e=Wt.detect(t.versionRegexes,n);return{current:t.name,version:e}}))}(r,t).fold(an.unknown,an.nu);return{browser:i,os:u,deviceType:function(t,n,e,o){var r=t.isiOS()&&!0===/ipad/i.test(e),i=t.isiOS()&&!r,u=t.isiOS()||t.isAndroid(),a=u||o("(pointer:coarse)"),c=r||!i&&u&&o("(min-device-width:768px)"),s=i||u&&!c,f=n.isSafari()&&t.isiOS()&&!1===/safari/i.test(e),l=!s&&!c&&!f;return{isiPad:b(r),isiPhone:b(i),isTablet:b(c),isPhone:b(s),isTouch:b(a),isAndroid:t.isAndroid,isiOS:t.isiOS,isWebView:b(f),isDesktop:b(l)}}(u,i,t,e)}},sn=function(t){return window.matchMedia(t).matches},fn=zt((function(){return cn(navigator.userAgent,F.from(navigator.userAgentData),sn)})),ln=function(){return fn()},dn=function(t,n){var e=t.dom;if(1!==e.nodeType)return!1;var o=e;if(void 0!==o.matches)return o.matches(n);if(void 0!==o.msMatchesSelector)return o.msMatchesSelector(n);if(void 0!==o.webkitMatchesSelector)return o.webkitMatchesSelector(n);if(void 0!==o.mozMatchesSelector)return o.mozMatchesSelector(n);throw new Error("Browser lacks native selectors")},mn=function(t){return 1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType||0===t.childElementCount},gn=function(t,n){return t.dom===n.dom},pn=function(t,n){return function(t,n){return function(t,n,e){return 0!=(t.compareDocumentPosition(n)&e)}(t,n,Node.DOCUMENT_POSITION_CONTAINED_BY)}(t.dom,n.dom)},hn=function(t,n){return ln().browser.isIE()?pn(t,n):function(t,n){var e=t.dom,o=n.dom;return e!==o&&e.contains(o)}(t,n)},vn=function(t){return Ft.fromDom(t.dom.ownerDocument)},bn=function(t){return Ht(t)?t:vn(t)},yn=function(t){return Ft.fromDom(bn(t).dom.documentElement)},xn=function(t){return Ft.fromDom(bn(t).dom.defaultView)},wn=function(t){return F.from(t.dom.parentNode).map(Ft.fromDom)},Sn=function(t){return F.from(t.dom.offsetParent).map(Ft.fromDom)},kn=function(t){return U(t.dom.childNodes,Ft.fromDom)},Cn=function(t,n){var e=t.dom.childNodes;return F.from(e[n]).map(Ft.fromDom)},On=function(t,n){return{element:t,offset:n}},_n=function(t,n){var e=kn(t);return e.length>0&&n<e.length?On(e[n],0):On(t,n)},Tn=function(t){return Lt(t)&&l(t.dom.host)},En=d(Element.prototype.attachShadow)&&d(Node.prototype.getRootNode),Dn=b(En),An=En?function(t){return Ft.fromDom(t.dom.getRootNode())}:bn,Bn=function(t){return Tn(t)?t:Ft.fromDom(bn(t).dom.body)},Mn=function(t){var n=An(t);return Tn(n)?F.some(n):F.none()},Fn=function(t){return Ft.fromDom(t.dom.host)},In=function(t){return l(t.dom.shadowRoot)},Rn=function(t){var n=Vt(t)?t.dom.parentNode:t.dom;if(null==n||null===n.ownerDocument)return!1;var e=n.ownerDocument;return Mn(Ft.fromDom(n)).fold((function(){return e.body.contains(n)}),function(t,n){return function(e){return t(n(e))}}(Rn,Fn))},Nn=function(){return Pn(Ft.fromDom(document))},Pn=function(t){var n=t.dom.body;if(null==n)throw new Error("Body is not available yet");return Ft.fromDom(n)},Vn=function(t,n,e){if(!(r(e)||c(e)||m(e)))throw console.error("Invalid call to Attribute.set. Key ",n,":: Value ",e,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(n,e+"")},Hn=function(t,n,e){Vn(t.dom,n,e)},Ln=function(t,n){var e=t.dom;lt(n,(function(t,n){Vn(e,n,t)}))},zn=function(t,n){var e=t.dom.getAttribute(n);return null===e?void 0:e},Un=function(t,n){return F.from(zn(t,n))},jn=function(t,n){var e=t.dom;return!(!e||!e.hasAttribute)&&e.hasAttribute(n)},Wn=function(t,n){t.dom.removeAttribute(n)},Gn=function(t,n,e){if(!r(e))throw console.error("Invalid call to CSS.set. Property ",n,":: Value ",e,":: Element ",t),new Error("CSS value must be a string: "+e);Bt(t)&&t.style.setProperty(n,e)},Xn=function(t,n){Bt(t)&&t.style.removeProperty(n)},qn=function(t,n,e){var o=t.dom;Gn(o,n,e)},Yn=function(t,n){var e=t.dom;lt(n,(function(t,n){Gn(e,n,t)}))},Kn=function(t,n){var e=t.dom;lt(n,(function(t,n){t.fold((function(){Xn(e,n)}),(function(t){Gn(e,n,t)}))}))},Jn=function(t,n){var e=t.dom,o=window.getComputedStyle(e).getPropertyValue(n);return""!==o||Rn(t)?o:$n(e,n)},$n=function(t,n){return Bt(t)?t.style.getPropertyValue(n):""},Qn=function(t,n){var e=t.dom,o=$n(e,n);return F.from(o).filter((function(t){return t.length>0}))},Zn=function(t){var n={},e=t.dom;if(Bt(e))for(var o=0;o<e.style.length;o++){var r=e.style.item(o);n[r]=e.style[r]}return n},te=function(t,n,e){var o=Ft.fromTag(t);return qn(o,n,e),Qn(o,n).isSome()},ne=function(t,n){var e=t.dom;Xn(e,n),wt(Un(t,"style").map(Dt),"")&&Wn(t,"style")},ee=function(t){return t.dom.offsetWidth},oe=function(t,n){var e=function(e){var o=n(e);if(o<=0||null===o){var r=Jn(e,t);return parseFloat(r)||0}return o},o=function(t,n){return q(n,(function(n,e){var o=Jn(t,e),r=void 0===o?0:parseInt(o,10);return isNaN(r)?n:n+r}),0)};return{set:function(n,e){if(!m(e)&&!e.match(/^[0-9]+$/))throw new Error(t+".set accepts only positive integer values. Value was "+e);var o=n.dom;Bt(o)&&(o.style[t]=e+"px")},get:e,getOuter:e,aggregate:o,max:function(t,n,e){var r=o(t,e);return n>r?n-r:0}}},re=oe("height",(function(t){var n=t.dom;return Rn(t)?n.getBoundingClientRect().height:n.offsetHeight})),ie=function(t){return re.get(t)},ue=function(t){return re.getOuter(t)},ae=function(t,n){return{left:t,top:n,translate:function(e,o){return ae(t+e,n+o)}}},ce=ae,se=function(t,n){return void 0!==t?t:void 0!==n?n:0},fe=function(t){var n=t.dom.ownerDocument,e=n.body,o=n.defaultView,r=n.documentElement;if(e===t.dom)return ce(e.offsetLeft,e.offsetTop);var i=se(null==o?void 0:o.pageYOffset,r.scrollTop),u=se(null==o?void 0:o.pageXOffset,r.scrollLeft),a=se(r.clientTop,e.clientTop),c=se(r.clientLeft,e.clientLeft);return le(t).translate(u-c,i-a)},le=function(t){var n=t.dom,e=n.ownerDocument.body;return e===n?ce(e.offsetLeft,e.offsetTop):Rn(t)?function(t){var n=t.getBoundingClientRect();return ce(n.left,n.top)}(n):ce(0,0)},de=oe("width",(function(t){return t.dom.offsetWidth})),me=function(t){return de.get(t)},ge=function(t){return de.getOuter(t)},pe=function(t){var n=Ft.fromDom(function(t){if(Dn()&&l(t.target)){var n=Ft.fromDom(t.target);if(Pt(n)&&In(n)&&t.composed&&t.composedPath){var e=t.composedPath();if(e)return it(e)}}return F.from(t.target)}(t).getOr(t.target)),e=function(){return t.stopPropagation()},o=function(){return t.preventDefault()},r=v(o,e);return function(t,n,e,o,r,i,u){return{target:t,x:n,y:e,stop:o,prevent:r,kill:i,raw:u}}(n,t.clientX,t.clientY,e,o,r,t)},he=function(t,n,e,o,r){var i=function(t,n){return function(e){t(e)&&n(pe(e))}}(e,o);return t.dom.addEventListener(n,i,r),{unbind:w(ve,t,n,i,r)}},ve=function(t,n,e,o){t.dom.removeEventListener(n,e,o)},be=function(t,n){wn(t).each((function(e){e.dom.insertBefore(n.dom,t.dom)}))},ye=function(t,n){(function(t){return F.from(t.dom.nextSibling).map(Ft.fromDom)})(t).fold((function(){wn(t).each((function(t){we(t,n)}))}),(function(t){be(t,n)}))},xe=function(t,n){(function(t){return Cn(t,0)})(t).fold((function(){we(t,n)}),(function(e){t.dom.insertBefore(n.dom,e.dom)}))},we=function(t,n){t.dom.appendChild(n.dom)},Se=function(t,n){j(n,(function(n){we(t,n)}))},ke=function(t){t.dom.textContent="",j(kn(t),(function(t){Ce(t)}))},Ce=function(t){var n=t.dom;null!==n.parentNode&&n.parentNode.removeChild(n)},Oe=function(t){var n=kn(t);n.length>0&&function(t,n){j(n,(function(n){be(t,n)}))}(t,n),Ce(t)},_e=function(t){var n=void 0!==t?t.dom:document,e=n.body.scrollLeft||n.documentElement.scrollLeft,o=n.body.scrollTop||n.documentElement.scrollTop;return ce(e,o)},Te=function(t,n,e){var o=(void 0!==e?e.dom:document).defaultView;o&&o.scrollTo(t,n)},Ee=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},De=function(t){var n=void 0===t?window:t,e=n.document,o=_e(Ft.fromDom(e));return function(t){var n=void 0===t?window:t;return ln().browser.isFirefox()?F.none():F.from(n.visualViewport)}(n).fold((function(){var t=n.document.documentElement,e=t.clientWidth,r=t.clientHeight;return Ee(o.left,o.top,e,r)}),(function(t){return Ee(Math.max(t.pageLeft,o.left),Math.max(t.pageTop,o.top),t.width,t.height)}))},Ae=function(t,n){return t.view(n).fold(b([]),(function(n){var e=t.owner(n),o=Ae(t,e);return[n].concat(o)}))},Be=Object.freeze({__proto__:null,view:function(t){var n;return(t.dom===document?F.none():F.from(null===(n=t.dom.defaultView)||void 0===n?void 0:n.frameElement)).map(Ft.fromDom)},owner:function(t){return vn(t)}}),Me=function(t){var n=Ft.fromDom(document),e=_e(n);return function(t,n){var e=n.owner(t),o=Ae(n,e);return F.some(o)}(t,Be).fold(w(fe,t),(function(n){var o=le(t),r=X(n,(function(t,n){var e=le(n);return{left:t.left+e.left,top:t.top+e.top}}),{left:0,top:0});return ce(r.left+o.left+e.left,r.top+o.top+e.top)}))},Fe=function(t,n,e,o){return{x:t,y:n,width:e,height:o,right:t+e,bottom:n+o}},Ie=function(t){var n=fe(t),e=ge(t),o=ue(t);return Fe(n.left,n.top,e,o)},Re=function(t){var n=Me(t),e=ge(t),o=ue(t);return Fe(n.left,n.top,e,o)},Ne=function(){return De(window)},Pe=function(t){return{isValue:O,isError:C,getOr:b(t),getOrThunk:b(t),getOrDie:b(t),or:function(n){return Pe(t)},orThunk:function(n){return Pe(t)},fold:function(n,e){return e(t)},map:function(n){return Pe(n(t))},mapError:function(n){return Pe(t)},each:function(n){n(t)},bind:function(n){return n(t)},exists:function(n){return n(t)},forall:function(n){return n(t)},toOptional:function(){return F.some(t)}}},Ve=function(t){return{isValue:C,isError:O,getOr:y,getOrThunk:function(t){return t()},getOrDie:function(){return k(String(t))()},or:y,orThunk:function(t){return t()},fold:function(n,e){return n(t)},map:function(n){return Ve(t)},mapError:function(n){return Ve(n(t))},each:p,bind:function(n){return Ve(t)},exists:C,forall:O,toOptional:F.none}},He={value:Pe,error:Ve,fromOption:function(t,n){return t.fold((function(){return Ve(n)}),Pe)}};!function(t){t[t.Error=0]="Error",t[t.Value=1]="Value"}(It||(It={}));var Le=function(t,n,e){return t.stype===It.Error?n(t.serror):e(t.svalue)},ze=function(t){return{stype:It.Value,svalue:t}},Ue=function(t){return{stype:It.Error,serror:t}},je=function(t){return t.fold(Ue,ze)},We=function(t){return Le(t,He.error,He.value)},Ge=ze,Xe=function(t){var n=[],e=[];return j(t,(function(t){Le(t,(function(t){return e.push(t)}),(function(t){return n.push(t)}))})),{values:n,errors:e}},qe=Ue,Ye=function(t,n){return t.stype===It.Value?n(t.svalue):t},Ke=function(t,n){return t.stype===It.Error?n(t.serror):t},Je=function(t,n){return t.stype===It.Value?{stype:It.Value,svalue:n(t.svalue)}:t},$e=function(t,n){return t.stype===It.Error?{stype:It.Error,serror:n(t.serror)}:t},Qe=Le,Ze=function(t,n,e,o){return{tag:"field",key:t,newKey:n,presence:e,prop:o}},to=function(t,n,e){switch(t.tag){case"field":return n(t.key,t.newKey,t.presence,t.prop);case"custom":return e(t.newKey,t.instantiator)}},no=function(t){return function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];if(0===n.length)throw new Error("Can't merge zero objects");for(var o={},r=0;r<n.length;r++){var i=n[r];for(var u in i)yt(i,u)&&(o[u]=t(o[u],i[u]))}return o}},eo=no((function(t,n){return i(t)&&i(n)?eo(t,n):n})),oo=no((function(t,n){return n})),ro=function(t){return{tag:"defaultedThunk",process:t}},io=function(t){return ro(b(t))},uo=function(t){return{tag:"mergeWithThunk",process:t}},ao=function(t){return v(qe,J)(t)},co=function(t){var n=Xe(t);return n.errors.length>0?ao(n.errors):Ge(n.values)},so=function(t){return i(t)&&st(t).length>100?" removed due to size":JSON.stringify(t,null,2)},fo=function(t,n){return qe([{path:t,getErrorInfo:n}])},lo=function(t){return{extract:function(n,e){return Ke(t(e),(function(t){return function(t,n){return fo(t,b(n))}(n,t)}))},toString:b("val")}},mo=lo(Ge),go=function(t,n,e,o){return bt(n,e).fold((function(){return function(t,n,e){return fo(t,(function(){return'Could not find valid *required* value for "'+n+'" in '+so(e)}))}(t,e,n)}),o)},po=function(t,n,e,o){return o(bt(t,n).getOrThunk((function(){return e(t)})))},ho=function(t,n,e,o,r){var i=function(t){return r.extract(n.concat([o]),t)},u=function(t){return t.fold((function(){return Ge(F.none())}),(function(t){var e=r.extract(n.concat([o]),t);return Je(e,F.some)}))};switch(t.tag){case"required":return go(n,e,o,i);case"defaultedThunk":return po(e,o,t.process,i);case"option":return function(t,n,e){return e(bt(t,n))}(e,o,u);case"defaultedOptionThunk":return function(t,n,e,o){return o(bt(t,n).map((function(n){return!0===n?e(t):n})))}(e,o,t.process,u);case"mergeWithThunk":return po(e,o,b({}),(function(n){var o=eo(t.process(e),n);return i(o)}))}},vo=function(t){return{extract:function(n,e){return t().extract(n,e)},toString:function(){return t().toString()}}},bo=function(t){var n=yo(t),e=X(t,(function(t,n){return to(n,(function(n){var e;return eo(t,((e={})[n]=!0,e))}),b(t))}),{});return{extract:function(t,o){var r=c(o)?[]:function(t){return st(gt(t,l))}(o),i=G(r,(function(t){return!xt(e,t)}));return 0===i.length?n.extract(t,o):function(t,n){return fo(t,(function(){return"There are unsupported fields: ["+n.join(", ")+"] specified"}))}(t,i)},toString:n.toString}},yo=function(t){return{extract:function(n,e){return function(t,n,e){for(var o={},r=[],i=0,u=e;i<u.length;i++){var a=u[i];to(a,(function(e,i,u,a){var c=ho(u,t,n,e,a);Qe(c,(function(t){r.push.apply(r,t)}),(function(t){o[i]=t}))}),(function(t,e){o[t]=e(n)}))}return r.length>0?qe(r):Ge(o)}(n,e,t)},toString:function(){return"obj{\n"+U(t,(function(t){return to(t,(function(t,n,e,o){return t+" -> "+o.toString()}),(function(t,n){return"state("+t+")"}))})).join("\n")+"}"}}},xo=function(t){return{extract:function(n,e){var o=U(e,(function(e,o){return t.extract(n.concat(["["+o+"]"]),e)}));return co(o)},toString:function(){return"array("+t.toString()+")"}}},wo=function(t){return{extract:function(n,e){for(var o=[],r=0,i=t;r<i.length;r++){var u=i[r].extract(n,e);if(u.stype===It.Value)return u;o.push(u)}return co(o)},toString:function(){return"oneOf("+U(t,(function(t){return t.toString()})).join(", ")+")"}}},So=v(xo,yo),ko=b(mo),Co=function(t,n){return lo((function(e){var o=typeof e;return t(e)?Ge(e):qe("Expected type: "+n+" but got: "+o)}))},Oo=Co(m,"number"),_o=Co(r,"string"),To=Co(c,"boolean"),Eo=Co(d,"function"),Do=function(t){if(Object(t)!==t)return!0;switch({}.toString.call(t).slice(8,-1)){case"Boolean":case"Number":case"String":case"Date":case"RegExp":case"Blob":case"FileList":case"ImageData":case"ImageBitmap":case"ArrayBuffer":return!0;case"Array":case"Object":return Object.keys(t).every((function(n){return Do(t[n])}));default:return!1}},Ao=lo((function(t){return Do(t)?Ge(t):qe("Expected value to be acceptable for sending via postMessage")})),Bo=function(t,n,e,o){return bt(e,o).fold((function(){return function(t,n,e){return fo(t,(function(){return'The chosen schema: "'+e+'" did not exist in branches: '+so(n)}))}(t,e,o)}),(function(e){return e.extract(t.concat(["branch: "+o]),n)}))},Mo=function(t,n){return{extract:function(e,o){return bt(o,t).fold((function(){return function(t,n){return fo(t,(function(){return'Choice schema did not contain choice key: "'+n+'"'}))}(e,t)}),(function(t){return Bo(e,o,n,t)}))},toString:function(){return"chooseOn("+t+"). Possible values: "+st(n)}}},Fo=function(t){return lo((function(n){return t(n).fold(qe,Ge)}))},Io=function(t,n){return function(t,n){var e=function(n,e){return xo(lo(t)).extract(n,e)};return{extract:function(t,o){var r=st(o),i=e(t,r);return Ye(i,(function(e){var r=U(e,(function(t){return Ze(t,t,{tag:"required",process:{}},n)}));return yo(r).extract(t,o)}))},toString:function(){return"setOf("+n.toString()+")"}}}((function(n){return je(t(n))}),n)},Ro=function(t,n,e){return We(function(t,n,e){var o=n.extract([t],e);return $e(o,(function(t){return{input:e,errors:t}}))}(t,n,e))},No=function(t){return t.fold((function(t){throw new Error(Vo(t))}),y)},Po=function(t,n,e){return No(Ro(t,n,e))},Vo=function(t){return"Errors: \n"+function(t){var n=t.length>10?t.slice(0,10).concat([{path:[],getErrorInfo:b("... (only showing first ten failures)")}]):t;return U(n,(function(t){return"Failed path: ("+t.path.join(" > ")+")\n"+t.getErrorInfo()}))}(t.errors).join("\n")+"\n\nInput object: "+so(t.input)},Ho=function(t,n){return Mo(t,dt(n,yo))},Lo=Ze,zo=function(t,n){return{tag:"custom",newKey:t,instantiator:n}},Uo=function(t){return Fo((function(n){return V(t,n)?He.value(n):He.error('Unsupported value: "'+n+'", choose one of "'+t.join(", ")+'".')}))},jo=function(t){return Lo(t,t,{tag:"required",process:{}},ko())},Wo=function(t,n){return Lo(t,t,{tag:"required",process:{}},n)},Go=function(t){return Wo(t,Oo)},Xo=function(t){return Wo(t,_o)},qo=function(t,n){return Lo(t,t,{tag:"required",process:{}},Uo(n))},Yo=function(t){return Wo(t,Eo)},Ko=function(t,n){return Lo(t,t,{tag:"required",process:{}},yo(n))},Jo=function(t,n){return Lo(t,t,{tag:"required",process:{}},So(n))},$o=function(t,n){return Lo(t,t,{tag:"required",process:{}},xo(n))},Qo=function(t){return Lo(t,t,{tag:"option",process:{}},ko())},Zo=function(t,n){return Lo(t,t,{tag:"option",process:{}},n)},tr=function(t){return Zo(t,Oo)},nr=function(t){return Zo(t,_o)},er=function(t){return Zo(t,Eo)},or=function(t,n){return Zo(t,xo(n))},rr=function(t,n){return Zo(t,yo(n))},ir=function(t,n){return Zo(t,bo(n))},ur=function(t,n){return Lo(t,t,io(n),ko())},ar=function(t,n,e){return Lo(t,t,io(n),e)},cr=function(t,n){return ar(t,n,Oo)},sr=function(t,n){return ar(t,n,_o)},fr=function(t,n,e){return ar(t,n,Uo(e))},lr=function(t,n){return ar(t,n,To)},dr=function(t,n){return ar(t,n,Eo)},mr=function(t,n,e){return ar(t,n,xo(e))},gr=function(t,n,e){return ar(t,n,yo(e))},pr=function(t){var n=t;return{get:function(){return n},set:function(t){n=t}}},hr=function(t){if(!u(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var n=[],e={};return j(t,(function(o,r){var i=st(o);if(1!==i.length)throw new Error("one and only one name per case");var a=i[0],c=o[a];if(void 0!==e[a])throw new Error("duplicate key detected:"+a);if("cata"===a)throw new Error("cannot have a case named cata (sorry)");if(!u(c))throw new Error("case arguments must be an array");n.push(a),e[a]=function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];var i=e.length;if(i!==c.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+c.length+" ("+c+"), got "+i);var u=function(t){var o=st(t);if(n.length!==o.length)throw new Error("Wrong number of arguments to match. Expected: "+n.join(",")+"\nActual: "+o.join(","));if(!Q(n,(function(t){return V(o,t)})))throw new Error("Not all branches were specified when using match. Specified: "+o.join(", ")+"\nRequired: "+n.join(", "));return t[a].apply(null,e)};return{fold:function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];if(n.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+n.length);var i=n[r];return i.apply(null,e)},match:u,log:function(t){console.log(t,{constructors:n,constructor:a,params:e})}}}})),e};hr([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);var vr,br=function(t,n){return function(t,n){var e={};return lt(t,(function(t,o){V(n,o)||(e[o]=t)})),e}(t,n)},yr=function(t,n){return function(t,n){var e;return(e={})[t]=n,e}(t,n)},xr=function(t){return function(t){var n={};return j(t,(function(t){n[t.key]=t.value})),n}(t)},wr=function(t,n){var e=function(t){var n=[],e=[];return j(t,(function(t){t.fold((function(t){n.push(t)}),(function(t){e.push(t)}))})),{errors:n,values:e}}(t);return e.errors.length>0?function(t){return He.error(J(t))}(e.errors):function(t,n){return 0===t.length?He.value(n):He.value(eo(n,oo.apply(void 0,t)))}(e.values,n)},Sr=function(t){return d(t)?t:C},kr=function(t,n,e){for(var o=t.dom,r=Sr(e);o.parentNode;){o=o.parentNode;var i=Ft.fromDom(o),u=n(i);if(u.isSome())return u;if(r(i))break}return F.none()},Cr=function(t,n,e){var o=n(t),r=Sr(e);return o.orThunk((function(){return r(t)?F.none():kr(t,n,r)}))},Or=function(t,n){return gn(t.element,n.event.target)},_r={can:O,abort:C,run:p},Tr=function(t){if(!xt(t,"can")&&!xt(t,"abort")&&!xt(t,"run"))throw new Error("EventHandler defined by: "+JSON.stringify(t,null,2)+" does not have can, abort, or run!");return T(T({},_r),t)},Er=function(t){var n=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return q(t,(function(t,o){return t&&n(o).apply(void 0,e)}),!0)}}(t,(function(t){return t.can})),e=function(t,n){return function(){for(var e=[],o=0;o<arguments.length;o++)e[o]=arguments[o];return q(t,(function(t,o){return t||n(o).apply(void 0,e)}),!1)}}(t,(function(t){return t.abort}));return{can:n,abort:e,run:function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];j(t,(function(t){t.run.apply(void 0,n)}))}}},Dr=b,Ar=Dr("touchstart"),Br=Dr("touchmove"),Mr=Dr("touchend"),Fr=Dr("touchcancel"),Ir=Dr("mousedown"),Rr=Dr("mousemove"),Nr=Dr("mouseout"),Pr=Dr("mouseup"),Vr=Dr("mouseover"),Hr=Dr("focusin"),Lr=Dr("focusout"),zr=Dr("keydown"),Ur=Dr("keyup"),jr=Dr("input"),Wr=Dr("change"),Gr=Dr("click"),Xr=Dr("transitioncancel"),qr=Dr("transitionend"),Yr=Dr("transitionstart"),Kr=Dr("selectstart"),Jr=function(t){return b("alloy."+t)},$r={tap:Jr("tap")},Qr=Jr("focus"),Zr=Jr("blur.post"),ti=Jr("paste.post"),ni=Jr("receive"),ei=Jr("execute"),oi=Jr("focus.item"),ri=$r.tap,ii=Jr("longpress"),ui=Jr("sandbox.close"),ai=Jr("typeahead.cancel"),ci=Jr("system.init"),si=Jr("system.touchmove"),fi=Jr("system.touchend"),li=Jr("system.scroll"),di=Jr("system.resize"),mi=Jr("system.attached"),gi=Jr("system.detached"),pi=Jr("system.dismissRequested"),hi=Jr("system.repositionRequested"),vi=Jr("focusmanager.shifted"),bi=Jr("slotcontainer.visibility"),yi=Jr("change.tab"),xi=Jr("dismiss.tab"),wi=Jr("highlight"),Si=Jr("dehighlight"),ki=function(t,n){Ti(t,t.element,n,{})},Ci=function(t,n,e){Ti(t,t.element,n,e)},Oi=function(t){ki(t,ei())},_i=function(t,n,e){Ti(t,n,e,{})},Ti=function(t,n,e,o){var r=T({target:n},o);t.getSystem().triggerEvent(e,n,r)},Ei=function(t,n,e,o){t.getSystem().triggerEvent(e,n,o.event)},Di=function(t){return xr(t)},Ai=function(t,n){return{key:t,value:Tr({abort:n})}},Bi=function(t){return{key:t,value:Tr({run:function(t,n){n.event.prevent()}})}},Mi=function(t,n){return{key:t,value:Tr({run:n})}},Fi=function(t,n,e){return{key:t,value:Tr({run:function(t,o){n.apply(void 0,[t,o].concat(e))}})}},Ii=function(t){return function(n){return{key:t,value:Tr({run:function(t,e){Or(t,e)&&n(t,e)}})}}},Ri=function(t,n,e){return function(t,n){return Mi(t,(function(e,o){e.getSystem().getByUid(n).each((function(n){Ei(n,n.element,t,o)}))}))}(t,n.partUids[e])},Ni=function(t,n){return Mi(t,(function(t,e){var o=e.event,r=t.getSystem().getByDom(o.target).getOrThunk((function(){return Cr(o.target,(function(n){return t.getSystem().getByDom(n).toOptional()}),C).getOr(t)}));n(t,r,e)}))},Pi=function(t){return Mi(t,(function(t,n){n.cut()}))},Vi=function(t){return Mi(t,(function(t,n){n.stop()}))},Hi=function(t,n){return Ii(t)(n)},Li=Ii(mi()),zi=Ii(gi()),Ui=Ii(ci()),ji=function(t){return function(n){return Mi(t,n)}}(ei()),Wi=function(t){return t.dom.innerHTML},Gi=function(t,n){var e=vn(t).dom,o=Ft.fromDom(e.createDocumentFragment()),r=function(t,n){var e=(n||document).createElement("div");return e.innerHTML=t,kn(Ft.fromDom(e))}(n,e);Se(o,r),ke(t),we(t,o)},Xi=function(t){return function(t,n){return Ft.fromDom(t.dom.cloneNode(n))}(t,!1)},qi=function(t){return Tn(t)?"#shadow-root":function(t){var n=Ft.fromTag("div"),e=Ft.fromDom(t.dom.cloneNode(!0));return we(n,e),Wi(n)}(Xi(t))},Yi=function(t){return qi(t)},Ki=Di([function(t,n){return{key:t,value:Tr({can:n})}}(Qr(),(function(t,n){var e=n.event,o=e.originator,r=e.target;return!function(t,n,e){return gn(n,t.element)&&!gn(n,e)}(t,o,r)||(console.warn(Qr()+" did not get interpreted by the desired target. \nOriginator: "+Yi(o)+"\nTarget: "+Yi(r)+"\nCheck the "+Qr()+" event handlers"),!1)}))]),Ji=Object.freeze({__proto__:null,events:Ki}),$i=0,Qi=function(t){var n=(new Date).getTime();return t+"_"+Math.floor(1e9*Math.random())+ ++$i+String(n)},Zi=b("alloy-id-"),tu=b("data-alloy-id"),nu=Zi(),eu=tu(),ou=function(t,n){Object.defineProperty(t.dom,eu,{value:n,writable:!0})},ru=function(t){var n=Pt(t)?t.dom[eu]:null;return F.from(n)},iu=function(t){return Qi(t)},uu=y,au=function(t){var n=function(n){return"The component must be in a context to execute: "+n+(t?"\n"+Yi(t().element)+" is not in context.":"")},e=function(t){return function(){throw new Error(n(t))}},o=function(t){return function(){console.warn(n(t))}};return{debugInfo:b("fake"),triggerEvent:o("triggerEvent"),triggerFocus:o("triggerFocus"),triggerEscape:o("triggerEscape"),broadcast:o("broadcast"),broadcastOn:o("broadcastOn"),broadcastEvent:o("broadcastEvent"),build:e("build"),addToWorld:e("addToWorld"),removeFromWorld:e("removeFromWorld"),addToGui:e("addToGui"),removeFromGui:e("removeFromGui"),getByUid:e("getByUid"),getByDom:e("getByDom"),isConnected:C}},cu=au(),su=function(t){return U(t,(function(t){return Et(t,"/*")?t.substring(0,t.length-"/*".length):t}))},fu=function(t,n){var e=t.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:su(i)}},t},lu=Qi("alloy-premade"),du=function(t){return yr(lu,t)},mu=function(t){return function(t,n){var e=n.toString(),o=e.indexOf(")")+1,r=e.indexOf("("),i=e.substring(r+1,o-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:"OVERRIDE",parameters:su(i.slice(1))}},t}((function(n){for(var e=[],o=1;o<arguments.length;o++)e[o-1]=arguments[o];return t.apply(void 0,D([n.getApis(),n],e,!1))}),t)},gu={init:function(){return pu({readState:b("No State required")})}},pu=function(t){return t},hu=function(t,n){var e={};return lt(t,(function(t,o){lt(t,(function(t,r){var i=bt(e,r).getOr([]);e[r]=i.concat([n(o,t)])}))})),e},vu=function(t){return{classes:s(t.classes)?[]:t.classes,attributes:s(t.attributes)?{}:t.attributes,styles:s(t.styles)?{}:t.styles}},bu=function(t){return t.cHandler},yu=function(t,n){return{name:t,handler:n}},xu=function(t,n,e){var o=T(T({},e),function(t,n){var e={};return j(t,(function(t){e[t.name()]=t.handlers(n)})),e}(n,t));return hu(o,yu)},wu=function(t){var n=function(t){return d(t)?{can:O,abort:C,run:t}:t}(t);return function(t,e){for(var o=[],r=2;r<arguments.length;r++)o[r-2]=arguments[r];var i=[t,e].concat(o);n.abort.apply(void 0,i)?e.stop():n.can.apply(void 0,i)&&n.run.apply(void 0,i)}},Su=function(t,n,e){var o=n[e];return o?function(t,n,e,o){try{var r=ot(e,(function(e,r){var i=e[n],u=r[n],a=o.indexOf(i),c=o.indexOf(u);if(-1===a)throw new Error("The ordering for "+t+" does not have an entry for "+i+".\nOrder specified: "+JSON.stringify(o,null,2));if(-1===c)throw new Error("The ordering for "+t+" does not have an entry for "+u+".\nOrder specified: "+JSON.stringify(o,null,2));return a<c?-1:c<a?1:0}));return He.value(r)}catch(t){return He.error([t])}}("Event: "+e,"name",t,o).map((function(t){var n=U(t,(function(t){return t.handler}));return Er(n)})):function(t,n){return He.error(["The event ("+t+') has more than one behaviour that listens to it.\nWhen this occurs, you must specify an event ordering for the behaviours in your spec (e.g. [ "listing", "toggling" ]).\nThe behaviours that can trigger it are: '+JSON.stringify(U(n,(function(t){return t.name})),null,2)])}(e,t)},ku=function(t,n){var e=pt(t,(function(t,e){return(1===t.length?He.value(t[0].handler):Su(t,n,e)).map((function(o){var r=wu(o),i=t.length>1?G(n[e],(function(n){return H(t,(function(t){return t.name===n}))})).join(" > "):t[0].name;return yr(e,function(t,n){return{handler:t,purpose:n}}(r,i))}))}));return wr(e,{})},Cu="alloy.base.behaviour",Ou=yo([Lo("dom","dom",{tag:"required",process:{}},yo([jo("tag"),ur("styles",{}),ur("classes",[]),ur("attributes",{}),Qo("value"),Qo("innerHtml")])),jo("components"),jo("uid"),ur("events",{}),ur("apis",{}),Lo("eventOrder","eventOrder",function(t){return uo(b(t))}((vr={},vr[ei()]=["disabling",Cu,"toggling","typeaheadevents"],vr[Qr()]=[Cu,"focusing","keying"],vr[ci()]=[Cu,"disabling","toggling","representing"],vr[jr()]=[Cu,"representing","streaming","invalidating"],vr[gi()]=[Cu,"representing","item-events","tooltipping"],vr[Ir()]=["focusing",Cu,"item-type-events"],vr[Ar()]=["focusing",Cu,"item-type-events"],vr[Vr()]=["item-type-events","tooltipping"],vr[ni()]=["receiving","reflecting","tooltipping"],vr)),ko()),Qo("domModification")]),_u=function(t){return t.events},Tu=function(t,n){var e=zn(t,n);return void 0===e||""===e?[]:e.split(" ")},Eu=function(t){return void 0!==t.dom.classList},Du=function(t,n){return function(t,n,e){var o=Tu(t,n).concat([e]);return Hn(t,n,o.join(" ")),!0}(t,"class",n)},Au=function(t,n){return function(t,n,e){var o=G(Tu(t,n),(function(t){return t!==e}));return o.length>0?Hn(t,n,o.join(" ")):Wn(t,n),!1}(t,"class",n)},Bu=function(t,n){Eu(t)?t.dom.classList.add(n):Du(t,n)},Mu=function(t){0===(Eu(t)?t.dom.classList:function(t){return Tu(t,"class")}(t)).length&&Wn(t,"class")},Fu=function(t,n){Eu(t)?t.dom.classList.remove(n):Au(t,n);Mu(t)},Iu=function(t,n){return Eu(t)&&t.dom.classList.contains(n)},Ru=function(t,n){j(n,(function(n){Bu(t,n)}))},Nu=function(t,n){j(n,(function(n){Fu(t,n)}))},Pu=function(t){return t.dom.value},Vu=function(t,n){if(void 0===n)throw new Error("Value.set was undefined");t.dom.value=n},Hu=function(t,n){return function(t,n){var e=U(n,(function(t){return rr(t.name(),[jo("config"),ur("state",gu)])})),o=Ro("component.behaviours",yo(e),t.behaviours).fold((function(n){throw new Error(Vo(n)+"\nComplete spec:\n"+JSON.stringify(t,null,2))}),y);return{list:n,data:dt(o,(function(t){var n=t.map((function(t){return{config:t.config,state:t.state.init(t.config)}}));return b(n)}))}}(t,n)},Lu=function(t){var n=function(t){var n=bt(t,"behaviours").getOr({});return $(st(n),(function(t){var e=n[t];return l(e)?[e.me]:[]}))}(t);return Hu(t,n)},zu=function(t,n,e){var o=function(t){return T(T({},t.dom),{uid:t.uid,domChildren:U(t.components,(function(t){return t.element}))})}(t),r=function(t){return t.domModification.fold((function(){return vu({})}),vu)}(t),i={"alloy.base.modification":r};return function(t,n){return T(T({},t),{attributes:T(T({},t.attributes),n.attributes),styles:T(T({},t.styles),n.styles),classes:t.classes.concat(n.classes)})}(o,n.length>0?function(t,n,e,o){var r=T({},n);j(e,(function(n){r[n.name()]=n.exhibit(t,o)}));var i=hu(r,(function(t,n){return{name:t,modification:n}})),u=function(t){return X(t,(function(t,n){return T(T({},n.modification),t)}),{})},a=X(i.classes,(function(t,n){return n.modification.concat(t)}),[]),c=u(i.attributes),s=u(i.styles);return vu({classes:a,attributes:c,styles:s})}(e,i,n,o):r)},Uu=function(t,n,e){var o={"alloy.base.behaviour":_u(t)};return function(t,n,e,o){var r=xu(t,e,o);return ku(r,n)}(e,t.eventOrder,n,o).getOrDie()},ju=function(t){var n=function(){return f},e=pr(cu),o=No(function(t){return Ro("custom.definition",Ou,t)}(t)),r=Lu(t),i=function(t){return t.list}(r),u=function(t){return t.data}(r),a=function(t){var n=Ft.fromTag(t.tag);Ln(n,t.attributes),Ru(n,t.classes),Yn(n,t.styles),t.innerHtml.each((function(t){return Gi(n,t)}));var e=t.domChildren;return Se(n,e),t.value.each((function(t){Vu(n,t)})),t.uid,ou(n,t.uid),n}(zu(o,i,u)),c=Uu(o,i,u),s=pr(o.components),f={uid:t.uid,getSystem:e.get,config:function(n){var e=u;return(d(e[n.name()])?e[n.name()]:function(){throw new Error("Could not find "+n.name()+" in "+JSON.stringify(t,null,2))})()},hasConfigured:function(t){return d(u[t.name()])},spec:t,readState:function(t){return u[t]().map((function(t){return t.state.readState()})).getOr("not enabled")},getApis:function(){return o.apis},connect:function(t){e.set(t)},disconnect:function(){e.set(au(n))},element:a,syncComponents:function(){var t=kn(a),n=$(t,(function(t){return e.get().getByDom(t).fold((function(){return[]}),et)}));s.set(n)},components:s.get,events:c};return f},Wu=function(t){var n=uu(t),e=n.events,o=E(n,["events"]),r=function(t){var n=bt(t,"components").getOr([]);return U(n,Yu)}(o),i=T(T({},o),{events:T(T({},Ji),e),components:r});return He.value(ju(i))},Gu=function(t){var n=Ft.fromText(t);return Xu({element:n})},Xu=function(t){var n=Po("external.component",bo([jo("element"),Qo("uid")]),t),e=pr(au()),o=n.uid.getOrThunk((function(){return iu("external")}));ou(n.element,o);var r={uid:o,getSystem:e.get,config:F.none,hasConfigured:C,connect:function(t){e.set(t)},disconnect:function(){e.set(au((function(){return r})))},getApis:function(){return{}},element:n.element,spec:t,readState:b("No state"),syncComponents:p,components:b([]),events:{}};return du(r)},qu=iu,Yu=function(t){return function(t){return bt(t,lu)}(t).getOrThunk((function(){var n=function(t){return yt(t,"uid")}(t)?t:T({uid:qu("")},t);return Wu(n).getOrDie()}))},Ku=du;function Ju(t,n,e,o,r){return t(e,o)?F.some(e):d(r)&&r(e)?F.none():n(e,o,r)}var $u,Qu=function(t,n,e){for(var o=t.dom,r=d(e)?e:C;o.parentNode;){o=o.parentNode;var i=Ft.fromDom(o);if(n(i))return F.some(i);if(r(i))break}return F.none()},Zu=function(t,n,e){return Ju((function(t,n){return n(t)}),Qu,t,n,e)},ta=function(t,n,e){return Zu(t,n,e).isSome()},na=function(t,n,e){return Qu(t,(function(t){return dn(t,n)}),e)},ea=function(t,n){return function(t,n){return Y(t.dom.childNodes,(function(t){return n(Ft.fromDom(t))})).map(Ft.fromDom)}(t,(function(t){return dn(t,n)}))},oa=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return mn(e)?F.none():F.from(e.querySelector(t)).map(Ft.fromDom)}(n,t)},ra=function(t,n,e){return Ju((function(t,n){return dn(t,n)}),na,t,n,e)},ia=function(){var t=Qi("aria-owns");return{id:t,link:function(n){Hn(n,"aria-owns",t)},unlink:function(t){Wn(t,"aria-owns")}}},ua=function(t,n){return function(t){return Zu(t,(function(t){if(!Pt(t))return!1;var n=zn(t,"id");return void 0!==n&&n.indexOf("aria-owns")>-1})).bind((function(t){var n=zn(t,"id"),e=An(t);return oa(e,'[aria-owns="'+n+'"]')}))}(n).exists((function(n){return aa(t,n)}))},aa=function(t,n){return ta(n,(function(n){return gn(n,t.element)}),C)||ua(t,n)},ca="unknown";!function(t){t[t.STOP=0]="STOP",t[t.NORMAL=1]="NORMAL",t[t.LOGGING=2]="LOGGING"}($u||($u={}));var sa=pr({}),fa=function(t,n,e){switch(bt(sa.get(),t).orThunk((function(){var n=st(sa.get());return ct(n,(function(n){return t.indexOf(n)>-1?F.some(sa.get()[n]):F.none()}))})).getOr($u.NORMAL)){case $u.NORMAL:return e(ma());case $u.LOGGING:var o=function(t,n){var e=[],o=(new Date).getTime();return{logEventCut:function(t,n,o){e.push({outcome:"cut",target:n,purpose:o})},logEventStopped:function(t,n,o){e.push({outcome:"stopped",target:n,purpose:o})},logNoParent:function(t,n,o){e.push({outcome:"no-parent",target:n,purpose:o})},logEventNoHandlers:function(t,n){e.push({outcome:"no-handlers-left",target:n})},logEventResponse:function(t,n,o){e.push({outcome:"response",purpose:o,target:n})},write:function(){var r=(new Date).getTime();V(["mousemove","mouseover","mouseout",ci()],t)||console.log(t,{event:t,time:r-o,target:n.dom,sequence:U(e,(function(t){return V(["cut","stopped","response"],t.outcome)?"{"+t.purpose+"} "+t.outcome+" at ("+Yi(t.target)+")":t.outcome}))})}}}(t,n),r=e(o);return o.write(),r;case $u.STOP:return!0}},la=["alloy/data/Fields","alloy/debugging/Debugging"],da=function(t,n,e){return fa(t,n,e)},ma=b({logEventCut:p,logEventStopped:p,logNoParent:p,logEventNoHandlers:p,logEventResponse:p,write:p}),ga=b([jo("menu"),jo("selectedMenu")]),pa=b([jo("item"),jo("selectedItem")]);b(yo(pa().concat(ga())));var ha=b(yo(pa())),va=Ko("initSize",[jo("numColumns"),jo("numRows")]),ba=function(){return Ko("markers",[jo("backgroundMenu")].concat(ga()).concat(pa()))},ya=function(t){return Ko("markers",U(t,jo))},xa=function(t,n,e){return function(){var t=new Error;if(void 0!==t.stack){var n=t.stack.split("\n");return Y(n,(function(t){return t.indexOf("alloy")>0&&!H(la,(function(n){return t.indexOf(n)>-1}))})).getOr(ca)}}(),Lo(n,n,e,Fo((function(t){return He.value((function(){for(var n=[],e=0;e<arguments.length;e++)n[e]=arguments[e];return t.apply(void 0,n)}))})))},wa=function(t){return xa(0,t,io(p))},Sa=function(t){return xa(0,t,io(F.none))},ka=function(t){return xa(0,t,{tag:"required",process:{}})},Ca=function(t){return xa(0,t,{tag:"required",process:{}})},Oa=function(t,n){return zo(t,b(n))},_a=function(t){return zo(t,y)},Ta=b(va),Ea=function(t,n,e,o,r,i,u,a){return void 0===a&&(a=!1),{x:t,y:n,bubble:e,direction:o,placement:r,restriction:i,label:u+"-"+r,alwaysFit:a}},Da=hr([{southeast:[]},{southwest:[]},{northeast:[]},{northwest:[]},{south:[]},{north:[]},{east:[]},{west:[]}]),Aa=Da.southeast,Ba=Da.southwest,Ma=Da.northeast,Fa=Da.northwest,Ia=Da.south,Ra=Da.north,Na=Da.east,Pa=Da.west,Va=function(t,n,e,o){var r=t+n;return r>o?e:r<e?o:r},Ha=function(t,n,e){return Math.min(Math.max(t,n),e)},La=function(t,n){return nt(["left","right","top","bottom"],(function(e){return bt(n,e).map((function(n){return function(t,n){switch(n){case 1:return t.x;case 0:return t.x+t.width;case 2:return t.y;case 3:return t.y+t.height}}(t,n)}))}))},za="layout",Ua=function(t){return t.x},ja=function(t,n){return t.x+t.width/2-n.width/2},Wa=function(t,n){return t.x+t.width-n.width},Ga=function(t,n){return t.y-n.height},Xa=function(t){return t.y+t.height},qa=function(t,n){return t.y+t.height/2-n.height/2},Ya=function(t,n,e){return Ea(Ua(t),Xa(t),e.southeast(),Aa(),"southeast",La(t,{left:1,top:3}),za)},Ka=function(t,n,e){return Ea(Wa(t,n),Xa(t),e.southwest(),Ba(),"southwest",La(t,{right:0,top:3}),za)},Ja=function(t,n,e){return Ea(Ua(t),Ga(t,n),e.northeast(),Ma(),"northeast",La(t,{left:1,bottom:2}),za)},$a=function(t,n,e){return Ea(Wa(t,n),Ga(t,n),e.northwest(),Fa(),"northwest",La(t,{right:0,bottom:2}),za)},Qa=function(t,n,e){return Ea(ja(t,n),Ga(t,n),e.north(),Ra(),"north",La(t,{bottom:2}),za)},Za=function(t,n,e){return Ea(ja(t,n),Xa(t),e.south(),Ia(),"south",La(t,{top:3}),za)},tc=function(t,n,e){return Ea(function(t){return t.x+t.width}(t),qa(t,n),e.east(),Na(),"east",La(t,{left:0}),za)},nc=function(t,n,e){return Ea(function(t,n){return t.x-n.width}(t,n),qa(t,n),e.west(),Pa(),"west",La(t,{right:1}),za)},ec=function(){return[Ya,Ka,Ja,$a,Za,Qa,tc,nc]},oc=function(){return[Ka,Ya,$a,Ja,Za,Qa,tc,nc]},rc=function(){return[Ja,$a,Ya,Ka,Qa,Za]},ic=function(){return[$a,Ja,Ka,Ya,Qa,Za]},uc=function(){return[Ya,Ka,Ja,$a,Za,Qa]},ac=function(){return[Ka,Ya,$a,Ja,Za,Qa]},cc=Object.freeze({__proto__:null,events:function(t){return Di([Mi(ni(),(function(n,e){var o=t.channels,r=st(o),i=e,u=function(t,n){return n.universal?t:G(t,(function(t){return V(n.channels,t)}))}(r,i);j(u,(function(t){var e=o[t],r=e.schema,u=Po("channel["+t+"] data\nReceiver: "+Yi(n.element),r,i.data);e.onReceive(n,u)}))}))])}}),sc=[Wo("channels",Io(He.value,bo([ka("onReceive"),ur("schema",ko())])))],fc=function(t,n,e){return Ui((function(o,r){e(o,t,n)}))},lc=function(t,n,e){return function(t,n,e){var o=e.toString(),r=o.indexOf(")")+1,i=o.indexOf("("),u=o.substring(i+1,r-1).split(/,\s*/);return t.toFunctionAnnotation=function(){return{name:n,parameters:su(u.slice(0,1).concat(u.slice(3)))}},t}((function(o){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];var u=[o].concat(r);return o.config({name:b(t)}).fold((function(){throw new Error("We could not find any behaviour configuration for: "+t+". Using API: "+e)}),(function(t){var e=Array.prototype.slice.call(u,1);return n.apply(void 0,[o,t.config,t.state].concat(e))}))}),e,n)},dc=function(t){return{key:t,value:void 0}},mc=function(t,n,e,o,r,i,u){var a=function(t){return xt(t,e)?t[e]():F.none()},c=dt(r,(function(t,n){return lc(e,t,n)})),s=dt(i,(function(t,n){return fu(t,n)})),f=T(T(T({},s),c),{revoke:w(dc,e),config:function(n){var o=Po(e+"-config",t,n);return{key:e,value:{config:o,me:f,configAsRaw:zt((function(){return Po(e+"-config",t,n)})),initialConfig:n,state:u}}},schema:b(n),exhibit:function(t,n){return kt(a(t),bt(o,"exhibit"),(function(t,e){return e(n,t.config,t.state)})).getOrThunk((function(){return vu({})}))},name:b(e),handlers:function(t){return a(t).map((function(t){return bt(o,"events").getOr((function(){return{}}))(t.config,t.state)})).getOr({})}});return f},gc=function(t){return xr(t)},pc=bo([jo("fields"),jo("name"),ur("active",{}),ur("apis",{}),ur("state",gu),ur("extra",{})]),hc=function(t){var n=Po("Creating behaviour: "+t.name,pc,t);return function(t,n,e,o,r,i){var u=bo(t),a=rr(n,[ir("config",t)]);return mc(u,a,n,e,o,r,i)}(n.fields,n.name,n.active,n.apis,n.extra,n.state)},vc=bo([jo("branchKey"),jo("branches"),jo("name"),ur("active",{}),ur("apis",{}),ur("state",gu),ur("extra",{})]),bc=function(t){var n=Po("Creating behaviour: "+t.name,vc,t);return function(t,n,e,o,r,i){var u=t,a=rr(n,[Zo("config",t)]);return mc(u,a,n,e,o,r,i)}(Ho(n.branchKey,n.branches),n.name,n.active,n.apis,n.extra,n.state)},yc=b(void 0),xc=hc({fields:sc,name:"receiving",active:cc}),wc=Object.freeze({__proto__:null,exhibit:function(t,n){return vu({classes:[],styles:n.useFixed()?{}:{position:"relative"}})}}),Sc=function(){return Ft.fromDom(document)},kc=function(t){return t.dom.focus()},Cc=function(t){var n=An(t).dom;return t.dom===n.activeElement},Oc=function(t){return void 0===t&&(t=Sc()),F.from(t.dom.activeElement).map(Ft.fromDom)},_c=function(t){return Oc(An(t)).filter((function(n){return t.dom.contains(n.dom)}))},Tc=function(t,n){var e=An(n),o=Oc(e).bind((function(t){var e=function(n){return gn(t,n)};return e(n)?F.some(n):function(t,n){var e=function(t){for(var o=0;o<t.childNodes.length;o++){var r=Ft.fromDom(t.childNodes[o]);if(n(r))return F.some(r);var i=e(t.childNodes[o]);if(i.isSome())return i}return F.none()};return e(t.dom)}(n,e)})),r=t(n);return o.each((function(t){Oc(e).filter((function(n){return gn(n,t)})).fold((function(){kc(t)}),p)})),r},Ec=function(t,n,e,o,r){var i=function(t){return t+"px"};return{position:t,left:n.map(i),top:e.map(i),right:o.map(i),bottom:r.map(i)}},Dc=function(t,n){Kn(t,function(t){return T(T({},t),{position:F.some(t.position)})}(n))},Ac=hr([{none:[]},{relative:["x","y","width","height"]},{fixed:["x","y","width","height"]}]),Bc=function(t,n,e,o,r,i){var u=n.rect,a=u.x-e,c=u.y-o,s=r-(a+u.width),f=i-(c+u.height),l=F.some(a),d=F.some(c),m=F.some(s),g=F.some(f),p=F.none();return function(t,n,e,o,r,i,u,a,c){return t.fold(n,e,o,r,i,u,a,c)}(n.direction,(function(){return Ec(t,l,d,p,p)}),(function(){return Ec(t,p,d,m,p)}),(function(){return Ec(t,l,p,p,g)}),(function(){return Ec(t,p,p,m,g)}),(function(){return Ec(t,l,d,p,p)}),(function(){return Ec(t,l,p,p,g)}),(function(){return Ec(t,l,d,p,p)}),(function(){return Ec(t,p,d,m,p)}))},Mc=function(t,n){return t.fold((function(){var t=n.rect;return Ec("absolute",F.some(t.x),F.some(t.y),F.none(),F.none())}),(function(t,e,o,r){return Bc("absolute",n,t,e,o,r)}),(function(t,e,o,r){return Bc("fixed",n,t,e,o,r)}))},Fc=function(t,n){var e=w(Me,n),o=t.fold(e,e,(function(){var t=_e();return Me(n).translate(-t.left,-t.top)})),r=ge(n),i=ue(n);return Fe(o.left,o.top,r,i)},Ic=function(t,n){return n.fold((function(){return t.fold(Ne,Ne,Fe)}),(function(n){return t.fold(n,n,(function(){var e=n(),o=Rc(t,e.x,e.y);return Fe(o.left,o.top,e.width,e.height)}))}))},Rc=function(t,n,e){var o=ce(n,e);return t.fold(b(o),b(o),(function(){var t=_e();return o.translate(-t.left,-t.top)}))};Ac.none;var Nc,Pc=Ac.relative,Vc=Ac.fixed,Hc="data-alloy-placement",Lc=function(t){return Un(t,Hc)},zc=hr([{fit:["reposition"]},{nofit:["reposition","visibleW","visibleH","isVisible"]}]),Uc=function(t,n,e){var o=b(n.bottom-e.y),r=b(e.bottom-n.y),i=function(t,n,e,o){return t.fold(n,n,o,o,n,o,e,e)}(t,r,r,o),u=b(n.right-e.x),a=b(e.right-n.x);return{maxWidth:function(t,n,e,o){return t.fold(n,o,n,o,e,e,n,o)}(t,a,a,u),maxHeight:i}},jc=function(t,n,e,o){var r=t.bubble,i=r.offset,u=function(t,n,e){var o=function(o,r){return n[o].map((function(n){var i="top"===o||"bottom"===o,u=i?e.top:e.left,a=("left"===o||"top"===o?Math.max:Math.min)(n,r)+u;return i?Ha(a,t.y,t.bottom):Ha(a,t.x,t.right)})).getOr(r)},r=o("left",t.x),i=o("top",t.y),u=o("right",t.right),a=o("bottom",t.bottom);return Fe(r,i,u-r,a-i)}(o,t.restriction,i),a=t.x+i.left,c=t.y+i.top,s=Fe(a,c,n,e),f=function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.right,s=t.bottom,f=t.width,l=t.height;return{originInBounds:u>=e&&u<=r&&(a>=o&&a<=i),sizeInBounds:c<=r&&c>=e&&(s<=i&&s>=o),visibleW:Math.min(f,u>=e?r-u:c-e),visibleH:Math.min(l,a>=o?i-a:s-o)}}(s,u),l=f.originInBounds,d=f.sizeInBounds,m=f.visibleW,g=f.visibleH,p=l&&d,h=p?s:function(t,n){var e=n.x,o=n.y,r=n.right,i=n.bottom,u=t.x,a=t.y,c=t.width,s=t.height,f=Math.max(e,r-c),l=Math.max(o,i-s),d=Ha(u,e,f),m=Ha(a,o,l),g=Math.min(d+c,r)-d,p=Math.min(m+s,i)-m;return Fe(d,m,g,p)}(s,u),v=h.width>0&&h.height>0,b=Uc(t.direction,h,o),y=b.maxWidth,x={rect:h,maxHeight:b.maxHeight,maxWidth:y,direction:t.direction,placement:t.placement,classes:{on:r.classesOn,off:r.classesOff},layout:t.label,testY:c};return p||t.alwaysFit?zc.fit(x):zc.nofit(x,m,g,v)},Wc=function(t){var n=pr(F.none()),e=function(){return n.get().each(t)};return{clear:function(){e(),n.set(F.none())},isSet:function(){return n.get().isSome()},get:function(){return n.get()},set:function(t){e(),n.set(F.some(t))}}},Gc=function(){return Wc((function(t){return t.destroy()}))},Xc=function(){return Wc((function(t){return t.unbind()}))},qc=function(){var t=Wc(p);return T(T({},t),{on:function(n){return t.get().each(n)}})},Yc=O,Kc=function(t,n,e){return function(t,n,e,o){return he(t,n,e,o,!1)}(t,n,Yc,e)},Jc=function(t,n,e){return function(t,n,e,o){return he(t,n,e,o,!0)}(t,n,Yc,e)},$c=pe,Qc=["top","bottom","right","left"],Zc="data-alloy-transition-timer",ts=function(t,n){return function(t,n){return Q(n,(function(n){return Iu(t,n)}))}(t,n.classes)},ns=function(t,n){var e=function(t){return parseFloat(t).toFixed(3)};return ht(n,(function(n,o){return!function(t,n,e){return void 0===e&&(e=x),kt(t,n,e).getOr(t.isNone()&&n.isNone())}(t[o].map(e),n.map(e))})).isSome()},es=function(t){var n=function(n){var e=Jn(t,n),o=r(e)?e.split(/\s*,\s*/):[];return G(o,At)},e=function(t){if(r(t)&&/^[\d.]+/.test(t)){var n=parseFloat(t);return Et(t,"ms")?n:1e3*n}return 0},o=n("transition-delay"),i=n("transition-duration");return q(i,(function(t,n,r){var i=e(o[r])+e(n);return Math.max(t,i)}),0)},os=function(t,n){var e,o=Xc(),r=Xc(),i=function(n){var e,o=null!==(e=n.raw.pseudoElement)&&void 0!==e?e:"";return gn(n.target,t)&&function(t){return!At(t)}(o)&&V(Qc,n.raw.propertyName)},u=function(u){if(f(u)||i(u)){o.clear(),r.clear();var a=null==u?void 0:u.raw.type;(f(a)||a===qr())&&(clearTimeout(e),Wn(t,Zc),Nu(t,n.classes))}},a=function(){o.set(Kc(t,qr(),u)),r.set(Kc(t,Xr(),u))};if("ontransitionstart"in t.dom)var c=Kc(t,Yr(),(function(t){i(t)&&(c.unbind(),a())}));else a();var s=es(t);requestAnimationFrame((function(){e=setTimeout(u,s+17),Hn(t,Zc,e)}))},rs=function(t,n,e,o,r,i){var u=function(t,n,e){return e.exists((function(e){var o=t.mode;return"all"===o||e[o]!==n[o]}))}(o,r,i);if(u||ts(t,o)){qn(t,"position",e.position);var a=Fc(n,t),c=Mc(n,T(T({},r),{rect:a})),s=nt(Qc,(function(t){return c[t]}));ns(e,s)&&(Kn(t,s),u&&function(t,n){Ru(t,n.classes),Un(t,Zc).each((function(n){clearTimeout(parseInt(n,10)),Wn(t,Zc)})),os(t,n)}(t,o),ee(t))}else Nu(t,o.classes)},is=function(t,n,e,o){ne(n,"max-height"),ne(n,"max-width");var r=function(t){return{width:ge(t),height:ue(t)}}(n);return function(t,n,e,o,r,i){var u=o.width,a=o.height,c=function(n,c,s,f,l){var d=n(e,o,r,t,i),m=jc(d,u,a,i);return m.fold(b(m),(function(t,n,e,o){return(l===o?e>f||n>s:!l&&o)?m:zc.nofit(c,s,f,l)}))};return q(n,(function(t,n){var e=w(c,n);return t.fold(b(t),e)}),zc.nofit({rect:e,maxHeight:o.height,maxWidth:o.width,direction:Aa(),placement:"southeast",classes:{on:[],off:[]},layout:"none",testY:e.y},-1,-1,!1)).fold(y,y)}(n,o.preference,t,r,e,o.bounds)},us=function(t,n){!function(t,n){Hn(t,Hc,n)}(t,n.placement)},as=function(t,n){!function(t,n){var e=re.max(t,n,["margin-top","border-top-width","padding-top","padding-bottom","border-bottom-width","margin-bottom"]);qn(t,"max-height",e+"px")}(t,Math.floor(n))},cs=b((function(t,n){as(t,n),Yn(t,{"overflow-x":"hidden","overflow-y":"auto"})})),ss=b((function(t,n){as(t,n)})),fs=function(t,n,e){return void 0===t[n]?e:t[n]},ls=function(t,n,e,o){var r=is(t,n,e,o);return function(t,n,e){var o=Mc(e.origin,n);e.transition.each((function(r){rs(t,e.origin,o,r,n,e.lastPlacement)})),Dc(t,o)}(n,r,o),us(n,r),function(t,n){var e=n.classes;Nu(t,e.off),Ru(t,e.on)}(n,r),function(t,n,e){(0,e.maxHeightFunction)(t,n.maxHeight)}(n,r,o),function(t,n,e){(0,e.maxWidthFunction)(t,n.maxWidth)}(n,r,o),{layout:r.layout,placement:r.placement}},ds=["valignCentre","alignLeft","alignRight","alignCentre","top","bottom","left","right","inset"],ms=function(t,n,e,o){void 0===o&&(o=1);var r=t*o,i=n*o,u=function(t){return bt(e,t).getOr([])},a=function(t,n,e){var o=tt(ds,e);return{offset:ce(t,n),classesOn:$(e,u),classesOff:$(o,u)}};return{southeast:function(){return a(-t,n,["top","alignLeft"])},southwest:function(){return a(t,n,["top","alignRight"])},south:function(){return a(-t/2,n,["top","alignCentre"])},northeast:function(){return a(-t,-n,["bottom","alignLeft"])},northwest:function(){return a(t,-n,["bottom","alignRight"])},north:function(){return a(-t/2,-n,["bottom","alignCentre"])},east:function(){return a(t,-n/2,["valignCentre","left"])},west:function(){return a(-t,-n/2,["valignCentre","right"])},insetNortheast:function(){return a(r,i,["top","alignLeft","inset"])},insetNorthwest:function(){return a(-r,i,["top","alignRight","inset"])},insetNorth:function(){return a(-r/2,i,["top","alignCentre","inset"])},insetSoutheast:function(){return a(r,-i,["bottom","alignLeft","inset"])},insetSouthwest:function(){return a(-r,-i,["bottom","alignRight","inset"])},insetSouth:function(){return a(-r/2,-i,["bottom","alignCentre","inset"])},insetEast:function(){return a(-r,-i/2,["valignCentre","right","inset"])},insetWest:function(){return a(r,-i/2,["valignCentre","left","inset"])}}},gs=function(){return ms(0,0,{})},ps=y,hs=function(t,n){return function(e){return"rtl"===vs(e)?n:t}},vs=function(t){return"rtl"===Jn(t,"direction")?"rtl":"ltr"};!function(t){t.TopToBottom="toptobottom",t.BottomToTop="bottomtotop"}(Nc||(Nc={}));var bs="data-alloy-vertical-dir",ys=function(t){return ta(t,(function(t){return Pt(t)&&zn(t,"data-alloy-vertical-dir")===Nc.BottomToTop}))},xs=function(){return rr("layouts",[jo("onLtr"),jo("onRtl"),Qo("onBottomLtr"),Qo("onBottomRtl")])},ws=function(t,n,e,o,r,i,u){var a=u.map(ys).getOr(!1),c=n.layouts.map((function(n){return n.onLtr(t)})),s=n.layouts.map((function(n){return n.onRtl(t)})),f=a?n.layouts.bind((function(n){return n.onBottomLtr.map((function(n){return n(t)}))})).or(c).getOr(r):c.getOr(e),l=a?n.layouts.bind((function(n){return n.onBottomRtl.map((function(n){return n(t)}))})).or(s).getOr(i):s.getOr(o);return hs(f,l)(t)},Ss=[jo("hotspot"),Qo("bubble"),ur("overrides",{}),xs(),Oa("placement",(function(t,n,e){var o=n.hotspot,r=Fc(e,o.element),i=ws(t.element,n,uc(),ac(),rc(),ic(),F.some(n.hotspot.element));return F.some(ps({anchorBox:r,bubble:n.bubble.getOr(gs()),overrides:n.overrides,layouts:i,placer:F.none()}))}))],ks=[jo("x"),jo("y"),ur("height",0),ur("width",0),ur("bubble",gs()),ur("overrides",{}),xs(),Oa("placement",(function(t,n,e){var o=Rc(e,n.x,n.y),r=Fe(o.left,o.top,n.width,n.height),i=ws(t.element,n,ec(),oc(),ec(),oc(),F.none());return F.some(ps({anchorBox:r,bubble:n.bubble,overrides:n.overrides,layouts:i,placer:F.none()}))}))],Cs=hr([{screen:["point"]},{absolute:["point","scrollLeft","scrollTop"]}]),Os=function(t){return t.fold(y,(function(t,n,e){return t.translate(-n,-e)}))},_s=function(t){return t.fold(y,y)},Ts=function(t){return q(t,(function(t,n){return t.translate(n.left,n.top)}),ce(0,0))},Es=function(t){var n=U(t,_s);return Ts(n)},Ds=Cs.screen,As=Cs.absolute,Bs=function(t,n,e){var o=vn(t.element),r=_e(o),i=function(t,n,e){var o=xn(e.root).dom;return F.from(o.frameElement).map(Ft.fromDom).filter((function(n){var e=vn(n),o=vn(t.element);return gn(e,o)})).map(fe)}(t,0,e).getOr(r);return As(i,r.left,r.top)},Ms=function(t,n,e,o){var r=Ds(ce(t,n));return F.some(function(t,n,e){return{point:t,width:n,height:e}}(r,e,o))},Fs=function(t,n,e,o,r){return t.map((function(t){var i=[n,t.point],u=function(t,n,e,o){return t.fold(n,e,o)}(o,(function(){return Es(i)}),(function(){return Es(i)}),(function(){return function(t){var n=U(t,Os);return Ts(n)}(i)})),a=function(t,n,e,o){return{x:t,y:n,width:e,height:o}}(u.left,u.top,t.width,t.height),c=e.showAbove?rc():uc(),s=e.showAbove?ic():ac(),f=ws(r,e,c,s,c,s,F.none());return ps({anchorBox:a,bubble:e.bubble.getOr(gs()),overrides:e.overrides,layouts:f,placer:F.none()})}))},Is=[jo("node"),jo("root"),Qo("bubble"),xs(),ur("overrides",{}),ur("showAbove",!1),Oa("placement",(function(t,n,e){var o=Bs(t,0,n);return n.node.filter(Rn).bind((function(r){var i=r.dom.getBoundingClientRect(),u=Ms(i.left,i.top,i.width,i.height),a=n.node.getOr(t.element);return Fs(u,o,n,e,a)}))}))],Rs=function(t,n,e,o){return{start:t,soffset:n,finish:e,foffset:o}},Ns=hr([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ps=(Ns.before,Ns.on,Ns.after,function(t){return t.fold(y,y,y)}),Vs=hr([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Hs={domRange:Vs.domRange,relative:Vs.relative,exact:Vs.exact,exactFromRange:function(t){return Vs.exact(t.start,t.soffset,t.finish,t.foffset)},getWin:function(t){var n=function(t){return t.match({domRange:function(t){return Ft.fromDom(t.startContainer)},relative:function(t,n){return Ps(t)},exact:function(t,n,e,o){return t}})}(t);return xn(n)},range:Rs},Ls=function(t,n,e){var o=t.document.createRange();return function(t,n){n.fold((function(n){t.setStartBefore(n.dom)}),(function(n,e){t.setStart(n.dom,e)}),(function(n){t.setStartAfter(n.dom)}))}(o,n),function(t,n){n.fold((function(n){t.setEndBefore(n.dom)}),(function(n,e){t.setEnd(n.dom,e)}),(function(n){t.setEndAfter(n.dom)}))}(o,e),o},zs=function(t,n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},Us=function(t){return{left:t.left,top:t.top,right:t.right,bottom:t.bottom,width:t.width,height:t.height}},js=hr([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Ws=function(t,n,e){return n(Ft.fromDom(e.startContainer),e.startOffset,Ft.fromDom(e.endContainer),e.endOffset)},Gs=function(t,n){return function(t,n){var e=n.ltr();return e.collapsed?n.rtl().filter((function(t){return!1===t.collapsed})).map((function(t){return js.rtl(Ft.fromDom(t.endContainer),t.endOffset,Ft.fromDom(t.startContainer),t.startOffset)})).getOrThunk((function(){return Ws(0,js.ltr,e)})):Ws(0,js.ltr,e)}(0,function(t,n){return n.match({domRange:function(t){return{ltr:b(t),rtl:F.none}},relative:function(n,e){return{ltr:zt((function(){return Ls(t,n,e)})),rtl:zt((function(){return F.some(Ls(t,e,n))}))}},exact:function(n,e,o,r){return{ltr:zt((function(){return zs(t,n,e,o,r)})),rtl:zt((function(){return F.some(zs(t,o,r,n,e))}))}}})}(t,n))},Xs=function(t,n){return Gs(t,n).match({ltr:function(n,e,o,r){var i=t.document.createRange();return i.setStart(n.dom,e),i.setEnd(o.dom,r),i},rtl:function(n,e,o,r){var i=t.document.createRange();return i.setStart(o.dom,r),i.setEnd(n.dom,e),i}})};js.ltr,js.rtl;var qs,Ys=function(t,n){var e=function(n){return t(n)?F.from(n.dom.nodeValue):F.none()};return{get:function(o){if(!t(o))throw new Error("Can only get "+n+" value of a "+n+" node");return e(o).getOr("")},getOption:e,set:function(e,o){if(!t(e))throw new Error("Can only set raw "+n+" value of a "+n+" node");e.dom.nodeValue=o}}}(Vt,"text"),Ks=function(t){return Ys.getOption(t)},Js=["img","br"],$s=function(t){return function(t){return Ks(t).filter((function(t){return 0!==t.trim().length||t.indexOf(" ")>-1})).isSome()}(t)||V(Js,Rt(t))},Qs=function(t,n){var e=function(t){for(var o=kn(t),r=o.length-1;r>=0;r--){var i=o[r];if(n(i))return F.some(i);var u=e(i);if(u.isSome())return u}return F.none()};return e(t)},Zs=function(t,n){return function(t,n){var e=void 0===n?document:n.dom;return mn(e)?[]:U(e.querySelectorAll(t),Ft.fromDom)}(n,t)},tf=function(t,n,e,o){var r=function(t,n,e,o){var r=vn(t).dom.createRange();return r.setStart(t.dom,n),r.setEnd(e.dom,o),r}(t,n,e,o),i=gn(t,e)&&n===o;return r.collapsed&&!i},nf=function(t){if(t.rangeCount>0){var n=t.getRangeAt(0),e=t.getRangeAt(t.rangeCount-1);return F.some(Rs(Ft.fromDom(n.startContainer),n.startOffset,Ft.fromDom(e.endContainer),e.endOffset))}return F.none()},ef=function(t){if(null===t.anchorNode||null===t.focusNode)return nf(t);var n=Ft.fromDom(t.anchorNode),e=Ft.fromDom(t.focusNode);return tf(n,t.anchorOffset,e,t.focusOffset)?F.some(Rs(n,t.anchorOffset,e,t.focusOffset)):nf(t)},of=function(t){return function(t){return F.from(t.getSelection())}(t).filter((function(t){return t.rangeCount>0})).bind(ef)},rf=function(t,n){return function(t){var n=t.getClientRects(),e=n.length>0?n[0]:t.getBoundingClientRect();return e.width>0||e.height>0?F.some(e).map(Us):F.none()}(Xs(t,n))},uf=function(t,n){return function(t){var n=t.getBoundingClientRect();return n.width>0||n.height>0?F.some(n).map(Us):F.none()}(Xs(t,n))},af=function(t,n){return{element:t,offset:n}},cf=function(t,n){var e=kn(t);if(0===e.length)return af(t,n);if(n<e.length)return af(e[n],0);var o=e[e.length-1],r=Vt(o)?function(t){return Ys.get(t)}(o).length:kn(o).length;return af(o,r)},sf=function(t,n){return Vt(t)?af(t,n):cf(t,n)},ff=function(t,n){return n.getSelection.getOrThunk((function(){return function(){return of(t)}}))().map((function(t){var n=sf(t.start,t.soffset),e=sf(t.finish,t.foffset);return Hs.range(n.element,n.offset,e.element,e.offset)}))},lf=[Qo("getSelection"),jo("root"),Qo("bubble"),xs(),ur("overrides",{}),ur("showAbove",!1),Oa("placement",(function(t,n,e){var o=xn(n.root).dom,r=Bs(t,0,n),i=ff(o,n).bind((function(t){return uf(o,Hs.exactFromRange(t)).orThunk((function(){var n=Ft.fromText("\ufeff");be(t.start,n);var e=rf(o,Hs.exact(n,0,n,1));return Ce(n),e})).bind((function(t){return Ms(t.left,t.top,t.width,t.height)}))})),u=ff(o,n).bind((function(t){return Pt(t.start)?F.some(t.start):function(t){return wn(t)}(t.start)})).getOr(t.element);return Fs(i,r,n,e,u)}))],df="link-layout",mf=function(t){return t.x+t.width},gf=function(t,n){return t.x-n.width},pf=function(t,n){return t.y-n.height+t.height},hf=function(t){return t.y},vf=function(t,n,e){return Ea(mf(t),hf(t),e.southeast(),Aa(),"southeast",La(t,{left:0,top:2}),df)},bf=function(t,n,e){return Ea(gf(t,n),hf(t),e.southwest(),Ba(),"southwest",La(t,{right:1,top:2}),df)},yf=function(t,n,e){return Ea(mf(t),pf(t,n),e.northeast(),Ma(),"northeast",La(t,{left:0,bottom:3}),df)},xf=function(t,n,e){return Ea(gf(t,n),pf(t,n),e.northwest(),Fa(),"northwest",La(t,{right:1,bottom:3}),df)},wf=function(){return[vf,bf,yf,xf]},Sf=function(){return[bf,vf,xf,yf]},kf=[jo("item"),xs(),ur("overrides",{}),Oa("placement",(function(t,n,e){var o=Fc(e,n.item.element),r=ws(t.element,n,wf(),Sf(),wf(),Sf(),F.none());return F.some(ps({anchorBox:o,bubble:gs(),overrides:n.overrides,layouts:r,placer:F.none()}))}))],Cf=Ho("type",{selection:lf,node:Is,hotspot:Ss,submenu:kf,makeshift:ks}),Of=[$o("classes",_o),fr("mode","all",["all","layout","placement"])],_f=[ur("useFixed",C),Qo("getBounds")],Tf=[Wo("anchor",Cf),rr("transition",Of)],Ef=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u,a){var c=fs(u,"maxHeightFunction",cs()),s=fs(u,"maxWidthFunction",p),f=t.anchorBox,l=t.origin,d={bounds:Ic(l,i),origin:l,preference:o,maxHeightFunction:c,maxWidthFunction:s,lastPlacement:r,transition:a};return ls(f,n,e,d)}(function(t,n){return function(t,n){return{anchorBox:t,origin:n}}(t,n)}(e.anchorBox,n),r.element,e.bubble,e.layouts,i,o,e.overrides,u)},Df=function(t,n,e,o,r,i){var u=i.map(Ie);return Af(t,n,e,o,r,u)},Af=function(t,n,e,o,r,i){var u=Po("placement.info",yo(Tf),r),a=u.anchor,c=o.element,s=e.get(o.uid);Tc((function(){qn(c,"position","fixed");var r=Qn(c,"visibility");qn(c,"visibility","hidden");var f=n.useFixed()?function(){var t=document.documentElement;return Vc(0,0,t.clientWidth,t.clientHeight)}():function(t){var n=fe(t.element),e=t.element.dom.getBoundingClientRect();return Pc(n.left,n.top,e.width,e.height)}(t),l=a.placement,d=i.map(b).or(n.getBounds);l(t,a,f).each((function(n){var r=n.placer.getOr(Ef)(t,f,n,d,o,s,u.transition);e.set(o.uid,r)})),r.fold((function(){ne(c,"visibility")}),(function(t){qn(c,"visibility",t)})),Qn(c,"left").isNone()&&Qn(c,"top").isNone()&&Qn(c,"right").isNone()&&Qn(c,"bottom").isNone()&&wt(Qn(c,"position"),"fixed")&&ne(c,"position")}),c)},Bf=Object.freeze({__proto__:null,position:function(t,n,e,o,r){Df(t,n,e,o,r,F.none())},positionWithin:Df,positionWithinBounds:Af,getMode:function(t,n,e){return n.useFixed()?"fixed":"absolute"},reset:function(t,n,e,o){var r=o.element;j(["position","left","right","top","bottom"],(function(t){return ne(r,t)})),function(t){Wn(t,Hc)}(r),e.clear(o.uid)}}),Mf=Object.freeze({__proto__:null,init:function(){var t={};return pu({readState:function(){return t},clear:function(n){l(n)?delete t[n]:t={}},set:function(n,e){t[n]=e},get:function(n){return bt(t,n)}})}}),Ff=hc({fields:_f,name:"positioning",active:wc,apis:Bf,state:Mf}),If=function(t){ki(t,gi());var n=t.components();j(n,If)},Rf=function(t){var n=t.components();j(n,Rf),ki(t,mi())},Nf=function(t,n){we(t.element,n.element)},Pf=function(t,n){var e=t.components();!function(t){j(t.components(),(function(t){return Ce(t.element)})),ke(t.element),t.syncComponents()}(t);var o=tt(e,n);j(o,(function(n){If(n),t.getSystem().removeFromWorld(n)})),j(n,(function(n){n.getSystem().isConnected()?Nf(t,n):(t.getSystem().addToWorld(n),Nf(t,n),Rn(t.element)&&Rf(n)),t.syncComponents()}))},Vf=function(t,n){Hf(t,n,we)},Hf=function(t,n,e){t.getSystem().addToWorld(n),e(t.element,n.element),Rn(t.element)&&Rf(n),t.syncComponents()},Lf=function(t){If(t),Ce(t.element),t.getSystem().removeFromWorld(t)},zf=function(t){var n=wn(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}));Lf(t),n.each((function(t){t.syncComponents()}))},Uf=function(t){var n=t.components();j(n,Lf),ke(t.element),t.syncComponents()},jf=function(t,n){Wf(t,n,we)},Wf=function(t,n,e){e(t,n.element);var o=kn(n.element);j(o,(function(t){n.getByDom(t).each(Rf)}))},Gf=function(t){var n=kn(t.element);j(n,(function(n){t.getByDom(n).each(If)})),Ce(t.element)},Xf=function(t,n,e,o){e.get().each((function(n){Uf(t)}));var r=n.getAttachPoint(t);Vf(r,t);var i=t.getSystem().build(o);return Vf(t,i),e.set(i),i},qf=function(t,n,e,o){var r=Xf(t,n,e,o);return n.onOpen(t,r),r},Yf=function(t,n,e){e.get().each((function(o){Uf(t),zf(t),n.onClose(t,o),e.clear()}))},Kf=function(t,n,e){return e.isOpen()},Jf=function(t,n,e){var o=n.getAttachPoint(t);qn(t.element,"position",Ff.getMode(o)),function(t,n,e,o){Qn(t.element,n).fold((function(){Wn(t.element,e)}),(function(n){Hn(t.element,e,n)})),qn(t.element,n,o)}(t,"visibility",n.cloakVisibilityAttr,"hidden")},$f=function(t,n,e){(function(t){return H(["top","left","right","bottom"],(function(n){return Qn(t,n).isSome()}))})(t.element)||ne(t.element,"position"),function(t,n,e){Un(t.element,e).fold((function(){return ne(t.element,n)}),(function(e){return qn(t.element,n,e)}))}(t,"visibility",n.cloakVisibilityAttr)},Qf=Object.freeze({__proto__:null,cloak:Jf,decloak:$f,open:qf,openWhileCloaked:function(t,n,e,o,r){Jf(t,n),qf(t,n,e,o),r(),$f(t,n)},close:Yf,isOpen:Kf,isPartOf:function(t,n,e,o){return Kf(0,0,e)&&e.get().exists((function(e){return n.isPartOf(t,e,o)}))},getState:function(t,n,e){return e.get()},setContent:function(t,n,e,o){return e.get().map((function(){return Xf(t,n,e,o)}))}}),Zf=Object.freeze({__proto__:null,events:function(t,n){return Di([Mi(ui(),(function(e,o){Yf(e,t,n)}))])}}),tl=[wa("onOpen"),wa("onClose"),jo("isPartOf"),jo("getAttachPoint"),ur("cloakVisibilityAttr","data-precloak-visibility")],nl=Object.freeze({__proto__:null,init:function(){var t=qc(),n=b("not-implemented");return pu({readState:n,isOpen:t.isSet,clear:t.clear,set:t.set,get:t.get})}}),el=hc({fields:tl,name:"sandboxing",active:Zf,apis:Qf,state:nl}),ol=b("dismiss.popups"),rl=b("reposition.popups"),il=b("mouse.released"),ul=bo([ur("isExtraPart",C),rr("fireEventInstead",[ur("event",pi())])]),al=function(t){var n,e=Po("Dismissal",ul,t);return(n={})[ol()]={schema:bo([jo("target")]),onReceive:function(t,n){el.isOpen(t)&&(el.isPartOf(t,n.target)||e.isExtraPart(t,n.target)||e.fireEventInstead.fold((function(){return el.close(t)}),(function(n){return ki(t,n.event)})))}},n},cl=bo([rr("fireEventInstead",[ur("event",hi())]),Yo("doReposition")]),sl=function(t){var n,e=Po("Reposition",cl,t);return(n={})[rl()]={onReceive:function(t){el.isOpen(t)&&e.fireEventInstead.fold((function(){return e.doReposition(t)}),(function(n){return ki(t,n.event)}))}},n},fl=function(t,n,e){n.store.manager.onLoad(t,n,e)},ll=function(t,n,e){n.store.manager.onUnload(t,n,e)},dl=Object.freeze({__proto__:null,onLoad:fl,onUnload:ll,setValue:function(t,n,e,o){n.store.manager.setValue(t,n,e,o)},getValue:function(t,n,e){return n.store.manager.getValue(t,n,e)},getState:function(t,n,e){return e}}),ml=Object.freeze({__proto__:null,events:function(t,n){var e=t.resetOnDom?[Li((function(e,o){fl(e,t,n)})),zi((function(e,o){ll(e,t,n)}))]:[fc(t,n,fl)];return Di(e)}}),gl=function(){var t=pr(null);return pu({set:t.set,get:t.get,isNotSet:function(){return null===t.get()},clear:function(){t.set(null)},readState:function(){return{mode:"memory",value:t.get()}}})},pl=function(){var t=pr({}),n=pr({});return pu({readState:function(){return{mode:"dataset",dataByValue:t.get(),dataByText:n.get()}},lookup:function(e){return bt(t.get(),e).orThunk((function(){return bt(n.get(),e)}))},update:function(e){var o=t.get(),r=n.get(),i={},u={};j(e,(function(t){i[t.value]=t,bt(t,"meta").each((function(n){bt(n,"text").each((function(n){u[n]=t}))}))})),t.set(T(T({},o),i)),n.set(T(T({},r),u))},clear:function(){t.set({}),n.set({})}})},hl=Object.freeze({__proto__:null,memory:gl,dataset:pl,manual:function(){return pu({readState:p})},init:function(t){return t.store.manager.state(t)}}),vl=function(t,n,e,o){var r=n.store;e.update([o]),r.setValue(t,o),n.onSetValue(t,o)},bl=[Qo("initialValue"),jo("getFallbackEntry"),jo("getDataKey"),jo("setValue"),Oa("manager",{setValue:vl,getValue:function(t,n,e){var o=n.store,r=o.getDataKey(t);return e.lookup(r).getOrThunk((function(){return o.getFallbackEntry(r)}))},onLoad:function(t,n,e){n.store.initialValue.each((function(o){vl(t,n,e,o)}))},onUnload:function(t,n,e){e.clear()},state:pl})],yl=[jo("getValue"),ur("setValue",p),Qo("initialValue"),Oa("manager",{setValue:function(t,n,e,o){n.store.setValue(t,o),n.onSetValue(t,o)},getValue:function(t,n,e){return n.store.getValue(t)},onLoad:function(t,n,e){n.store.initialValue.each((function(e){n.store.setValue(t,e)}))},onUnload:p,state:gu.init})],xl=[Qo("initialValue"),Oa("manager",{setValue:function(t,n,e,o){e.set(o),n.onSetValue(t,o)},getValue:function(t,n,e){return e.get()},onLoad:function(t,n,e){n.store.initialValue.each((function(t){e.isNotSet()&&e.set(t)}))},onUnload:function(t,n,e){e.clear()},state:gl})],wl=[ar("store",{mode:"memory"},Ho("mode",{memory:xl,manual:yl,dataset:bl})),wa("onSetValue"),ur("resetOnDom",!1)],Sl=hc({fields:wl,name:"representing",active:ml,apis:dl,extra:{setValueFrom:function(t,n){var e=Sl.getValue(n);Sl.setValue(t,e)}},state:hl}),kl=function(t,n){return gr(t,{},U(n,(function(n){return function(t,n){return Lo(t,t,{tag:"option",process:{}},lo((function(e){return qe("The field: "+t+" is forbidden. "+n)})))}(n.name(),"Cannot configure "+n.name()+" for "+t)})).concat([zo("dump",y)]))},Cl=function(t){return t.dump},Ol=function(t,n){return T(T({},gc(n)),t.dump)},_l=kl,Tl=Ol,El="placeholder",Dl=hr([{single:["required","valueThunk"]},{multiple:["required","valueThunks"]}]),Al=function(t){return yt(t,"uiType")},Bl=function(t,n,e,o){return Al(e)&&e.uiType===El?function(t,n,e,o){return t.exists((function(t){return t!==e.owner}))?Dl.single(!0,b(e)):bt(o,e.name).fold((function(){throw new Error("Unknown placeholder component: "+e.name+"\nKnown: ["+st(o)+"]\nNamespace: "+t.getOr("none")+"\nSpec: "+JSON.stringify(e,null,2))}),(function(t){return t.replace()}))}(t,0,e,o):Dl.single(!1,b(e))},Ml=function(t,n,e,o){return Bl(t,0,e,o).fold((function(r,i){var u=Al(e)?i(n,e.config,e.validated):i(n),a=bt(u,"components").getOr([]),c=$(a,(function(e){return Ml(t,n,e,o)}));return[T(T({},u),{components:c})]}),(function(t,o){if(Al(e)){var r=o(n,e.config,e.validated);return e.validated.preprocess.getOr(y)(r)}return o(n)}))},Fl=function(t,n,e,o){var r=dt(o,(function(t,n){return function(t,n){var e=!1;return{name:b(t),required:function(){return n.fold((function(t,n){return t}),(function(t,n){return t}))},used:function(){return e},replace:function(){if(e)throw new Error("Trying to use the same placeholder more than once: "+t);return e=!0,n}}}(n,t)})),i=function(t,n,e,o){return $(e,(function(e){return Ml(t,n,e,o)}))}(t,n,e,r);return lt(r,(function(e){if(!1===e.used()&&e.required())throw new Error("Placeholder: "+e.name()+" was not found in components list\nNamespace: "+t.getOr("none")+"\nComponents: "+JSON.stringify(n.components,null,2))})),i},Il=Dl.single,Rl=Dl.multiple,Nl=b(El),Pl=hr([{required:["data"]},{external:["data"]},{optional:["data"]},{group:["data"]}]),Vl=ur("factory",{sketch:y}),Hl=ur("schema",[]),Ll=jo("name"),zl=Lo("pname","pname",ro((function(t){return"<alloy."+Qi(t.name)+">"})),ko()),Ul=zo("schema",(function(){return[Qo("preprocess")]})),jl=ur("defaults",b({})),Wl=ur("overrides",b({})),Gl=yo([Vl,Hl,Ll,zl,jl,Wl]),Xl=yo([Vl,Hl,Ll,jl,Wl]),ql=yo([Vl,Hl,Ll,zl,jl,Wl]),Yl=yo([Vl,Ul,Ll,jo("unit"),zl,jl,Wl]),Kl=function(t){return t.fold(F.some,F.none,F.some,F.some)},Jl=function(t){var n=function(t){return t.name};return t.fold(n,n,n,n)},$l=function(t,n){return function(e){var o=Po("Converting part type",n,e);return t(o)}},Ql=$l(Pl.required,Gl),Zl=$l(Pl.external,Xl),td=$l(Pl.optional,ql),nd=$l(Pl.group,Yl),ed=b("entirety"),od=Object.freeze({__proto__:null,required:Ql,external:Zl,optional:td,group:nd,asNamedPart:Kl,name:Jl,asCommon:function(t){return t.fold(y,y,y,y)},original:ed}),rd=function(t,n,e,o){return eo(n.defaults(t,e,o),e,{uid:t.partUids[n.name]},n.overrides(t,e,o))},id=function(t,n){var e={};return j(n,(function(n){Kl(n).each((function(n){var o=ud(t,n.pname);e[n.name]=function(e){var r=Po("Part: "+n.name+" in "+t,yo(n.schema),e);return T(T({},o),{config:e,validated:r})}}))})),e},ud=function(t,n){return{uiType:Nl(),owner:t,name:n}},ad=function(t,n,e){return{uiType:Nl(),owner:t,name:n,config:e,validated:{}}},cd=function(t){return $(t,(function(t){return t.fold(F.none,F.some,F.none,F.none).map((function(t){return Ko(t.name,t.schema.concat([_a(ed())]))})).toArray()}))},sd=function(t){return U(t,Jl)},fd=function(t,n,e){return function(t,n,e){var o={},r={};return j(e,(function(t){t.fold((function(t){o[t.pname]=Il(!0,(function(n,e,o){return t.factory.sketch(rd(n,t,e,o))}))}),(function(t){var e=n.parts[t.name];r[t.name]=b(t.factory.sketch(rd(n,t,e[ed()]),e))}),(function(t){o[t.pname]=Il(!1,(function(n,e,o){return t.factory.sketch(rd(n,t,e,o))}))}),(function(t){o[t.pname]=Rl(!0,(function(n,e,o){var r=n[t.name];return U(r,(function(e){return t.factory.sketch(eo(t.defaults(n,e,o),e,t.overrides(n,e)))}))}))}))})),{internals:b(o),externals:b(r)}}(0,n,e)},ld=function(t,n,e){return Fl(F.some(t),n,n.components,e)},dd=function(t,n,e){var o=n.partUids[e];return t.getSystem().getByUid(o).toOptional()},md=function(t,n,e){return dd(t,n,e).getOrDie("Could not find part: "+e)},gd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=b(i.getByUid(r[t]))})),o},pd=function(t,n){var e=t.getSystem();return dt(n.partUids,(function(t,n){return b(e.getByUid(t))}))},hd=function(t){return st(t.partUids)},vd=function(t,n,e){var o={},r=n.partUids,i=t.getSystem();return j(e,(function(t){o[t]=b(i.getByUid(r[t]).getOrDie())})),o},bd=function(t,n){var e=sd(n);return xr(U(e,(function(n){return{key:n,value:t+"-"+n}})))},yd=function(t){return Lo("partUids","partUids",uo((function(n){return bd(n.uid,t)})),ko())},xd=Object.freeze({__proto__:null,generate:id,generateOne:ad,schemas:cd,names:sd,substitutes:fd,components:ld,defaultUids:bd,defaultUidsSchema:yd,getAllParts:pd,getAllPartNames:hd,getPart:dd,getPartOrDie:md,getParts:gd,getPartsOrDie:vd}),wd=function(t,n,e,o,r){var i=function(t,n){return(t.length>0?[Ko("parts",t)]:[]).concat([jo("uid"),ur("dom",{}),ur("components",[]),_a("originalSpec"),ur("debug.sketcher",{})]).concat(n)}(o,r);return Po(t+" [SpecSchema]",bo(i.concat(n)),e)},Sd=function(t,n,e,o,r){var i=kd(r),u=cd(e),a=yd(e),c=wd(t,n,i,u,[a]),s=fd(0,c,e);return o(c,ld(t,c,s.internals()),i,s.externals())},kd=function(t){return function(t){return yt(t,"uid")}(t)?t:T(T({},t),{uid:iu("uid")})},Cd=bo([jo("name"),jo("factory"),jo("configFields"),ur("apis",{}),ur("extraApis",{})]),Od=bo([jo("name"),jo("factory"),jo("configFields"),jo("partFields"),ur("apis",{}),ur("extraApis",{})]),_d=function(t){var n=Po("Sketcher for "+t.name,Cd,t),e=dt(n.apis,mu),o=dt(n.extraApis,(function(t,n){return fu(t,n)}));return T(T({name:n.name,configFields:n.configFields,sketch:function(t){return function(t,n,e,o){var r=kd(o);return e(wd(t,n,r,[],[]),r)}(n.name,n.configFields,n.factory,t)}},e),o)},Td=function(t){var n=Po("Sketcher for "+t.name,Od,t),e=id(n.name,n.partFields),o=dt(n.apis,mu),r=dt(n.extraApis,(function(t,n){return fu(t,n)}));return T(T({name:n.name,partFields:n.partFields,configFields:n.configFields,sketch:function(t){return Sd(n.name,n.configFields,n.partFields,n.factory,t)},parts:e},o),r)},Ed=function(t){return"input"===Rt(t)&&"radio"!==zn(t,"type")||"textarea"===Rt(t)},Dd=Object.freeze({__proto__:null,getCurrent:function(t,n,e){return n.find(t)}}),Ad=[jo("find")],Bd=hc({fields:Ad,name:"composing",apis:Dd}),Md=["input","button","textarea","select"],Fd=function(t,n,e){(n.disabled()?Hd:Ld)(t,n)},Id=function(t,n){return!0===n.useNative&&V(Md,Rt(t.element))},Rd=function(t){Hn(t.element,"disabled","disabled")},Nd=function(t){Wn(t.element,"disabled")},Pd=function(t){Hn(t.element,"aria-disabled","true")},Vd=function(t){Hn(t.element,"aria-disabled","false")},Hd=function(t,n,e){n.disableClass.each((function(n){Bu(t.element,n)})),(Id(t,n)?Rd:Pd)(t),n.onDisabled(t)},Ld=function(t,n,e){n.disableClass.each((function(n){Fu(t.element,n)})),(Id(t,n)?Nd:Vd)(t),n.onEnabled(t)},zd=function(t,n){return Id(t,n)?function(t){return jn(t.element,"disabled")}(t):function(t){return"true"===zn(t.element,"aria-disabled")}(t)},Ud=Object.freeze({__proto__:null,enable:Ld,disable:Hd,isDisabled:zd,onLoad:Fd,set:function(t,n,e,o){(o?Hd:Ld)(t,n)}}),jd=Object.freeze({__proto__:null,exhibit:function(t,n){return vu({classes:n.disabled()?n.disableClass.toArray():[]})},events:function(t,n){return Di([Ai(ei(),(function(n,e){return zd(n,t)})),fc(t,n,Fd)])}}),Wd=[dr("disabled",C),ur("useNative",!0),Qo("disableClass"),wa("onDisabled"),wa("onEnabled")],Gd=hc({fields:Wd,name:"disabling",active:jd,apis:Ud}),Xd=function(t,n,e,o){var r=Zs(t.element,"."+n.highlightClass);j(r,(function(e){H(o,(function(t){return t.element===e}))||(Fu(e,n.highlightClass),t.getSystem().getByDom(e).each((function(e){n.onDehighlight(t,e),ki(e,Si())})))}))},qd=function(t,n,e,o){Xd(t,n,0,[o]),Yd(t,n,e,o)||(Bu(o.element,n.highlightClass),n.onHighlight(t,o),ki(o,wi()))},Yd=function(t,n,e,o){return Iu(o.element,n.highlightClass)},Kd=function(t,n,e,o){var r=Zs(t.element,"."+n.itemClass);return F.from(r[o]).fold((function(){return He.error(new Error("No element found with index "+o))}),t.getSystem().getByDom)},Jd=function(t,n,e){return oa(t.element,"."+n.itemClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},$d=function(t,n,e){var o=Zs(t.element,"."+n.itemClass);return(o.length>0?F.some(o[o.length-1]):F.none()).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},Qd=function(t,n,e,o){var r=Zs(t.element,"."+n.itemClass);return K(r,(function(t){return Iu(t,n.highlightClass)})).bind((function(n){var e=Va(n,o,0,r.length-1);return t.getSystem().getByDom(r[e]).toOptional()}))},Zd=function(t,n,e){var o=Zs(t.element,"."+n.itemClass);return St(U(o,(function(n){return t.getSystem().getByDom(n).toOptional()})))},tm=Object.freeze({__proto__:null,dehighlightAll:function(t,n,e){return Xd(t,n,0,[])},dehighlight:function(t,n,e,o){Yd(t,n,e,o)&&(Fu(o.element,n.highlightClass),n.onDehighlight(t,o),ki(o,Si()))},highlight:qd,highlightFirst:function(t,n,e){Jd(t,n).each((function(o){qd(t,n,e,o)}))},highlightLast:function(t,n,e){$d(t,n).each((function(o){qd(t,n,e,o)}))},highlightAt:function(t,n,e,o){Kd(t,n,e,o).fold((function(t){throw t}),(function(o){qd(t,n,e,o)}))},highlightBy:function(t,n,e,o){var r=Zd(t,n);Y(r,o).each((function(o){qd(t,n,e,o)}))},isHighlighted:Yd,getHighlighted:function(t,n,e){return oa(t.element,"."+n.highlightClass).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))},getFirst:Jd,getLast:$d,getPrevious:function(t,n,e){return Qd(t,n,0,-1)},getNext:function(t,n,e){return Qd(t,n,0,1)},getCandidates:Zd}),nm=[jo("highlightClass"),jo("itemClass"),wa("onHighlight"),wa("onDehighlight")],em=hc({fields:nm,name:"highlighting",apis:tm}),om=[8],rm=[9],im=[13],um=[27],am=[32],cm=[37],sm=[38],fm=[39],lm=[40],dm=function(t,n,e){var o=Z(t.slice(0,n)),r=Z(t.slice(n+1));return Y(o.concat(r),e)},mm=function(t,n,e){var o=Z(t.slice(0,n));return Y(o,e)},gm=function(t,n,e){var o=t.slice(0,n),r=t.slice(n+1);return Y(r.concat(o),e)},pm=function(t,n,e){var o=t.slice(n+1);return Y(o,e)},hm=function(t){return function(n){var e=n.raw;return V(t,e.which)}},vm=function(t){return function(n){return Q(t,(function(t){return t(n)}))}},bm=function(t){return!0===t.raw.shiftKey},ym=function(t){return!0===t.raw.ctrlKey},xm=S(bm),wm=function(t,n){return{matches:t,classification:n}},Sm=function(t,n,e){n.exists((function(t){return e.exists((function(n){return gn(n,t)}))}))||Ci(t,vi(),{prevFocus:n,newFocus:e})},km=function(){var t=function(t){return _c(t.element)};return{get:t,set:function(n,e){var o=t(n);n.getSystem().triggerFocus(e,n.element);var r=t(n);Sm(n,o,r)}}},Cm=function(){var t=function(t){return em.getHighlighted(t).map((function(t){return t.element}))};return{get:t,set:function(n,e){var o=t(n);n.getSystem().getByDom(e).fold(p,(function(t){em.highlight(n,t)}));var r=t(n);Sm(n,o,r)}}};!function(t){t.OnFocusMode="onFocus",t.OnEnterOrSpaceMode="onEnterOrSpace",t.OnApiMode="onApi"}(qs||(qs={}));var Om=function(t,n,e,o,r){var i=function(t,n,e,o,r){return function(t,n){return Y(t,(function(t){return t.matches(n)})).map((function(t){return t.classification}))}(e(t,n,o,r),n.event).bind((function(e){return e(t,n,o,r)}))},u={schema:function(){return t.concat([ur("focusManager",km()),ar("focusInside","onFocus",Fo((function(t){return V(["onFocus","onEnterOrSpace","onApi"],t)?He.value(t):He.error("Invalid value for focusInside")}))),Oa("handler",u),Oa("state",n),Oa("sendFocusIn",r)])},processKey:i,toEvents:function(t,n){var u=t.focusInside!==qs.OnFocusMode?F.none():r(t).map((function(e){return Mi(Qr(),(function(o,r){e(o,t,n),r.stop()}))})),a=function(e,o){var i=hm(am.concat(im))(o.event);t.focusInside===qs.OnEnterOrSpaceMode&&i&&Or(e,o)&&r(t).each((function(r){r(e,t,n),o.stop()}))},c=[Mi(zr(),(function(o,r){i(o,r,e,t,n).fold((function(){a(o,r)}),(function(t){r.stop()}))})),Mi(Ur(),(function(e,r){i(e,r,o,t,n).each((function(t){r.stop()}))}))];return Di(u.toArray().concat(c))}};return u},_m=function(t){var n=[Qo("onEscape"),Qo("onEnter"),ur("selector",'[data-alloy-tabstop="true"]:not(:disabled)'),ur("firstTabstop",0),ur("useTabstopAt",O),Qo("visibilitySelector")].concat([t]),e=function(t,n){var e=t.visibilitySelector.bind((function(t){return ra(n,t)})).getOr(n);return ie(e)>0},o=function(t,n){var o=Zs(t.element,n.selector),r=G(o,(function(t){return e(n,t)}));return F.from(r[n.firstTabstop])},r=function(t,n){return e(t,n)&&t.useTabstopAt(n)},i=function(t,n,e){o(t,n).each((function(e){n.focusManager.set(t,e)}))},u=function(t,n,e,o,i){return i(n,e,(function(t){return r(o,t)})).fold((function(){return o.cyclic?F.some(!0):F.none()}),(function(n){return o.focusManager.set(t,n),F.some(!0)}))},a=function(t,n,e,o){var r=Zs(t.element,e.selector);return function(t,n){return n.focusManager.get(t).bind((function(t){return ra(t,n.selector)}))}(t,e).bind((function(n){return K(r,w(gn,n)).bind((function(n){return u(t,r,n,e,o)}))}))},c=b([wm(vm([bm,hm(rm)]),(function(t,n,e){var o=e.cyclic?dm:mm;return a(t,0,e,o)})),wm(hm(rm),(function(t,n,e){var o=e.cyclic?gm:pm;return a(t,0,e,o)})),wm(hm(um),(function(t,n,e){return e.onEscape.bind((function(e){return e(t,n)}))})),wm(vm([xm,hm(im)]),(function(t,n,e){return e.onEnter.bind((function(e){return e(t,n)}))}))]),s=b([]);return Om(n,gu.init,c,s,(function(){return F.some(i)}))},Tm=_m(zo("cyclic",C)),Em=_m(zo("cyclic",O)),Dm=function(t,n,e){return Ed(e)&&hm(am)(n.event)?F.none():function(t,n,e){return _i(t,e,ei()),F.some(!0)}(t,0,e)},Am=function(t,n){return F.some(!0)},Bm=[ur("execute",Dm),ur("useSpace",!1),ur("useEnter",!0),ur("useControlEnter",!1),ur("useDown",!1)],Mm=function(t,n,e){return e.execute(t,n,t.element)},Fm=Om(Bm,gu.init,(function(t,n,e,o){var r=e.useSpace&&!Ed(t.element)?am:[],i=e.useEnter?im:[],u=e.useDown?lm:[],a=r.concat(i).concat(u);return[wm(hm(a),Mm)].concat(e.useControlEnter?[wm(vm([ym,hm(im)]),Mm)]:[])}),(function(t,n,e,o){return e.useSpace&&!Ed(t.element)?[wm(hm(am),Am)]:[]}),(function(){return F.none()})),Im=function(){var t=qc();return pu({readState:function(){return t.get().map((function(t){return{numRows:String(t.numRows),numColumns:String(t.numColumns)}})).getOr({numRows:"?",numColumns:"?"})},setGridSize:function(n,e){t.set({numRows:n,numColumns:e})},getNumRows:function(){return t.get().map((function(t){return t.numRows}))},getNumColumns:function(){return t.get().map((function(t){return t.numColumns}))}})},Rm=Object.freeze({__proto__:null,flatgrid:Im,init:function(t){return t.state(t)}}),Nm=function(t){return function(n,e,o,r){var i=t(n.element);return Lm(i,n,e,o,r)}},Pm=function(t,n){var e=hs(t,n);return Nm(e)},Vm=function(t,n){var e=hs(n,t);return Nm(e)},Hm=function(t){return function(n,e,o,r){return Lm(t,n,e,o,r)}},Lm=function(t,n,e,o,r){return o.focusManager.get(n).bind((function(e){return t(n.element,e,o,r)})).map((function(t){return o.focusManager.set(n,t),!0}))},zm=Hm,Um=Hm,jm=Hm,Wm=function(t){return!function(t){return t.offsetWidth<=0&&t.offsetHeight<=0}(t.dom)},Gm=function(t,n,e){var o=Zs(t,e);return function(t,n){return K(t,n).map((function(n){return{index:n,candidates:t}}))}(G(o,Wm),(function(t){return gn(t,n)}))},Xm=function(t,n){return K(t,(function(t){return gn(n,t)}))},qm=function(t,n,e,o){return o(Math.floor(n/e),n%e).bind((function(n){var o=n.row*e+n.column;return o>=0&&o<t.length?F.some(t[o]):F.none()}))},Ym=function(t,n,e,o,r){return qm(t,n,o,(function(n,i){var u=n===e-1?t.length-n*o:o,a=Va(i,r,0,u-1);return F.some({row:n,column:a})}))},Km=function(t,n,e,o,r){return qm(t,n,o,(function(n,i){var u=Va(n,r,0,e-1),a=u===e-1?t.length-u*o:o,c=Ha(i,0,a-1);return F.some({row:u,column:c})}))},Jm=[jo("selector"),ur("execute",Dm),Sa("onEscape"),ur("captureTab",!1),Ta()],$m=function(t,n,e){oa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Qm=function(t){return function(n,e,o,r){return Gm(n,e,o.selector).bind((function(n){return t(n.candidates,n.index,r.getNumRows().getOr(o.initSize.numRows),r.getNumColumns().getOr(o.initSize.numColumns))}))}},Zm=function(t,n,e){return e.captureTab?F.some(!0):F.none()},tg=Qm((function(t,n,e,o){return Ym(t,n,e,o,-1)})),ng=Qm((function(t,n,e,o){return Ym(t,n,e,o,1)})),eg=Qm((function(t,n,e,o){return Km(t,n,e,o,-1)})),og=Qm((function(t,n,e,o){return Km(t,n,e,o,1)})),rg=b([wm(hm(cm),Pm(tg,ng)),wm(hm(fm),Vm(tg,ng)),wm(hm(sm),zm(eg)),wm(hm(lm),Um(og)),wm(vm([bm,hm(rm)]),Zm),wm(vm([xm,hm(rm)]),Zm),wm(hm(um),(function(t,n,e){return e.onEscape(t,n)})),wm(hm(am.concat(im)),(function(t,n,e,o){return function(t,n){return n.focusManager.get(t).bind((function(t){return ra(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))}))]),ig=b([wm(hm(am),Am)]),ug=Om(Jm,Im,rg,ig,(function(){return F.some($m)})),ag=function(t,n,e,o){var r=function(t,n,e){var i=Va(n,o,0,e.length-1);return i===t?F.none():function(t){return"button"===Rt(t)&&"disabled"===zn(t,"disabled")}(e[i])?r(t,i,e):F.from(e[i])};return Gm(t,e,n).bind((function(t){var n=t.index,e=t.candidates;return r(n,n,e)}))},cg=[jo("selector"),ur("getInitial",F.none),ur("execute",Dm),Sa("onEscape"),ur("executeOnMove",!1),ur("allowVertical",!0)],sg=function(t,n,e){return function(t,n){return n.focusManager.get(t).bind((function(t){return ra(t,n.selector)}))}(t,e).bind((function(o){return e.execute(t,n,o)}))},fg=function(t,n,e){n.getInitial(t).orThunk((function(){return oa(t.element,n.selector)})).each((function(e){n.focusManager.set(t,e)}))},lg=function(t,n,e){return ag(t,e.selector,n,-1)},dg=function(t,n,e){return ag(t,e.selector,n,1)},mg=function(t){return function(n,e,o,r){return t(n,e,o,r).bind((function(){return o.executeOnMove?sg(n,e,o):F.some(!0)}))}},gg=function(t,n,e){return e.onEscape(t,n)},pg=b([wm(hm(am),Am)]),hg=Om(cg,gu.init,(function(t,n,e,o){var r=cm.concat(e.allowVertical?sm:[]),i=fm.concat(e.allowVertical?lm:[]);return[wm(hm(r),mg(Pm(lg,dg))),wm(hm(i),mg(Vm(lg,dg))),wm(hm(im),sg),wm(hm(am),sg),wm(hm(um),gg)]}),pg,(function(){return F.some(fg)})),vg=function(t,n,e){return F.from(t[n]).bind((function(t){return F.from(t[e]).map((function(t){return{rowIndex:n,columnIndex:e,cell:t}}))}))},bg=function(t,n,e,o){var r=t[n].length,i=Va(e,o,0,r-1);return vg(t,n,i)},yg=function(t,n,e,o){var r=Va(e,o,0,t.length-1),i=t[r].length,u=Ha(n,0,i-1);return vg(t,r,u)},xg=function(t,n,e,o){var r=t[n].length,i=Ha(e+o,0,r-1);return vg(t,n,i)},wg=function(t,n,e,o){var r=Ha(e+o,0,t.length-1),i=t[r].length,u=Ha(n,0,i-1);return vg(t,r,u)},Sg=[Ko("selectors",[jo("row"),jo("cell")]),ur("cycles",!0),ur("previousSelector",F.none),ur("execute",Dm)],kg=function(t,n,e){n.previousSelector(t).orThunk((function(){var e=n.selectors;return oa(t.element,e.cell)})).each((function(e){n.focusManager.set(t,e)}))},Cg=function(t,n){return function(e,o,r){var i=r.cycles?t:n;return ra(o,r.selectors.row).bind((function(t){var n=Zs(t,r.selectors.cell);return Xm(n,o).bind((function(n){var o=Zs(e,r.selectors.row);return Xm(o,t).bind((function(t){var e=function(t,n){return U(t,(function(t){return Zs(t,n.selectors.cell)}))}(o,r);return i(e,t,n).map((function(t){return t.cell}))}))}))}))}},Og=Cg((function(t,n,e){return bg(t,n,e,-1)}),(function(t,n,e){return xg(t,n,e,-1)})),_g=Cg((function(t,n,e){return bg(t,n,e,1)}),(function(t,n,e){return xg(t,n,e,1)})),Tg=Cg((function(t,n,e){return yg(t,e,n,-1)}),(function(t,n,e){return wg(t,e,n,-1)})),Eg=Cg((function(t,n,e){return yg(t,e,n,1)}),(function(t,n,e){return wg(t,e,n,1)})),Dg=b([wm(hm(cm),Pm(Og,_g)),wm(hm(fm),Vm(Og,_g)),wm(hm(sm),zm(Tg)),wm(hm(lm),Um(Eg)),wm(hm(am.concat(im)),(function(t,n,e){return _c(t.element).bind((function(o){return e.execute(t,n,o)}))}))]),Ag=b([wm(hm(am),Am)]),Bg=Om(Sg,gu.init,Dg,Ag,(function(){return F.some(kg)})),Mg=[jo("selector"),ur("execute",Dm),ur("moveOnTab",!1)],Fg=function(t,n,e){return e.focusManager.get(t).bind((function(o){return e.execute(t,n,o)}))},Ig=function(t,n,e){oa(t.element,n.selector).each((function(e){n.focusManager.set(t,e)}))},Rg=function(t,n,e){return ag(t,e.selector,n,-1)},Ng=function(t,n,e){return ag(t,e.selector,n,1)},Pg=b([wm(hm(sm),jm(Rg)),wm(hm(lm),jm(Ng)),wm(vm([bm,hm(rm)]),(function(t,n,e,o){return e.moveOnTab?jm(Rg)(t,n,e,o):F.none()})),wm(vm([xm,hm(rm)]),(function(t,n,e,o){return e.moveOnTab?jm(Ng)(t,n,e,o):F.none()})),wm(hm(im),Fg),wm(hm(am),Fg)]),Vg=b([wm(hm(am),Am)]),Hg=Om(Mg,gu.init,Pg,Vg,(function(){return F.some(Ig)})),Lg=[Sa("onSpace"),Sa("onEnter"),Sa("onShiftEnter"),Sa("onLeft"),Sa("onRight"),Sa("onTab"),Sa("onShiftTab"),Sa("onUp"),Sa("onDown"),Sa("onEscape"),ur("stopSpaceKeyup",!1),Qo("focusIn")],zg=Om(Lg,gu.init,(function(t,n,e){return[wm(hm(am),e.onSpace),wm(vm([xm,hm(im)]),e.onEnter),wm(vm([bm,hm(im)]),e.onShiftEnter),wm(vm([bm,hm(rm)]),e.onShiftTab),wm(vm([xm,hm(rm)]),e.onTab),wm(hm(sm),e.onUp),wm(hm(lm),e.onDown),wm(hm(cm),e.onLeft),wm(hm(fm),e.onRight),wm(hm(am),e.onSpace),wm(hm(um),e.onEscape)]}),(function(t,n,e){return e.stopSpaceKeyup?[wm(hm(am),Am)]:[]}),(function(t){return t.focusIn})),Ug=Tm.schema(),jg=Em.schema(),Wg=hg.schema(),Gg=ug.schema(),Xg=Bg.schema(),qg=Fm.schema(),Yg=Hg.schema(),Kg=zg.schema(),Jg=Object.freeze({__proto__:null,acyclic:Ug,cyclic:jg,flow:Wg,flatgrid:Gg,matrix:Xg,execution:qg,menu:Yg,special:Kg}),$g=bc({branchKey:"mode",branches:Jg,name:"keying",active:{events:function(t,n){return t.handler.toEvents(t,n)}},apis:{focusIn:function(t,n,e){n.sendFocusIn(n).fold((function(){t.getSystem().triggerFocus(t.element,t.element)}),(function(o){o(t,n,e)}))},setGridSize:function(t,n,e,o,r){!function(t){return xt(t,"setGridSize")}(e)?console.error("Layout does not support setGridSize"):e.setGridSize(o,r)}},state:Rm}),Qg=function(t,n,e,o){var r=t.getSystem().build(o);Hf(t,r,e)},Zg=function(t,n,e,o){var r=tp(t);Y(r,(function(t){return gn(o.element,t.element)})).each(zf)},tp=function(t,n){return t.components()},np=function(t,n,e,o,r){var i=tp(t);return F.from(i[o]).map((function(n){return Zg(t,0,0,n),r.each((function(n){Qg(t,0,(function(t,n){!function(t,n,e){Cn(t,e).fold((function(){we(t,n)}),(function(t){be(t,n)}))}(t,n,o)}),n)})),n}))},ep=Object.freeze({__proto__:null,append:function(t,n,e,o){Qg(t,0,we,o)},prepend:function(t,n,e,o){Qg(t,0,xe,o)},remove:Zg,replaceAt:np,replaceBy:function(t,n,e,o,r){var i=tp(t);return K(i,o).bind((function(n){return np(t,0,0,n,r)}))},set:function(t,n,e,o){Tc((function(){var n=U(o,t.getSystem().build);Pf(t,n)}),t.element)},contents:tp}),op=hc({fields:[],name:"replacing",apis:ep}),rp=function(t,n){return{key:t,value:{config:{},me:function(t,n){var e=Di(n);return hc({fields:[jo("enabled")],name:t,active:{events:b(e)}})}(t,n),configAsRaw:b({}),initialConfig:{},state:gu}}},ip=function(t,n){n.ignore||(kc(t.element),n.onFocus(t))},up=Object.freeze({__proto__:null,focus:ip,blur:function(t,n){n.ignore||function(t){t.dom.blur()}(t.element)},isFocused:function(t){return Cc(t.element)}}),ap=Object.freeze({__proto__:null,exhibit:function(t,n){var e=n.ignore?{}:{attributes:{tabindex:"-1"}};return vu(e)},events:function(t){return Di([Mi(Qr(),(function(n,e){ip(n,t),e.stop()}))].concat(t.stopMousedown?[Mi(Ir(),(function(t,n){n.event.prevent()}))]:[]))}}),cp=[wa("onFocus"),ur("stopMousedown",!1),ur("ignore",!1)],sp=hc({fields:cp,name:"focusing",active:ap,apis:up}),fp=function(t,n,e){var o=n.aria;o.update(t,o,e.get())},lp=function(t,n,e){n.toggleClass.each((function(n){e.get()?Bu(t.element,n):Fu(t.element,n)}))},dp=function(t,n,e){pp(t,n,e,!e.get())},mp=function(t,n,e){e.set(!0),lp(t,n,e),fp(t,n,e)},gp=function(t,n,e){e.set(!1),lp(t,n,e),fp(t,n,e)},pp=function(t,n,e,o){(o?mp:gp)(t,n,e)},hp=function(t,n,e){pp(t,n,e,n.selected)},vp=Object.freeze({__proto__:null,onLoad:hp,toggle:dp,isOn:function(t,n,e){return e.get()},on:mp,off:gp,set:pp}),bp=Object.freeze({__proto__:null,exhibit:function(){return vu({})},events:function(t,n){var e=function(t,n,e){return ji((function(o){e(o,t,n)}))}(t,n,dp),o=fc(t,n,hp);return Di(J([t.toggleOnExecute?[e]:[],[o]]))}}),yp=function(t,n,e){Hn(t.element,"aria-expanded",e)},xp=[ur("selected",!1),Qo("toggleClass"),ur("toggleOnExecute",!0),ar("aria",{mode:"none"},Ho("mode",{pressed:[ur("syncWithExpanded",!1),Oa("update",(function(t,n,e){Hn(t.element,"aria-pressed",e),n.syncWithExpanded&&yp(t,n,e)}))],checked:[Oa("update",(function(t,n,e){Hn(t.element,"aria-checked",e)}))],expanded:[Oa("update",yp)],selected:[Oa("update",(function(t,n,e){Hn(t.element,"aria-selected",e)}))],none:[Oa("update",p)]}))],wp=hc({fields:xp,name:"toggling",active:bp,apis:vp,state:function(t){return{init:function(){var n=pr(t);return{get:function(){return n.get()},set:function(t){return n.set(t)},clear:function(){return n.set(t)},readState:function(){return n.get()}}}}}(!1)}),Sp=function(){var t=function(t,n){n.stop(),Oi(t)};return[Mi(Gr(),t),Mi(ri(),t),Pi(Ar()),Pi(Ir())]},kp=function(t){return Di(J([t.map((function(t){return ji((function(n,e){t(n),e.stop()}))})).toArray(),Sp()]))},Cp="alloy.item-hover",Op="alloy.item-focus",_p=function(t){(_c(t.element).isNone()||sp.isFocused(t))&&(sp.isFocused(t)||sp.focus(t),Ci(t,Cp,{item:t}))},Tp=function(t){Ci(t,Op,{item:t})},Ep=b(Cp),Dp=b(Op),Ap=[jo("data"),jo("components"),jo("dom"),ur("hasSubmenu",!1),Qo("toggling"),_l("itemBehaviours",[wp,sp,$g,Sl]),ur("ignoreFocus",!1),ur("domModification",{}),Oa("builder",(function(t){return{dom:t.dom,domModification:T(T({},t.domModification),{attributes:T(T(T({role:t.toggling.isSome()?"menuitemcheckbox":"menuitem"},t.domModification.attributes),{"aria-haspopup":t.hasSubmenu}),t.hasSubmenu?{"aria-expanded":!1}:{})}),behaviours:Tl(t.itemBehaviours,[t.toggling.fold(wp.revoke,(function(t){return wp.config(T({aria:{mode:"checked"}},t))})),sp.config({ignore:t.ignoreFocus,stopMousedown:t.ignoreFocus,onFocus:function(t){Tp(t)}}),$g.config({mode:"execution"}),Sl.config({store:{mode:"memory",initialValue:t.data}}),rp("item-type-events",D(D([],Sp(),!0),[Mi(Vr(),_p),Mi(oi(),sp.focus)],!1))]),components:t.components,eventOrder:t.eventOrder}})),ur("eventOrder",{})],Bp=[jo("dom"),jo("components"),Oa("builder",(function(t){return{dom:t.dom,components:t.components,events:Di([Vi(oi())])}}))],Mp=b("item-widget"),Fp=b([Ql({name:"widget",overrides:function(t){return{behaviours:gc([Sl.config({store:{mode:"manual",getValue:function(n){return t.data},setValue:p}})])}}})]),Ip=[jo("uid"),jo("data"),jo("components"),jo("dom"),ur("autofocus",!1),ur("ignoreFocus",!1),_l("widgetBehaviours",[Sl,sp,$g]),ur("domModification",{}),yd(Fp()),Oa("builder",(function(t){var n=fd(Mp(),t,Fp()),e=ld(Mp(),t,n.internals()),o=function(n){return dd(n,t,"widget").map((function(t){return $g.focusIn(t),t}))},r=function(n,e){return Ed(e.event.target)?F.none():t.autofocus?(e.setSource(n.element),F.none()):F.none()};return{dom:t.dom,components:e,domModification:t.domModification,events:Di([ji((function(t,n){o(t).each((function(t){n.stop()}))})),Mi(Vr(),_p),Mi(oi(),(function(n,e){t.autofocus?o(n):sp.focus(n)}))]),behaviours:Tl(t.widgetBehaviours,[Sl.config({store:{mode:"memory",initialValue:t.data}}),sp.config({ignore:t.ignoreFocus,onFocus:function(t){Tp(t)}}),$g.config({mode:"special",focusIn:t.autofocus?function(t){o(t)}:yc(),onLeft:r,onRight:r,onEscape:function(n,e){return sp.isFocused(n)||t.autofocus?t.autofocus?(e.setSource(n.element),F.none()):F.none():(sp.focus(n),F.some(!0))}})])}}))],Rp=Ho("type",{widget:Ip,item:Ap,separator:Bp}),Np=b([nd({factory:{sketch:function(t){var n=Po("menu.spec item",Rp,t);return n.builder(n)}},name:"items",unit:"item",defaults:function(t,n){return yt(n,"uid")?n:T(T({},n),{uid:iu("item")})},overrides:function(t,n){return{type:n.type,ignoreFocus:t.fakeFocus,domModification:{classes:[t.markers.item]}}}})]),Pp=b([jo("value"),jo("items"),jo("dom"),jo("components"),ur("eventOrder",{}),kl("menuBehaviours",[em,Sl,Bd,$g]),ar("movement",{mode:"menu",moveOnTab:!0},Ho("mode",{grid:[Ta(),Oa("config",(function(t,n){return{mode:"flatgrid",selector:"."+t.markers.item,initSize:{numColumns:n.initSize.numColumns,numRows:n.initSize.numRows},focusManager:t.focusManager}}))],matrix:[Oa("config",(function(t,n){return{mode:"matrix",selectors:{row:n.rowSelector,cell:"."+t.markers.item},focusManager:t.focusManager}})),jo("rowSelector")],menu:[ur("moveOnTab",!0),Oa("config",(function(t,n){return{mode:"menu",selector:"."+t.markers.item,moveOnTab:n.moveOnTab,focusManager:t.focusManager}}))]})),Wo("markers",ha()),ur("fakeFocus",!1),ur("focusManager",km()),wa("onHighlight")]),Vp=b("alloy.menu-focus"),Hp=Td({name:"Menu",configFields:Pp(),partFields:Np(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Ol(t.menuBehaviours,[em.config({highlightClass:t.markers.selectedItem,itemClass:t.markers.item,onHighlight:t.onHighlight}),Sl.config({store:{mode:"memory",initialValue:t.value}}),Bd.config({find:F.some}),$g.config(t.movement.config(t,t.movement))]),events:Di([Mi(Dp(),(function(t,n){var e=n.event;t.getSystem().getByDom(e.target).each((function(e){em.highlight(t,e),n.stop(),Ci(t,Vp(),{menu:t,item:e})}))})),Mi(Ep(),(function(t,n){var e=n.event.item;em.highlight(t,e)}))]),components:n,eventOrder:t.eventOrder,domModification:{attributes:{role:"menu"}}}}}),Lp=function(t,n,e,o){return bt(e,o).bind((function(o){return bt(t,o).bind((function(o){var r=Lp(t,n,e,o);return F.some([o].concat(r))}))})).getOr([])},zp=function(t,n){var e={};lt(t,(function(t,n){j(t,(function(t){e[t]=n}))}));var o=n,r=function(t){return mt(t,(function(t,n){return{k:t,v:n}}))}(n),i=dt(r,(function(t,n){return[n].concat(Lp(e,o,r,n))}));return dt(e,(function(t){return bt(i,t).getOr([t])}))},Up=function(t){return"prepared"===t.type?F.some(t.menu):F.none()},jp={init:function(){var t=pr({}),n=pr({}),e=pr({}),o=qc(),r=pr({}),i=function(n){return ht(t.get(),(function(t,e){return t===n}))},u=function(t){return a(t).bind(Up)},a=function(t){return bt(n.get(),t)},c=function(n){return bt(t.get(),n)};return{setMenuBuilt:function(t,e){var o;n.set(T(T({},n.get()),((o={})[t]={type:"prepared",menu:e},o)))},setContents:function(i,u,a,c){o.set(i),t.set(a),n.set(u),r.set(c);var s=zp(c,a);e.set(s)},expand:function(n){return bt(t.get(),n).map((function(t){var o=bt(e.get(),n).getOr([]);return[t].concat(o)}))},refresh:function(t){return bt(e.get(),t)},collapse:function(t){return bt(e.get(),t).bind((function(t){return t.length>1?F.some(t.slice(1)):F.none()}))},lookupMenu:a,lookupItem:c,otherMenus:function(t){var n=r.get();return tt(st(n),t)},getPrimary:function(){return o.get().bind(u)},getMenus:function(){return n.get()},clear:function(){t.set({}),n.set({}),e.set({}),o.clear()},isClear:function(){return o.get().isNone()},getTriggeringPath:function(t,n){var r=G(c(t).toArray(),(function(t){return u(t).isSome()}));return bt(e.get(),t).bind((function(t){var e=Z(r.concat(t));return function(t){for(var n=[],e=0;e<t.length;e++){var o=t[e];if(!o.isSome())return F.none();n.push(o.getOrDie())}return F.some(n)}($(e,(function(t,r){return function(t,n,e){return u(t).bind((function(o){return i(t).bind((function(t){return n(t).map((function(t){return{triggeredMenu:o,triggeringItem:t,triggeringPath:e}}))}))}))}(t,n,e.slice(0,r+1)).fold((function(){return wt(o.get(),t)?[]:[F.none()]}),(function(t){return[F.some(t)]}))})))}))}}},extractPreparedMenu:Up},Wp=b("collapse-item"),Gp=_d({name:"TieredMenu",configFields:[Ca("onExecute"),Ca("onEscape"),ka("onOpenMenu"),ka("onOpenSubmenu"),wa("onRepositionMenu"),wa("onCollapseMenu"),ur("highlightImmediately",!0),Ko("data",[jo("primary"),jo("menus"),jo("expansions")]),ur("fakeFocus",!1),wa("onHighlight"),wa("onHover"),ba(),jo("dom"),ur("navigateOnHover",!0),ur("stayInDom",!1),kl("tmenuBehaviours",[$g,em,Bd,op]),ur("eventOrder",{})],apis:{collapseMenu:function(t,n){t.collapseMenu(n)},highlightPrimary:function(t,n){t.highlightPrimary(n)},repositionMenus:function(t,n){t.repositionMenus(n)}},factory:function(t,n){var e,o=qc(),r=jp.init(),i=function(n){var e=function(n,e,o){return dt(o,(function(o,r){var i=function(){return Hp.sketch(T(T({},o),{value:r,markers:t.markers,fakeFocus:t.fakeFocus,onHighlight:t.onHighlight,focusManager:t.fakeFocus?Cm():km()}))};return r===e?{type:"prepared",menu:n.getSystem().build(i())}:{type:"notbuilt",nbMenu:i}}))}(n,t.data.primary,t.data.menus),o=a();return r.setContents(t.data.primary,e,t.data.expansions,o),r.getPrimary()},u=function(t){return Sl.getValue(t).value},a=function(n){return dt(t.data.menus,(function(t,n){return $(t.items,(function(t){return"separator"===t.type?[]:[t.data.value]}))}))},c=function(t,n){em.highlight(t,n),em.getHighlighted(n).orThunk((function(){return em.getFirst(n)})).each((function(n){_i(t,n.element,oi())}))},s=function(t,n){return St(U(n,(function(n){return t.lookupMenu(n).bind((function(t){return"prepared"===t.type?F.some(t.menu):F.none()}))})))},f=function(n,e,o){var r=s(e,e.otherMenus(o));j(r,(function(e){Nu(e.element,[t.markers.backgroundMenu]),t.stayInDom||op.remove(n,e)}))},l=function(n){return o.get().getOrThunk((function(){var e={},r=Zs(n.element,"."+t.markers.item),i=G(r,(function(t){return"true"===zn(t,"aria-haspopup")}));return j(i,(function(t){n.getSystem().getByDom(t).each((function(t){var n=u(t);e[n]=t}))})),o.set(e),e}))},d=function(t,n){var e=l(t);lt(e,(function(t,e){var o=V(n,e);Hn(t.element,"aria-expanded",o)}))},m=function(n,e,o){return F.from(o[0]).bind((function(r){return e.lookupMenu(r).bind((function(r){if("notbuilt"===r.type)return F.none();var i=r.menu,u=s(e,o.slice(1));return j(u,(function(n){Bu(n.element,t.markers.backgroundMenu)})),Rn(i.element)||op.append(n,Ku(i)),Nu(i.element,[t.markers.backgroundMenu]),c(n,i),f(n,e,o),F.some(i)}))}))};!function(t){t[t.HighlightSubmenu=0]="HighlightSubmenu",t[t.HighlightParent=1]="HighlightParent"}(e||(e={}));var g=function(n,o,i){if(void 0===i&&(i=e.HighlightSubmenu),o.hasConfigured(Gd)&&Gd.isDisabled(o))return F.some(o);var a=u(o);return r.expand(a).bind((function(u){return d(n,u),F.from(u[0]).bind((function(a){return r.lookupMenu(a).bind((function(c){var s=function(t,n,e){if("notbuilt"===e.type){var o=t.getSystem().build(e.nbMenu());return r.setMenuBuilt(n,o),o}return e.menu}(n,a,c);return Rn(s.element)||op.append(n,Ku(s)),t.onOpenSubmenu(n,o,s,Z(u)),i===e.HighlightSubmenu?(em.highlightFirst(s),m(n,r,u)):(em.dehighlightAll(s),F.some(o))}))}))}))},h=function(n,e){var o=u(e);return r.collapse(o).bind((function(o){return d(n,o),m(n,r,o).map((function(o){return t.onCollapseMenu(n,e,o),o}))}))},v=function(n){return function(e,o){return ra(o.getSource(),"."+t.markers.item).bind((function(t){return e.getSystem().getByDom(t).toOptional().bind((function(t){return n(e,t).map(O)}))}))}},b=Di([Mi(Vp(),(function(t,n){var e=n.event.item;r.lookupItem(u(e)).each((function(){var e=n.event.menu;em.highlight(t,e);var o=u(n.event.item);r.refresh(o).each((function(n){return f(t,r,n)}))}))})),ji((function(n,o){var r=o.event.target;n.getSystem().getByDom(r).each((function(o){0===u(o).indexOf("collapse-item")&&h(n,o),g(n,o,e.HighlightSubmenu).fold((function(){t.onExecute(n,o)}),p)}))})),Li((function(n,e){i(n).each((function(e){op.append(n,Ku(e)),t.onOpenMenu(n,e),t.highlightImmediately&&c(n,e)}))}))].concat(t.navigateOnHover?[Mi(Ep(),(function(n,o){var i=o.event.item;(function(t,n){var e=u(n);r.refresh(e).bind((function(n){return d(t,n),m(t,r,n)}))})(n,i),g(n,i,e.HighlightParent),t.onHover(n,i)}))]:[])),y=function(t){return em.getHighlighted(t).bind(em.getHighlighted)},x={collapseMenu:function(t){y(t).each((function(n){h(t,n)}))},highlightPrimary:function(t){r.getPrimary().each((function(n){c(t,n)}))},repositionMenus:function(n){r.getPrimary().bind((function(t){return y(n).bind((function(t){var n=u(t),e=vt(r.getMenus()),o=St(U(e,jp.extractPreparedMenu));return r.getTriggeringPath(n,(function(t){return function(t,n,e){return ct(n,(function(t){if(!t.getSystem().isConnected())return F.none();var n=em.getCandidates(t);return Y(n,(function(t){return u(t)===e}))}))}(0,o,t)}))})).map((function(n){return{primary:t,triggeringPath:n}}))})).fold((function(){(function(t){return F.from(t.components()[0]).filter((function(t){return"menu"===zn(t.element,"role")}))})(n).each((function(e){t.onRepositionMenu(n,e,[])}))}),(function(e){var o=e.primary,r=e.triggeringPath;t.onRepositionMenu(n,o,r)}))}};return{uid:t.uid,dom:t.dom,markers:t.markers,behaviours:Ol(t.tmenuBehaviours,[$g.config({mode:"special",onRight:v((function(t,n){return Ed(n.element)?F.none():g(t,n,e.HighlightSubmenu)})),onLeft:v((function(t,n){return Ed(n.element)?F.none():h(t,n)})),onEscape:v((function(n,e){return h(n,e).orThunk((function(){return t.onEscape(n,e).map((function(){return n}))}))})),focusIn:function(t,n){r.getPrimary().each((function(n){_i(t,n.element,oi())}))}}),em.config({highlightClass:t.markers.selectedMenu,itemClass:t.markers.menu}),Bd.config({find:function(t){return em.getHighlighted(t)}}),op.config({})]),eventOrder:t.eventOrder,apis:x,events:b}},extraApis:{tieredData:function(t,n,e){return{primary:t,menus:n,expansions:e}},singleData:function(t,n){return{primary:t,menus:yr(t,n),expansions:{}}},collapseItem:function(t){return{value:Qi(Wp()),meta:{text:t}}}}}),Xp=_d({name:"InlineView",configFields:[jo("lazySink"),wa("onShow"),wa("onHide"),er("onEscape"),kl("inlineBehaviours",[el,Sl,xc]),rr("fireDismissalEventInstead",[ur("event",pi())]),rr("fireRepositionEventInstead",[ur("event",hi())]),ur("getRelated",F.none),ur("isExtraPart",C),ur("eventOrder",F.none)],factory:function(t,n){var e=function(n,e){return t.getRelated(n).exists((function(t){return aa(t,e)}))},o=function(t,n,e,o){r(t,n,e,(function(){return o.map((function(t){return Ie(t)}))}))},r=function(n,e,o,r){var i=t.lazySink(n).getOrDie();el.openWhileCloaked(n,e,(function(){return Ff.positionWithinBounds(i,n,o,r())})),Sl.setValue(n,F.some({mode:"position",config:o,getBounds:r}))},i=function(n,e,o,r){var i=function(t,n,e,o,r){var i=function(){return t.lazySink(n)},u="horizontal"===o.type?{layouts:{onLtr:function(){return uc()},onRtl:function(){return ac()}}}:{},a=function(t){return function(t){return 2===t.length}(t)?u:{}};return Gp.sketch({dom:{tag:"div"},data:o.data,markers:o.menu.markers,highlightImmediately:o.menu.highlightImmediately,onEscape:function(){return el.close(n),t.onEscape.map((function(t){return t(n)})),F.some(!0)},onExecute:function(){return F.some(!0)},onOpenMenu:function(t,n){Ff.positionWithinBounds(i().getOrDie(),n,e,r())},onOpenSubmenu:function(t,n,e,o){var r=i().getOrDie();Ff.position(r,e,{anchor:T({type:"submenu",item:n},a(o))})},onRepositionMenu:function(t,n,o){var u=i().getOrDie();Ff.positionWithinBounds(u,n,e,r()),j(o,(function(t){var n=a(t.triggeringPath);Ff.position(u,t.triggeredMenu,{anchor:T({type:"submenu",item:t.triggeringItem},n)})}))}})}(t,n,e,o,r);el.open(n,i),Sl.setValue(n,F.some({mode:"menu",menu:i}))},u=function(n){el.isOpen(n)&&Sl.getValue(n).each((function(e){switch(e.mode){case"menu":el.getState(n).each(Gp.repositionMenus);break;case"position":var o=t.lazySink(n).getOrDie();Ff.positionWithinBounds(o,n,e.config,e.getBounds())}}))},a={setContent:function(t,n){el.setContent(t,n)},showAt:function(t,n,e){o(t,n,e,F.none())},showWithin:o,showWithinBounds:r,showMenuAt:function(t,n,e){i(t,n,e,F.none)},showMenuWithinBounds:i,hide:function(t){el.isOpen(t)&&(Sl.setValue(t,F.none()),el.close(t))},getContent:function(t){return el.getState(t)},reposition:u,isOpen:el.isOpen};return{uid:t.uid,dom:t.dom,behaviours:Ol(t.inlineBehaviours,[el.config({isPartOf:function(t,n,o){return aa(n,o)||e(t,o)},getAttachPoint:function(n){return t.lazySink(n).getOrDie()},onOpen:function(n){t.onShow(n)},onClose:function(n){t.onHide(n)}}),Sl.config({store:{mode:"memory",initialValue:F.none()}}),xc.config({channels:T(T({},al(T({isExtraPart:n.isExtraPart},t.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),sl(T(T({},t.fireRepositionEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})),{doReposition:u})))})]),eventOrder:t.eventOrder,apis:a}},apis:{showAt:function(t,n,e,o){t.showAt(n,e,o)},showWithin:function(t,n,e,o,r){t.showWithin(n,e,o,r)},showWithinBounds:function(t,n,e,o,r){t.showWithinBounds(n,e,o,r)},showMenuAt:function(t,n,e,o){t.showMenuAt(n,e,o)},showMenuWithinBounds:function(t,n,e,o,r){t.showMenuWithinBounds(n,e,o,r)},hide:function(t,n){t.hide(n)},isOpen:function(t,n){return t.isOpen(n)},getContent:function(t,n){return t.getContent(n)},setContent:function(t,n,e){t.setContent(n,e)},reposition:function(t,n){t.reposition(n)}}}),qp="layout-inset",Yp=function(t){return t.x},Kp=function(t,n){return t.x+t.width/2-n.width/2},Jp=function(t,n){return t.x+t.width-n.width},$p=function(t){return t.y},Qp=function(t,n){return t.y+t.height-n.height},Zp=function(t,n){return t.y+t.height/2-n.height/2},th=function(t,n,e){return Ea(Jp(t,n),Qp(t,n),e.insetSouthwest(),Fa(),"southwest",La(t,{right:0,bottom:3}),qp)},nh=function(t,n,e){return Ea(Yp(t),Qp(t,n),e.insetSoutheast(),Ma(),"southeast",La(t,{left:1,bottom:3}),qp)},eh=function(t,n,e){return Ea(Jp(t,n),$p(t),e.insetNorthwest(),Ba(),"northwest",La(t,{right:0,top:2}),qp)},oh=function(t,n,e){return Ea(Yp(t),$p(t),e.insetNortheast(),Aa(),"northeast",La(t,{left:1,top:2}),qp)},rh=function(t,n,e){return Ea(Kp(t,n),$p(t),e.insetNorth(),Ia(),"north",La(t,{top:2}),qp)},ih=function(t,n,e){return Ea(Kp(t,n),Qp(t,n),e.insetSouth(),Ra(),"south",La(t,{bottom:3}),qp)},uh=function(t,n,e){return Ea(Jp(t,n),Zp(t,n),e.insetEast(),Pa(),"east",La(t,{right:0}),qp)},ah=function(t,n,e){return Ea(Yp(t),Zp(t,n),e.insetWest(),Na(),"west",La(t,{left:1}),qp)},ch=function(t){switch(t){case"north":return rh;case"northeast":return oh;case"northwest":return eh;case"south":return ih;case"southeast":return nh;case"southwest":return th;case"east":return uh;case"west":return ah}},sh=function(t,n,e,o,r){return Lc(o).map(ch).getOr(rh)(t,n,e,o,r)},fh=function(t){switch(t){case"north":return ih;case"northeast":return nh;case"northwest":return th;case"south":return rh;case"southeast":return oh;case"southwest":return eh;case"east":return ah;case"west":return uh}},lh=function(t,n,e,o,r){return Lc(o).map(fh).getOr(rh)(t,n,e,o,r)},dh=tinymce.util.Tools.resolve("tinymce.util.Delay"),mh=_d({name:"Button",factory:function(t){var n=kp(t.action),e=t.dom.tag,o=function(n){return bt(t.dom,"attributes").bind((function(t){return bt(t,n)}))};return{uid:t.uid,dom:t.dom,components:t.components,events:n,behaviours:Tl(t.buttonBehaviours,[sp.config({}),$g.config({mode:"execution",useSpace:!0,useEnter:!0})]),domModification:{attributes:function(){if("button"===e){var t=o("type").getOr("button"),n=o("role").map((function(t){return{role:t}})).getOr({});return T({type:t},n)}return{role:o("role").getOr("button")}}()},eventOrder:t.eventOrder}},configFields:[ur("uid",void 0),jo("dom"),ur("components",[]),_l("buttonBehaviours",[sp,$g]),Qo("action"),Qo("role"),ur("eventOrder",{})]}),gh=function(t){var n=Ft.fromHtml(t),e=kn(n),o=function(t){var n=void 0!==t.dom.attributes?t.dom.attributes:[];return q(n,(function(t,n){var e;return"class"===n.name?t:T(T({},t),((e={})[n.name]=n.value,e))}),{})}(n),r=function(t){return Array.prototype.slice.call(t.dom.classList,0)}(n),i=0===e.length?{}:{innerHtml:Wi(n)};return T({tag:Rt(n),classes:r,attributes:o},i)},ph=function(t){var n=function(t){return void 0!==t.uid}(t)&&xt(t,"uid")?t.uid:iu("memento");return{get:function(t){return t.getSystem().getByUid(n).getOrDie()},getOpt:function(t){return t.getSystem().getByUid(n).toOptional()},asSpec:function(){return T(T({},t),{uid:n})}}};function hh(t){return(hh="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function vh(t,n){return(vh=Object.setPrototypeOf||function(t,n){return t.__proto__=n,t})(t,n)}function bh(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}function yh(t,n,e){return(yh=bh()?Reflect.construct:function(t,n,e){var o=[null];o.push.apply(o,n);var r=new(Function.bind.apply(t,o));return e&&vh(r,e.prototype),r}).apply(null,arguments)}function xh(t){return function(t){if(Array.isArray(t))return wh(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return wh(t,n);var e=Object.prototype.toString.call(t).slice(8,-1);return"Object"===e&&t.constructor&&(e=t.constructor.name),"Map"===e||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?wh(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function wh(t,n){(null==n||n>t.length)&&(n=t.length);for(var e=0,o=new Array(n);e<n;e++)o[e]=t[e];return o}var Sh=Object.hasOwnProperty,kh=Object.setPrototypeOf,Ch=Object.isFrozen,Oh=Object.getPrototypeOf,_h=Object.getOwnPropertyDescriptor,Th=Object.freeze,Eh=Object.seal,Dh=Object.create,Ah="undefined"!=typeof Reflect&&Reflect,Bh=Ah.apply,Mh=Ah.construct;Bh||(Bh=function(t,n,e){return t.apply(n,e)}),Th||(Th=function(t){return t}),Eh||(Eh=function(t){return t}),Mh||(Mh=function(t,n){return yh(t,xh(n))});var Fh=jh(Array.prototype.forEach),Ih=jh(Array.prototype.pop),Rh=jh(Array.prototype.push),Nh=jh(String.prototype.toLowerCase),Ph=jh(String.prototype.match),Vh=jh(String.prototype.replace),Hh=jh(String.prototype.indexOf),Lh=jh(String.prototype.trim),zh=jh(RegExp.prototype.test),Uh=function(t){return function(){for(var n=arguments.length,e=new Array(n),o=0;o<n;o++)e[o]=arguments[o];return Mh(t,e)}}(TypeError);function jh(t){return function(n){for(var e=arguments.length,o=new Array(e>1?e-1:0),r=1;r<e;r++)o[r-1]=arguments[r];return Bh(t,n,o)}}function Wh(t,n){kh&&kh(t,null);for(var e=n.length;e--;){var o=n[e];if("string"==typeof o){var r=Nh(o);r!==o&&(Ch(n)||(n[e]=r),o=r)}t[o]=!0}return t}function Gh(t){var n,e=Dh(null);for(n in t)Bh(Sh,t,[n])&&(e[n]=t[n]);return e}function Xh(t,n){for(;null!==t;){var e=_h(t,n);if(e){if(e.get)return jh(e.get);if("function"==typeof e.value)return jh(e.value)}t=Oh(t)}return function(t){return console.warn("fallback value for",t),null}}var qh=Th(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),Yh=Th(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),Kh=Th(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),Jh=Th(["animate","color-profile","cursor","discard","fedropshadow","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),$h=Th(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover"]),Qh=Th(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),Zh=Th(["#text"]),tv=Th(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","xmlns","slot"]),nv=Th(["accent-height","accumulate","additive","alignment-baseline","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),ev=Th(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),ov=Th(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),rv=Eh(/\{\{[\w\W]*|[\w\W]*\}\}/gm),iv=Eh(/<%[\w\W]*|[\w\W]*%>/gm),uv=Eh(/^data-[\-\w.\u00B7-\uFFFF]/),av=Eh(/^aria-[\-\w]+$/),cv=Eh(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),sv=Eh(/^(?:\w+script|data):/i),fv=Eh(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),lv=Eh(/^html$/i),dv=function(){return"undefined"==typeof window?null:window},mv=function(t,n){if("object"!==hh(t)||"function"!=typeof t.createPolicy)return null;var e=null,o="data-tt-policy-suffix";n.currentScript&&n.currentScript.hasAttribute(o)&&(e=n.currentScript.getAttribute(o));var r="dompurify"+(e?"#"+e:"");try{return t.createPolicy(r,{createHTML:function(t){return t}})}catch(t){return console.warn("TrustedTypes policy "+r+" could not be created."),null}};var gv=function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:dv(),e=function(n){return t(n)};if(e.version="2.3.8",e.removed=[],!n||!n.document||9!==n.document.nodeType)return e.isSupported=!1,e;var o=n.document,r=n.document,i=n.DocumentFragment,u=n.HTMLTemplateElement,a=n.Node,c=n.Element,s=n.NodeFilter,f=n.NamedNodeMap,l=void 0===f?n.NamedNodeMap||n.MozNamedAttrMap:f,d=n.HTMLFormElement,m=n.DOMParser,g=n.trustedTypes,p=c.prototype,h=Xh(p,"cloneNode"),v=Xh(p,"nextSibling"),b=Xh(p,"childNodes"),y=Xh(p,"parentNode");if("function"==typeof u){var x=r.createElement("template");x.content&&x.content.ownerDocument&&(r=x.content.ownerDocument)}var w=mv(g,o),S=w?w.createHTML(""):"",k=r,C=k.implementation,O=k.createNodeIterator,_=k.createDocumentFragment,T=k.getElementsByTagName,E=o.importNode,D={};try{D=Gh(r).documentMode?r.documentMode:{}}catch(t){}var A={};e.isSupported="function"==typeof y&&C&&void 0!==C.createHTMLDocument&&9!==D;var B,M,F=rv,I=iv,R=uv,N=av,P=sv,V=fv,H=cv,L=null,z=Wh({},[].concat(xh(qh),xh(Yh),xh(Kh),xh($h),xh(Zh))),U=null,j=Wh({},[].concat(xh(tv),xh(nv),xh(ev),xh(ov))),W=Object.seal(Object.create(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),G=null,X=null,q=!0,Y=!0,K=!1,J=!1,$=!1,Q=!1,Z=!1,tt=!1,nt=!1,et=!1,ot=!0,rt=!0,it=!1,ut={},at=null,ct=Wh({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]),st=null,ft=Wh({},["audio","video","img","source","image","track"]),lt=null,dt=Wh({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),mt="http://www.w3.org/1998/Math/MathML",gt="http://www.w3.org/2000/svg",pt="http://www.w3.org/1999/xhtml",ht=pt,vt=!1,bt=["application/xhtml+xml","text/html"],yt="text/html",xt=null,wt=r.createElement("form"),St=function(t){return t instanceof RegExp||t instanceof Function},kt=function(t){xt&&xt===t||(t&&"object"===hh(t)||(t={}),t=Gh(t),L="ALLOWED_TAGS"in t?Wh({},t.ALLOWED_TAGS):z,U="ALLOWED_ATTR"in t?Wh({},t.ALLOWED_ATTR):j,lt="ADD_URI_SAFE_ATTR"in t?Wh(Gh(dt),t.ADD_URI_SAFE_ATTR):dt,st="ADD_DATA_URI_TAGS"in t?Wh(Gh(ft),t.ADD_DATA_URI_TAGS):ft,at="FORBID_CONTENTS"in t?Wh({},t.FORBID_CONTENTS):ct,G="FORBID_TAGS"in t?Wh({},t.FORBID_TAGS):{},X="FORBID_ATTR"in t?Wh({},t.FORBID_ATTR):{},ut="USE_PROFILES"in t&&t.USE_PROFILES,q=!1!==t.ALLOW_ARIA_ATTR,Y=!1!==t.ALLOW_DATA_ATTR,K=t.ALLOW_UNKNOWN_PROTOCOLS||!1,J=t.SAFE_FOR_TEMPLATES||!1,$=t.WHOLE_DOCUMENT||!1,tt=t.RETURN_DOM||!1,nt=t.RETURN_DOM_FRAGMENT||!1,et=t.RETURN_TRUSTED_TYPE||!1,Z=t.FORCE_BODY||!1,ot=!1!==t.SANITIZE_DOM,rt=!1!==t.KEEP_CONTENT,it=t.IN_PLACE||!1,H=t.ALLOWED_URI_REGEXP||H,ht=t.NAMESPACE||pt,t.CUSTOM_ELEMENT_HANDLING&&St(t.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(W.tagNameCheck=t.CUSTOM_ELEMENT_HANDLING.tagNameCheck),t.CUSTOM_ELEMENT_HANDLING&&St(t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(W.attributeNameCheck=t.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),t.CUSTOM_ELEMENT_HANDLING&&"boolean"==typeof t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements&&(W.allowCustomizedBuiltInElements=t.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),B=B=-1===bt.indexOf(t.PARSER_MEDIA_TYPE)?yt:t.PARSER_MEDIA_TYPE,M="application/xhtml+xml"===B?function(t){return t}:Nh,J&&(Y=!1),nt&&(tt=!0),ut&&(L=Wh({},xh(Zh)),U=[],!0===ut.html&&(Wh(L,qh),Wh(U,tv)),!0===ut.svg&&(Wh(L,Yh),Wh(U,nv),Wh(U,ov)),!0===ut.svgFilters&&(Wh(L,Kh),Wh(U,nv),Wh(U,ov)),!0===ut.mathMl&&(Wh(L,$h),Wh(U,ev),Wh(U,ov))),t.ADD_TAGS&&(L===z&&(L=Gh(L)),Wh(L,t.ADD_TAGS)),t.ADD_ATTR&&(U===j&&(U=Gh(U)),Wh(U,t.ADD_ATTR)),t.ADD_URI_SAFE_ATTR&&Wh(lt,t.ADD_URI_SAFE_ATTR),t.FORBID_CONTENTS&&(at===ct&&(at=Gh(at)),Wh(at,t.FORBID_CONTENTS)),rt&&(L["#text"]=!0),$&&Wh(L,["html","head","body"]),L.table&&(Wh(L,["tbody"]),delete G.tbody),Th&&Th(t),xt=t)},Ct=Wh({},["mi","mo","mn","ms","mtext"]),Ot=Wh({},["foreignobject","desc","title","annotation-xml"]),_t=Wh({},["title","style","font","a","script"]),Tt=Wh({},Yh);Wh(Tt,Kh),Wh(Tt,Jh);var Et=Wh({},$h);Wh(Et,Qh);var Dt=function(t){var n=y(t);n&&n.tagName||(n={namespaceURI:pt,tagName:"template"});var e=Nh(t.tagName),o=Nh(n.tagName);return t.namespaceURI===gt?n.namespaceURI===pt?"svg"===e:n.namespaceURI===mt?"svg"===e&&("annotation-xml"===o||Ct[o]):Boolean(Tt[e]):t.namespaceURI===mt?n.namespaceURI===pt?"math"===e:n.namespaceURI===gt?"math"===e&&Ot[o]:Boolean(Et[e]):t.namespaceURI===pt&&!(n.namespaceURI===gt&&!Ot[o])&&!(n.namespaceURI===mt&&!Ct[o])&&!Et[e]&&(_t[e]||!Tt[e])},At=function(t){Rh(e.removed,{element:t});try{t.parentNode.removeChild(t)}catch(n){try{t.outerHTML=S}catch(n){t.remove()}}},Bt=function(t,n){try{Rh(e.removed,{attribute:n.getAttributeNode(t),from:n})}catch(t){Rh(e.removed,{attribute:null,from:n})}if(n.removeAttribute(t),"is"===t&&!U[t])if(tt||nt)try{At(n)}catch(t){}else try{n.setAttribute(t,"")}catch(t){}},Mt=function(t){var n,e;if(Z)t="<remove></remove>"+t;else{var o=Ph(t,/^[\r\n\t ]+/);e=o&&o[0]}"application/xhtml+xml"===B&&(t='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+t+"</body></html>");var i=w?w.createHTML(t):t;if(ht===pt)try{n=(new m).parseFromString(i,B)}catch(t){}if(!n||!n.documentElement){n=C.createDocument(ht,"template",null);try{n.documentElement.innerHTML=vt?"":i}catch(t){}}var u=n.body||n.documentElement;return t&&e&&u.insertBefore(r.createTextNode(e),u.childNodes[0]||null),ht===pt?T.call(n,$?"html":"body")[0]:$?n.documentElement:u},Ft=function(t){return O.call(t.ownerDocument||t,t,s.SHOW_ELEMENT|s.SHOW_COMMENT|s.SHOW_TEXT,null,!1)},It=function(t){return t instanceof d&&("string"!=typeof t.nodeName||"string"!=typeof t.textContent||"function"!=typeof t.removeChild||!(t.attributes instanceof l)||"function"!=typeof t.removeAttribute||"function"!=typeof t.setAttribute||"string"!=typeof t.namespaceURI||"function"!=typeof t.insertBefore)},Rt=function(t){return"object"===hh(a)?t instanceof a:t&&"object"===hh(t)&&"number"==typeof t.nodeType&&"string"==typeof t.nodeName},Nt=function(t,n,o){A[t]&&Fh(A[t],(function(t){t.call(e,n,o,xt)}))},Pt=function(t){var n;if(Nt("beforeSanitizeElements",t,null),It(t))return At(t),!0;if(zh(/[\u0080-\uFFFF]/,t.nodeName))return At(t),!0;var o=M(t.nodeName);if(Nt("uponSanitizeElement",t,{tagName:o,allowedTags:L}),t.hasChildNodes()&&!Rt(t.firstElementChild)&&(!Rt(t.content)||!Rt(t.content.firstElementChild))&&zh(/<[/\w]/g,t.innerHTML)&&zh(/<[/\w]/g,t.textContent))return At(t),!0;if("select"===o&&zh(/<template/i,t.innerHTML))return At(t),!0;if(!L[o]||G[o]){if(!G[o]&&Ht(o)){if(W.tagNameCheck instanceof RegExp&&zh(W.tagNameCheck,o))return!1;if(W.tagNameCheck instanceof Function&&W.tagNameCheck(o))return!1}if(rt&&!at[o]){var r=y(t)||t.parentNode,i=b(t)||t.childNodes;if(i&&r)for(var u=i.length-1;u>=0;--u)r.insertBefore(h(i[u],!0),v(t))}return At(t),!0}return t instanceof c&&!Dt(t)?(At(t),!0):"noscript"!==o&&"noembed"!==o||!zh(/<\/no(script|embed)/i,t.innerHTML)?(J&&3===t.nodeType&&(n=t.textContent,n=Vh(n,F," "),n=Vh(n,I," "),t.textContent!==n&&(Rh(e.removed,{element:t.cloneNode()}),t.textContent=n)),Nt("afterSanitizeElements",t,null),!1):(At(t),!0)},Vt=function(t,n,e){if(ot&&("id"===n||"name"===n)&&(e in r||e in wt))return!1;if(Y&&!X[n]&&zh(R,n));else if(q&&zh(N,n));else if(!U[n]||X[n]){if(!(Ht(t)&&(W.tagNameCheck instanceof RegExp&&zh(W.tagNameCheck,t)||W.tagNameCheck instanceof Function&&W.tagNameCheck(t))&&(W.attributeNameCheck instanceof RegExp&&zh(W.attributeNameCheck,n)||W.attributeNameCheck instanceof Function&&W.attributeNameCheck(n))||"is"===n&&W.allowCustomizedBuiltInElements&&(W.tagNameCheck instanceof RegExp&&zh(W.tagNameCheck,e)||W.tagNameCheck instanceof Function&&W.tagNameCheck(e))))return!1}else if(lt[n]);else if(zh(H,Vh(e,V,"")));else if("src"!==n&&"xlink:href"!==n&&"href"!==n||"script"===t||0!==Hh(e,"data:")||!st[t])if(K&&!zh(P,Vh(e,V,"")));else if(e)return!1;return!0},Ht=function(t){return t.indexOf("-")>0},Lt=function(t){var n,o,r,i;Nt("beforeSanitizeAttributes",t,null);var u=t.attributes;if(u){var a={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:U};for(i=u.length;i--;){var c=n=u[i],s=c.name,f=c.namespaceURI;if(o="value"===s?n.value:Lh(n.value),r=M(s),a.attrName=r,a.attrValue=o,a.keepAttr=!0,a.forceKeepAttr=void 0,Nt("uponSanitizeAttribute",t,a),o=a.attrValue,!a.forceKeepAttr&&(Bt(s,t),a.keepAttr))if(zh(/\/>/i,o))Bt(s,t);else{J&&(o=Vh(o,F," "),o=Vh(o,I," "));var l=M(t.nodeName);if(Vt(l,r,o))try{f?t.setAttributeNS(f,s,o):t.setAttribute(s,o),Ih(e.removed)}catch(t){}}}Nt("afterSanitizeAttributes",t,null)}},zt=function t(n){var e,o=Ft(n);for(Nt("beforeSanitizeShadowDOM",n,null);e=o.nextNode();)Nt("uponSanitizeShadowNode",e,null),Pt(e)||(e.content instanceof i&&t(e.content),Lt(e));Nt("afterSanitizeShadowDOM",n,null)};return e.sanitize=function(t,r){var u,c,s,f,l;if((vt=!t)&&(t="\x3c!--\x3e"),"string"!=typeof t&&!Rt(t)){if("function"!=typeof t.toString)throw Uh("toString is not a function");if("string"!=typeof(t=t.toString()))throw Uh("dirty is not a string, aborting")}if(!e.isSupported){if("object"===hh(n.toStaticHTML)||"function"==typeof n.toStaticHTML){if("string"==typeof t)return n.toStaticHTML(t);if(Rt(t))return n.toStaticHTML(t.outerHTML)}return t}if(Q||kt(r),e.removed=[],"string"==typeof t&&(it=!1),it){if(t.nodeName){var d=M(t.nodeName);if(!L[d]||G[d])throw Uh("root node is forbidden and cannot be sanitized in-place")}}else if(t instanceof a)1===(c=(u=Mt("\x3c!----\x3e")).ownerDocument.importNode(t,!0)).nodeType&&"BODY"===c.nodeName||"HTML"===c.nodeName?u=c:u.appendChild(c);else{if(!tt&&!J&&!$&&-1===t.indexOf("<"))return w&&et?w.createHTML(t):t;if(!(u=Mt(t)))return tt?null:et?S:""}u&&Z&&At(u.firstChild);for(var m=Ft(it?t:u);s=m.nextNode();)3===s.nodeType&&s===f||Pt(s)||(s.content instanceof i&&zt(s.content),Lt(s),f=s);if(f=null,it)return t;if(tt){if(nt)for(l=_.call(u.ownerDocument);u.firstChild;)l.appendChild(u.firstChild);else l=u;return U.shadowroot&&(l=E.call(o,l,!0)),l}var g=$?u.outerHTML:u.innerHTML;return $&&L["!doctype"]&&u.ownerDocument&&u.ownerDocument.doctype&&u.ownerDocument.doctype.name&&zh(lv,u.ownerDocument.doctype.name)&&(g="<!DOCTYPE "+u.ownerDocument.doctype.name+">\n"+g),J&&(g=Vh(g,F," "),g=Vh(g,I," ")),w&&et?w.createHTML(g):g},e.setConfig=function(t){kt(t),Q=!0},e.clearConfig=function(){xt=null,Q=!1},e.isValidAttribute=function(t,n,e){xt||kt({});var o=M(t),r=M(n);return Vt(o,r,e)},e.addHook=function(t,n){"function"==typeof n&&(A[t]=A[t]||[],Rh(A[t],n))},e.removeHook=function(t){if(A[t])return Ih(A[t])},e.removeHooks=function(t){A[t]&&(A[t]=[])},e.removeAllHooks=function(){A={}},e}(),pv=function(t){return gv().sanitize(t)},hv=tinymce.util.Tools.resolve("tinymce.util.I18n"),vv={indent:!0,outdent:!0,"table-insert-column-after":!0,"table-insert-column-before":!0,"paste-column-after":!0,"paste-column-before":!0,"unordered-list":!0,"list-bull-circle":!0,"list-bull-default":!0,"list-bull-square":!0},bv="temporary-placeholder",yv=function(t){return function(){return bt(t,bv).getOr("!not found!")}},xv=function(t,n){var e=t.toLowerCase();if(hv.isRtl()){var o=function(t,n){return Et(t,n)?t:function(t,n){return t+n}(t,n)}(e,"-rtl");return yt(n,o)?o:e}return e},wv=function(t,n){return bt(n,xv(t,n))},Sv=function(t,n){var e=n();return wv(t,e).getOrThunk(yv(e))},kv=function(){return rp("add-focusable",[Li((function(t){ea(t.element,"svg").each((function(t){return Hn(t,"focusable","false")}))}))])},Cv=function(t,n,e,o){var r,i,u=function(t){return!!hv.isRtl()&&yt(vv,t)}(n)?["tox-icon--flip"]:[],a=bt(e,xv(n,e)).or(o).getOrThunk(yv(e));return{dom:{tag:t.tag,attributes:null!==(r=t.attributes)&&void 0!==r?r:{},classes:t.classes.concat(u),innerHtml:a},behaviours:gc(D(D([],null!==(i=t.behaviours)&&void 0!==i?i:[],!0),[kv()],!1))}},Ov=function(t,n,e,o){return void 0===o&&(o=F.none()),Cv(n,t,e(),o)},_v={success:"checkmark",error:"warning",err:"error",warning:"warning",warn:"warning",info:"info"},Tv=_d({name:"Notification",factory:function(t){var n=ph({dom:gh("<p>"+pv(t.translationProvider(t.text))+"</p>"),behaviours:gc([op.config({})])}),e=function(t){return{dom:{tag:"div",classes:["tox-bar"],attributes:{style:"width: "+t+"%"}}}},o=function(t){return{dom:{tag:"div",classes:["tox-text"],innerHtml:t+"%"}}},r=ph({dom:{tag:"div",classes:t.progress?["tox-progress-bar","tox-progress-indicator"]:["tox-progress-bar"]},components:[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(0)]},o(0)],behaviours:gc([op.config({})])}),i={updateProgress:function(t,n){t.getSystem().isConnected()&&r.getOpt(t).each((function(t){op.set(t,[{dom:{tag:"div",classes:["tox-bar-container"]},components:[e(n)]},o(n)])}))},updateText:function(t,e){if(t.getSystem().isConnected()){var o=n.get(t);op.set(o,[Gu(e)])}}},u=J([t.icon.toArray(),t.level.toArray(),t.level.bind((function(t){return F.from(_v[t])})).toArray()]),a=ph(mh.sketch({dom:{tag:"button",classes:["tox-notification__dismiss","tox-button","tox-button--naked","tox-button--icon"]},components:[Ov("close",{tag:"div",classes:["tox-icon"],attributes:{"aria-label":t.translationProvider("Close")}},t.iconProvider)],action:function(n){t.onAction(n)}})),c=[function(t,n,e){var o=e(),r=Y(t,(function(t){return yt(o,xv(t,o))}));return Cv(n,r.getOr(bv),o,F.none())}(u,{tag:"div",classes:["tox-notification__icon"]},t.iconProvider),{dom:{tag:"div",classes:["tox-notification__body"]},components:[n.asSpec()],behaviours:gc([op.config({})])}];return{uid:t.uid,dom:{tag:"div",attributes:{role:"alert"},classes:t.level.map((function(t){return["tox-notification","tox-notification--in","tox-notification--"+t]})).getOr(["tox-notification","tox-notification--in"])},behaviours:gc([sp.config({}),rp("notification-events",[Mi(Hr(),(function(t){a.getOpt(t).each(sp.focus)}))])]),components:c.concat(t.progress?[r.asSpec()]:[]).concat(t.closeButton?[a.asSpec()]:[]),apis:i}},configFields:[Qo("level"),jo("progress"),jo("icon"),jo("onAction"),jo("text"),jo("iconProvider"),jo("translationProvider"),lr("closeButton",!0)],apis:{updateProgress:function(t,n,e){t.updateProgress(n,e)},updateText:function(t,n,e){t.updateText(n,e)}}});function Ev(t,n,e){var o=n.backstage.shared;return{open:function(n,r){var i=!n.closeButton&&n.timeout&&(n.timeout>0||n.timeout<0),u=function(){r(),Xp.hide(c)},a=Yu(Tv.sketch({text:n.text,level:V(["success","error","warning","warn","info"],n.type)?n.type:void 0,progress:!0===n.progressBar,icon:F.from(n.icon),closeButton:!i,onAction:u,iconProvider:o.providers.icons,translationProvider:o.providers.translate})),c=Yu(Xp.sketch(T({dom:{tag:"div",classes:["tox-notifications-container"]},lazySink:o.getSink,fireDismissalEventInstead:{}},o.header.isPositionedAtTop()?{}:{fireRepositionEventInstead:{}})));e.add(c),n.timeout>0&&dh.setTimeout((function(){u()}),n.timeout);var s=function(){var n=Ie(Ft.fromDom(t.getContentAreaContainer())),e=Ne(),o=Ha(e.x,n.x,n.right),r=Ha(e.y,n.y,n.bottom),i=Math.max(n.right,e.right),u=Math.max(n.bottom,e.bottom);return F.some(Fe(o,r,i-o,u-r))};return{close:u,moveTo:function(t,n){Xp.showAt(c,Ku(a),{anchor:{type:"makeshift",x:t,y:n}})},moveRel:function(t,n){var e=Ku(a),r={maxHeightFunction:ss()};if("banner"!==n&&l(t)){var i=function(t){switch(t){case"bc-bc":return ih;case"tc-tc":return rh;case"tc-bc":return Qa;case"bc-tc":default:return Za}}(n),u={type:"node",root:Nn(),node:F.some(Ft.fromDom(t)),overrides:r,layouts:{onRtl:function(){return[i]},onLtr:function(){return[i]}}};Xp.showWithinBounds(c,e,{anchor:u},s)}else{var f=T(T({},o.anchors.banner()),{overrides:r});Xp.showWithinBounds(c,e,{anchor:f},s)}},text:function(t){Tv.updateText(a,t)},settings:n,getEl:function(){return a.element.dom},progressBar:{value:function(t){Tv.updateProgress(a,t)}}}},close:function(t){t.close()},reposition:function(t){t.length>0&&j(t,(function(n,e){0===e?n.moveRel(null,"banner"):n.moveRel(t[e-1].getEl(),"bc-tc")}))},getArgs:function(t){return t.settings}}}var Dv,Av=function(t,n){var e=null;return{cancel:function(){a(e)||(clearTimeout(e),e=null)},throttle:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];a(e)&&(e=setTimeout((function(){e=null,t.apply(null,o)}),n))}}},Bv=function(t,n){var e=null,o=function(){a(e)||(clearTimeout(e),e=null)};return{cancel:o,throttle:function(){for(var r=[],i=0;i<arguments.length;i++)r[i]=arguments[i];o(),e=setTimeout((function(){e=null,t.apply(null,r)}),n)}}},Mv=tinymce.util.Tools.resolve("tinymce.dom.TextSeeker"),Fv=function(t,n,e,o,r){var i=Mv(t,(function(n){return function(t,n){return t.isBlock(n)||V(["BR","IMG","HR","INPUT"],n.nodeName)||"false"===t.getContentEditable(n)}(t,n)}));return F.from(i.backwards(n,e,o,r))},Iv=function(t,n){return Rv(Ft.fromDom(t.selection.getNode())).getOrThunk((function(){var e=Ft.fromHtml('<span data-mce-autocompleter="1" data-mce-bogus="1"></span>',t.getDoc());return we(e,Ft.fromDom(n.extractContents())),n.insertNode(e.dom),wn(e).each((function(t){return t.dom.normalize()})),function(t){return Qs(t,$s)}(e).map((function(n){t.selection.setCursorLocation(n.dom,function(t){return"img"===Rt(t)?1:Ks(t).fold((function(){return kn(t).length}),(function(t){return t.length}))}(n))})),e}))},Rv=function(t){return ra(t,"[data-mce-autocompleter]")},Nv=function(t){return t.toString().replace(/\u00A0/g," ").replace(/\uFEFF/g,"")},Pv=function(t){return""!==t&&-1!=="  \f\n\r\t\v".indexOf(t)},Vv=function(t,n){return t.substring(n.length)},Hv=function(t,n,e,o){if(void 0===o&&(o=0),!function(t){return t.collapsed&&3===t.startContainer.nodeType}(n))return F.none();var r=t.getParent(n.startContainer,t.isBlock)||t.getRoot();return Fv(t,n.startContainer,n.startOffset,(function(t,n,o){return function(t,n,e){var o;for(o=n-1;o>=0;o--){var r=t.charAt(o);if(Pv(r))return F.none();if(r===e)break}return F.some(o)}(o,n,e).getOr(n)}),r).bind((function(t){var r=n.cloneRange();if(r.setStart(t.container,t.offset),r.setEnd(n.endContainer,n.endOffset),r.collapsed)return F.none();var i=Nv(r);return 0!==i.lastIndexOf(e)||Vv(i,e).length<o?F.none():F.some({text:Vv(i,e),range:r,triggerChar:e})}))},Lv=function(t,n,e,o){return void 0===o&&(o=0),Rv(Ft.fromDom(n.startContainer)).fold((function(){return Hv(t,n,e,o)}),(function(n){var o=t.createRng();o.selectNode(n.dom);var r=Nv(o);return F.some({range:o,text:Vv(r,e),triggerChar:e})}))},zv=function(t,n){n.on("keypress compositionend",t.onKeypress.throttle),n.on("remove",t.onKeypress.cancel);var e=function(t,n){Ci(t,zr(),{raw:n})};n.on("keydown",(function(n){var o=function(){return t.getView().bind(em.getHighlighted)};8===n.which&&t.onKeypress.throttle(n),t.isActive()&&(27===n.which&&t.cancelIfNecessary(),t.isMenuOpen()?13===n.which?(o().each(Oi),n.preventDefault()):40===n.which?(o().fold((function(){t.getView().each(em.highlightFirst)}),(function(t){e(t,n)})),n.preventDefault(),n.stopImmediatePropagation()):37!==n.which&&38!==n.which&&39!==n.which||o().each((function(t){e(t,n),n.preventDefault(),n.stopImmediatePropagation()})):13!==n.which&&38!==n.which&&40!==n.which||t.cancelIfNecessary())})),n.on("NodeChange",(function(n){t.isActive()&&!t.isProcessingAction()&&Rv(Ft.fromDom(n.element)).isNone()&&t.cancelIfNecessary()}))},Uv=tinymce.util.Tools.resolve("tinymce.util.Promise"),jv=function(t,n){return{container:t,offset:n}},Wv=function(t){if(function(t){return 3===t.nodeType}(t))return jv(t,t.data.length);var n=t.childNodes;return n.length>0?Wv(n[n.length-1]):jv(t,n.length)},Gv=function(t,n){var e=t.childNodes;return e.length>0&&n<e.length?Gv(e[n],0):e.length>0&&function(t){return 1===t.nodeType}(t)&&e.length===n?Wv(e[e.length-1]):jv(t,n)},Xv=function(t){return function(n){var e=Gv(n.startContainer,n.startOffset);return!function(t,n){return Fv(t,n.container,n.offset,(function(t,n){return 0===n?-1:n}),t.getRoot()).filter((function(t){var n=t.container.data.charAt(t.offset-1);return!Pv(n)})).isSome()}(t,e)}},qv=function(t,n){var e=n(),o=t.selection.getRng();return function(t,n,e){return ct(e.triggerChars,(function(e){return Lv(t,n,e)}))}(t.dom,o,e).bind((function(e){return Yv(t,n,e)}))},Yv=function(t,n,e,o){void 0===o&&(o={});var r=n(),i=t.selection.getRng().startContainer.nodeValue,u=G(r.lookupByChar(e.triggerChar),(function(n){return e.text.length>=n.minChars&&n.matches.getOrThunk((function(){return Xv(t.dom)}))(e.range,i,e.text)}));if(0===u.length)return F.none();var a=Uv.all(U(u,(function(t){return t.fetch(e.text,t.maxResults,o).then((function(n){return{matchText:e.text,items:n,columns:t.columns,onAction:t.onAction,highlightOn:t.highlightOn}}))})));return F.some({lookupData:a,context:e})},Kv=yo([Xo("type"),nr("text")]),Jv=yo([ur("type","autocompleteitem"),ur("active",!1),ur("disabled",!1),ur("meta",{}),Xo("value"),nr("text"),nr("icon")]),$v=yo([Xo("type"),Xo("ch"),cr("minChars",1),ur("columns",1),cr("maxResults",10),er("matches"),Yo("fetch"),Yo("onAction"),mr("highlightOn",[],_o)]),Qv=[lr("disabled",!1),nr("tooltip"),nr("icon"),nr("text"),dr("onSetup",(function(){return p}))],Zv=yo([Xo("type"),Yo("onAction")].concat(Qv)),tb=function(t){return Ro("toolbarbutton",Zv,t)},nb=[lr("active",!1)].concat(Qv),eb=yo(nb.concat([Xo("type"),Yo("onAction")])),ob=function(t){return Ro("ToggleButton",eb,t)},rb=[dr("predicate",C),fr("scope","node",["node","editor"]),fr("position","selection",["node","selection","line"])],ib=Qv.concat([ur("type","contextformbutton"),ur("primary",!1),Yo("onAction"),zo("original",y)]),ub=nb.concat([ur("type","contextformbutton"),ur("primary",!1),Yo("onAction"),zo("original",y)]),ab=Qv.concat([ur("type","contextformbutton")]),cb=nb.concat([ur("type","contextformtogglebutton")]),sb=Ho("type",{contextformbutton:ib,contextformtogglebutton:ub}),fb=yo([ur("type","contextform"),dr("initValue",b("")),nr("label"),$o("commands",sb),Zo("launch",Ho("type",{contextformbutton:ab,contextformtogglebutton:cb}))].concat(rb)),lb=yo([ur("type","contexttoolbar"),Xo("items")].concat(rb)),db=function(t){var n=t.ui.registry.getAll().popups,e=dt(n,(function(t){return function(t){return Ro("Autocompleter",$v,t)}(t).fold((function(t){throw new Error(Vo(t))}),y)})),o=function(t){var n={};return j(t,(function(t){n[t]={}})),st(n)}(pt(e,(function(t){return t.ch}))),r=vt(e);return{dataset:e,triggerChars:o,lookupByChar:function(t){return G(r,(function(n){return n.ch===t}))}}};!function(t){t[t.CLOSE_ON_EXECUTE=0]="CLOSE_ON_EXECUTE",t[t.BUBBLE_TO_SANDBOX=1]="BUBBLE_TO_SANDBOX"}(Dv||(Dv={}));var mb,gb=Dv,pb="tox-menu-nav__js",hb="tox-collection__item",vb="tox-swatch",bb={normal:pb,color:vb},yb="tox-collection__item--enabled",xb="tox-collection__item-icon",wb="tox-collection__item-label",Sb="tox-collection__item-caret",kb="tox-collection__item--active",Cb="tox-collection__item-container",Ob="tox-collection__item-container--row",_b=function(t){return bt(bb,t).getOr(pb)},Tb=function(t){return"color"===t?"tox-swatches":"tox-menu"},Eb=function(t){return{backgroundMenu:"tox-background-menu",selectedMenu:"tox-selected-menu",selectedItem:"tox-collection__item--active",hasIcons:"tox-menu--has-icons",menu:Tb(t),tieredMenu:"tox-tiered-menu"}},Db=function(t){var n=Eb(t);return{backgroundMenu:n.backgroundMenu,selectedMenu:n.selectedMenu,menu:n.menu,selectedItem:n.selectedItem,item:_b(t)}},Ab=function(t,n,e){var o=Eb(e);return{tag:"div",classes:J([[o.menu,"tox-menu-"+n+"-column"],t?[o.hasIcons]:[]])}},Bb=[Hp.parts.items({})],Mb=function(t,n,e){var o=Eb(e);return{dom:{tag:"div",classes:J([[o.tieredMenu]])},markers:Db(e)}},Fb=function(t,n){return function(e){var o=z(e,n);return U(o,(function(n){return{dom:t,components:n}}))}},Ib=function(t,n){var e=[],o=[];return j(t,(function(t,r){n(t,r)?(o.length>0&&e.push(o),o=[],yt(t.dom,"innerHtml")&&o.push(t)):o.push(t)})),o.length>0&&e.push(o),U(e,(function(t){return{dom:{tag:"div",classes:["tox-collection__group"]},components:t}}))},Rb=function(t,n,e){return{dom:{tag:"div",classes:["tox-menu","tox-collection"].concat(1===t?["tox-collection--list"]:["tox-collection--grid"])},components:[Hp.parts.items({preprocess:function(e){return"auto"!==t&&t>1?Fb({tag:"div",classes:["tox-collection__group"]},t)(e):Ib(e,(function(t,e){return"separator"===n[e].type}))}})]}},Nb=function(t){return H(t,(function(t){return"icon"in t&&void 0!==t.icon}))},Pb=function(t){return console.error(Vo(t)),console.log(t),F.none()},Vb=function(t,n,e,o,r){var i=function(t,n){return{dom:{tag:"div",classes:["tox-collection","tox-collection--horizontal"]},components:[Hp.parts.items({preprocess:function(n){return Ib(n,(function(n,e){return"separator"===t[e].type}))}})]}}(e);return{value:t,dom:i.dom,components:i.components,items:e}},Hb=function(t,n,e,o,r){if("color"===r){var i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-swatches-menu"]},components:[{dom:{tag:"div",classes:["tox-swatches"]},components:[Hp.parts.items({preprocess:"auto"!==t?Fb({tag:"div",classes:["tox-swatches__row"]},t):y})]}]}}(o);return{value:t,dom:i.dom,components:i.components,items:e}}return"normal"===r&&"auto"===o?{value:t,dom:(i=Rb(o,e)).dom,components:i.components,items:e}:"normal"===r&&1===o?{value:t,dom:(i=Rb(1,e)).dom,components:i.components,items:e}:"normal"===r?{value:t,dom:(i=Rb(o,e)).dom,components:i.components,items:e}:"listpreview"===r&&"auto"!==o?{value:t,dom:(i=function(t){return{dom:{tag:"div",classes:["tox-menu","tox-collection","tox-collection--toolbar","tox-collection--toolbar-lg"]},components:[Hp.parts.items({preprocess:Fb({tag:"div",classes:["tox-collection__group"]},t)})]}}(o)).dom,components:i.components,items:e}:{value:t,dom:Ab(n,o,r),components:Bb,items:e}},Lb=[Xo("type"),Xo("src"),nr("alt"),mr("classes",[],_o)],zb=yo(Lb),Ub=[Xo("type"),Xo("text"),nr("name"),mr("classes",["tox-collection__item-label"],_o)],jb=yo(Ub),Wb=vo((function(){return Mo("type",{cardimage:zb,cardtext:jb,cardcontainer:Gb})})),Gb=yo([Xo("type"),sr("direction","horizontal"),sr("align","left"),sr("valign","middle"),$o("items",Wb)]),Xb=[lr("disabled",!1),nr("text"),nr("shortcut"),Lo("value","value",ro((function(){return Qi("menuitem-value")})),ko()),ur("meta",{})],qb=yo([Xo("type"),nr("label"),$o("items",Wb),dr("onSetup",(function(){return p})),dr("onAction",p)].concat(Xb)),Yb=yo([Xo("type"),lr("active",!1),nr("icon")].concat(Xb)),Kb=[Xo("type"),Xo("fancytype"),dr("onAction",p)],Jb=[ur("initData",{})].concat(Kb),$b=[gr("initData",{},[lr("allowCustomColors",!0),or("colors",ko())])].concat(Kb),Qb=Ho("fancytype",{inserttable:Jb,colorswatch:$b}),Zb=yo([Xo("type"),dr("onSetup",(function(){return p})),dr("onAction",p),nr("icon")].concat(Xb)),ty=yo([Xo("type"),Yo("getSubmenuItems"),dr("onSetup",(function(){return p})),nr("icon")].concat(Xb)),ny=yo([Xo("type"),nr("icon"),lr("active",!1),dr("onSetup",(function(){return p})),Yo("onAction")].concat(Xb)),ey=function(t,n,e){var o=Zs(t.element,"."+e);if(o.length>0){var r=K(o,(function(t){var e=t.dom.getBoundingClientRect().top,r=o[0].dom.getBoundingClientRect().top;return Math.abs(e-r)>n})).getOr(o.length);return F.some({numColumns:r,numRows:Math.ceil(o.length/r)})}return F.none()},oy=function(t,n){return gc([rp(t,n)])},ry=function(t){return oy(Qi("unnamed-events"),t)},iy=Qi("tooltip.exclusive"),uy=Qi("tooltip.show"),ay=Qi("tooltip.hide"),cy=function(t,n,e){t.getSystem().broadcastOn([iy],{})},sy=Object.freeze({__proto__:null,hideAllExclusive:cy,setComponents:function(t,n,e,o){e.getTooltip().each((function(t){t.getSystem().isConnected()&&op.set(t,o)}))}}),fy=Object.freeze({__proto__:null,events:function(t,n){var e=function(e){n.getTooltip().each((function(o){zf(o),t.onHide(e,o),n.clearTooltip()})),n.clearTimer()};return Di(J([[Mi(uy,(function(e){n.resetTimer((function(){!function(e){if(!n.isShowing()){cy(e);var o=t.lazySink(e).getOrDie(),r=e.getSystem().build({dom:t.tooltipDom,components:t.tooltipComponents,events:Di("normal"===t.mode?[Mi(Vr(),(function(t){ki(e,uy)})),Mi(Nr(),(function(t){ki(e,ay)}))]:[]),behaviours:gc([op.config({})])});n.setTooltip(r),Vf(o,r),t.onShow(e,r),Ff.position(o,r,{anchor:t.anchor(e)})}}(e)}),t.delay)})),Mi(ay,(function(o){n.resetTimer((function(){e(o)}),t.delay)})),Mi(ni(),(function(t,n){var o=n;o.universal||V(o.channels,iy)&&e(t)})),zi((function(t){e(t)}))],"normal"===t.mode?[Mi(Hr(),(function(t){ki(t,uy)})),Mi(Zr(),(function(t){ki(t,ay)})),Mi(Vr(),(function(t){ki(t,uy)})),Mi(Nr(),(function(t){ki(t,ay)}))]:[Mi(wi(),(function(t,n){ki(t,uy)})),Mi(Si(),(function(t){ki(t,ay)}))]]))}}),ly=[jo("lazySink"),jo("tooltipDom"),ur("exclusive",!0),ur("tooltipComponents",[]),ur("delay",300),fr("mode","normal",["normal","follow-highlight"]),ur("anchor",(function(t){return{type:"hotspot",hotspot:t,layouts:{onLtr:b([Za,Qa,Ya,Ja,Ka,$a]),onRtl:b([Za,Qa,Ya,Ja,Ka,$a])}}})),wa("onHide"),wa("onShow")],dy=Object.freeze({__proto__:null,init:function(){var t=qc(),n=qc(),e=function(){t.on(clearTimeout)},o=b("not-implemented");return pu({getTooltip:n.get,isShowing:n.isSet,setTooltip:n.set,clearTooltip:n.clear,clearTimer:e,resetTimer:function(n,o){e(),t.set(setTimeout(n,o))},readState:o})}}),my=hc({fields:ly,name:"tooltipping",active:fy,state:dy,apis:sy}),gy=tinymce.util.Tools.resolve("tinymce.dom.DOMUtils"),py=tinymce.util.Tools.resolve("tinymce.EditorManager"),hy=function(t){return t.getParam("height",Math.max(t.getElement().offsetHeight,200))},vy=function(t){return t.getParam("width",gy.DOM.getStyle(t.getElement(),"width"))},by=function(t){return F.from(t.getParam("min_width")).filter(m)},yy=function(t){return F.from(t.getParam("min_height")).filter(m)},xy=function(t){return F.from(t.getParam("max_width")).filter(m)},wy=function(t){return F.from(t.getParam("max_height")).filter(m)},Sy=function(t){return!1!==t.getParam("menubar",!0,"boolean")},ky=function(t){var n=t.getParam("toolbar",!0),e=!0===n,o=r(n),i=u(n)&&n.length>0;return!Oy(t)&&(i||o||e)},Cy=function(t){var n=L(9,(function(n){return t.getParam("toolbar"+(n+1),!1,"string")})),e=G(n,(function(t){return"string"==typeof t}));return e.length>0?F.some(e):F.none()},Oy=function(t){return Cy(t).fold((function(){return t.getParam("toolbar",[],"string[]").length>0}),O)};!function(t){t.default="wrap",t.floating="floating",t.sliding="sliding",t.scrolling="scrolling"}(mb||(mb={}));var _y,Ty=function(t){return t.getParam("toolbar_mode","","string")};!function(t){t.auto="auto",t.top="top",t.bottom="bottom"}(_y||(_y={}));var Ey,Dy=function(t){return t.getParam("toolbar_location",_y.auto,"string")},Ay=function(t){return Dy(t)===_y.bottom},By=function(t){if(!t.inline)return F.none();var n=function(t){return t.getParam("fixed_toolbar_container","","string")}(t);if(n.length>0)return oa(Nn(),n);var e=function(t){return t.getParam("fixed_toolbar_container_target")}(t);return l(e)?F.some(Ft.fromDom(e)):F.none()},My=function(t){return t.inline&&By(t).isSome()},Fy=function(t){return By(t).getOrThunk((function(){return Bn(An(Ft.fromDom(t.getElement())))}))},Iy=function(t){return t.inline&&!Sy(t)&&!ky(t)&&!Oy(t)},Ry=function(t){return(t.getParam("toolbar_sticky",!1,"boolean")||t.inline)&&!My(t)&&!Iy(t)},Ny=function(t){var n=t.getParam("menu");return n?dt(n,(function(t){return T(T({},t),{items:t.items})})):{}},Py=function(t){return t.getParam("menubar")},Vy=function(t){return t.getParam("anchor_top","#top")},Hy=function(t){return t.getParam("anchor_bottom","#bottom")},Ly="silver.readonly",zy=yo([function(t){return Wo(t,To)}("readonly")]),Uy=function(t,n){var e=t.outerContainer.element;n&&(t.mothership.broadcastOn([ol()],{target:e}),t.uiMothership.broadcastOn([ol()],{target:e})),t.mothership.broadcastOn([Ly],{readonly:n}),t.uiMothership.broadcastOn([Ly],{readonly:n})},jy=function(t,n){t.on("init",(function(){t.mode.isReadOnly()&&Uy(n,!0)})),t.on("SwitchMode",(function(){return Uy(n,t.mode.isReadOnly())})),function(t){return t.getParam("readonly",!1,"boolean")}(t)&&t.setMode("readonly")},Wy=function(){var t;return xc.config({channels:(t={},t[Ly]={schema:zy,onReceive:function(t,n){Gd.set(t,n.readonly)}},t)})},Gy=function(t){return Gd.config({disabled:t,disableClass:"tox-collection__item--state-disabled"})},Xy=function(t){return Gd.config({disabled:t})},qy=function(t){return Gd.config({disabled:t,disableClass:"tox-tbtn--disabled"})},Yy=function(t){return Gd.config({disabled:t,disableClass:"tox-tbtn--disabled",useNative:!1})},Ky=function(t,n){var e=t.getApi(n);return function(t){t(e)}},Jy=function(t,n){return Li((function(e){Ky(t,e)((function(e){var o=t.onSetup(e);d(o)&&n.set(o)}))}))},$y=function(t,n){return zi((function(e){return Ky(t,e)(n.get())}))},Qy=function(t,n){return ji((function(e,o){Ky(t,e)(t.onAction),t.triggersSubmenu||n!==gb.CLOSE_ON_EXECUTE||(ki(e,ui()),o.stop())}))},Zy=((Ey={})[ei()]=["disabling","alloy.base.behaviour","toggling","item-events"],Ey),tx=St,nx=function(t,n,e,o){var r=pr(p);return{type:"item",dom:n.dom,components:tx(n.optComponents),data:t.data,eventOrder:Zy,hasSubmenu:t.triggersSubmenu,itemBehaviours:gc([rp("item-events",[Qy(t,e),Jy(t,r),$y(t,r)]),Gy((function(){return t.disabled||o.isDisabled()})),Wy(),op.config({})].concat(t.itemBehaviours))}},ex=function(t){return{value:t.value,meta:T({text:t.text.getOr("")},t.meta)}},ox=tinymce.util.Tools.resolve("tinymce.Env"),rx=function(t){var n=ox.mac?{alt:"&#x2325;",ctrl:"&#x2303;",shift:"&#x21E7;",meta:"&#x2318;",access:"&#x2303;&#x2325;"}:{meta:"Ctrl",access:"Shift+Alt"},e=t.split("+"),o=U(e,(function(t){var e=t.toLowerCase().trim();return yt(n,e)?n[e]:t}));return ox.mac?o.join(""):o.join("+")},ix=function(t,n,e){return void 0===e&&(e=[xb]),Ov(t,{tag:"div",classes:e},n)},ux=function(t){return{dom:{tag:"div",classes:[wb]},components:[Gu(hv.translate(t))]}},ax=function(t,n){return{dom:{tag:"div",classes:n,innerHtml:t}}},cx=function(t,n){return{dom:{tag:"div",classes:[wb]},components:[{dom:{tag:t.tag,styles:t.styles},components:[Gu(hv.translate(n))]}]}},sx=function(t){return{dom:{tag:"div",classes:["tox-collection__item-accessory"],innerHtml:rx(t)}}},fx=function(t){return ix("checkmark",t,["tox-collection__item-checkmark"])},lx=function(t,n,e){var o=t.ariaLabel,r=t.value,i=t.iconContent.map((function(t){return function(t,n,e){var o=n();return wv(t,o).or(e).getOrThunk(yv(o))}(t,n.icons,e)}));return{dom:function(){var t=i.getOr(""),e={tag:"div",attributes:o.map((function(t){return{title:n.translate(t)}})).getOr({}),classes:["tox-swatch"]};return T(T({},e),"custom"===r?{tag:"button",classes:D(D([],e.classes,!0),["tox-swatches__picker-btn"],!1),innerHtml:t}:"remove"===r?{classes:D(D([],e.classes,!0),["tox-swatch--remove"],!1),innerHtml:t}:{attributes:T(T({},e.attributes),{"data-mce-color":r}),styles:{"background-color":r}})}(),optComponents:[]}},dx=function(t){var n=t.map((function(t){return{attributes:{title:hv.translate(t)}}})).getOr({});return T({tag:"div",classes:[pb,hb]},n)},mx=function(t,n,e,o){return void 0===o&&(o=F.none()),"color"===t.presets?lx(t,n,o):function(t,n,e,o){var r={tag:"div",classes:[xb]},i=e?t.iconContent.map((function(t){return Ov(t,r,n.icons,o)})).orThunk((function(){return F.some({dom:r})})):F.none(),u=t.checkMark,a=F.from(t.meta).fold((function(){return ux}),(function(t){return yt(t,"style")?w(cx,t.style):ux})),c=t.htmlContent.fold((function(){return t.textContent.map(a)}),(function(t){return F.some(ax(t,[wb]))}));return{dom:dx(t.ariaLabel),optComponents:[i,c,t.shortcutContent.map(sx),u,t.caret]}}(t,n,e,o)},gx=function(t,n){return bt(t,"tooltipWorker").map((function(t){return[my.config({lazySink:n.getSink,tooltipDom:{tag:"div",classes:["tox-tooltip-worker-container"]},tooltipComponents:[],anchor:function(t){return{type:"submenu",item:t,overrides:{maxHeightFunction:ss}}},mode:"follow-highlight",onShow:function(n,e){t((function(t){my.setComponents(n,[Xu({element:Ft.fromDom(t)})])}))}})]})).getOr([])},px=function(t,n){var e=function(t){return gy.DOM.encode(t)}(hv.translate(t));if(n.length>0){var o=new RegExp(function(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}(n),"gi");return e.replace(o,(function(t){return'<span class="tox-autocompleter-highlight">'+t+"</span>"}))}return e},hx=function(t,n){return U(t,(function(t){switch(t.type){case"cardcontainer":return function(t,n){var e="vertical"===t.direction?"tox-collection__item-container--column":Ob,o="left"===t.align?"tox-collection__item-container--align-left":"tox-collection__item-container--align-right";return{dom:{tag:"div",classes:[Cb,e,o,function(){switch(t.valign){case"top":return"tox-collection__item-container--valign-top";case"middle":return"tox-collection__item-container--valign-middle";case"bottom":return"tox-collection__item-container--valign-bottom"}}()]},components:n}}(t,hx(t.items,n));case"cardimage":return function(t,n,e){return{dom:{tag:"img",classes:n,attributes:{src:t,alt:e.getOr("")}}}}(t.src,t.classes,t.alt);case"cardtext":var e=t.name.exists((function(t){return V(n.cardText.highlightOn,t)}))?F.from(n.cardText.matchText).getOr(""):"";return ax(px(t.text,e),t.classes)}}))},vx=id(Mp(),Fp()),bx=function(t){return{value:t}},yx=/^#?([a-f\d])([a-f\d])([a-f\d])$/i,xx=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,wx=function(t){return yx.test(t)||xx.test(t)},Sx=function(t){return function(t,n){return Tt(t,n)?function(t,n){return t.substring(n)}(t,n.length):t}(t,"#").toUpperCase()},kx=function(t){var n=function(t){return{value:t.value.replace(yx,(function(t,n,e,o){return n+n+e+e+o+o}))}}(t),e=xx.exec(n.value);return null===e?["FFFFFF","FF","FF","FF"]:e},Cx=function(t){var n=t.toString(16);return(1===n.length?"0"+n:n).toUpperCase()},Ox=function(t){var n=Cx(t.red)+Cx(t.green)+Cx(t.blue);return bx(n)},_x=Math.min,Tx=Math.max,Ex=Math.round,Dx=/^rgb\((\d+),\s*(\d+),\s*(\d+)\)/,Ax=/^rgba\((\d+),\s*(\d+),\s*(\d+),\s*(\d?(?:\.\d+)?)\)/,Bx=function(t,n,e,o){return{red:t,green:n,blue:e,alpha:o}},Mx=function(t){var n=parseInt(t,10);return n.toString()===t&&n>=0&&n<=255},Fx=function(t){var n,e,o,r=(t.hue||0)%360,i=t.saturation/100,u=t.value/100;if(i=Tx(0,_x(i,1)),u=Tx(0,_x(u,1)),0===i)return n=e=o=Ex(255*u),Bx(n,e,o,1);var a=r/60,c=u*i,s=c*(1-Math.abs(a%2-1)),f=u-c;switch(Math.floor(a)){case 0:n=c,e=s,o=0;break;case 1:n=s,e=c,o=0;break;case 2:n=0,e=c,o=s;break;case 3:n=0,e=s,o=c;break;case 4:n=s,e=0,o=c;break;case 5:n=c,e=0,o=s;break;default:n=e=o=0}return n=Ex(255*(n+f)),e=Ex(255*(e+f)),o=Ex(255*(o+f)),Bx(n,e,o,1)},Ix=function(t){var n=kx(t),e=parseInt(n[1],16),o=parseInt(n[2],16),r=parseInt(n[3],16);return Bx(e,o,r,1)},Rx=function(t,n,e,o){var r=parseInt(t,10),i=parseInt(n,10),u=parseInt(e,10),a=parseFloat(o);return Bx(r,i,u,a)},Nx=function(t){if("transparent"===t)return F.some(Bx(0,0,0,0));var n=Dx.exec(t);if(null!==n)return F.some(Rx(n[1],n[2],n[3],"1"));var e=Ax.exec(t);return null!==e?F.some(Rx(e[1],e[2],e[3],e[4])):F.none()},Px=function(t){return"rgba("+t.red+","+t.green+","+t.blue+","+t.alpha+")"},Vx=Bx(255,0,0,1),Hx=function(t,n){return t.fire("ResizeContent",n)},Lx=function(t,n,e){return{hue:t,saturation:n,value:e}},zx=function(t){var n,e=0,o=0,r=t.red/255,i=t.green/255,u=t.blue/255,a=Math.min(r,Math.min(i,u)),c=Math.max(r,Math.max(i,u));return a===c?Lx(0,0,100*(o=a)):(e=60*((e=r===a?3:u===a?1:5)-(r===a?i-u:u===a?r-i:u-r)/(c-a)),n=(c-a)/c,o=c,Lx(Math.round(e),Math.round(100*n),Math.round(100*o)))},Ux=function(t){return Ox(Fx(t))},jx=function(t){return function(t){return wx(t)?F.some({value:Sx(t)}):F.none()}(t).orThunk((function(){return Nx(t).map(Ox)})).getOrThunk((function(){var n=document.createElement("canvas");n.height=1,n.width=1;var e=n.getContext("2d");e.clearRect(0,0,n.width,n.height),e.fillStyle="#FFFFFF",e.fillStyle=t,e.fillRect(0,0,1,1);var o=e.getImageData(0,0,1,1).data,r=o[0],i=o[1],u=o[2],a=o[3];return Ox(Bx(r,i,u,a))}))},Wx=tinymce.util.Tools.resolve("tinymce.util.LocalStorage"),Gx="tinymce-custom-colors";var Xx,qx="choiceitem",Yx=[{type:qx,text:"Light Green",value:"#BFEDD2"},{type:qx,text:"Light Yellow",value:"#FBEEB8"},{type:qx,text:"Light Red",value:"#F8CAC6"},{type:qx,text:"Light Purple",value:"#ECCAFA"},{type:qx,text:"Light Blue",value:"#C2E0F4"},{type:qx,text:"Green",value:"#2DC26B"},{type:qx,text:"Yellow",value:"#F1C40F"},{type:qx,text:"Red",value:"#E03E2D"},{type:qx,text:"Purple",value:"#B96AD9"},{type:qx,text:"Blue",value:"#3598DB"},{type:qx,text:"Dark Turquoise",value:"#169179"},{type:qx,text:"Orange",value:"#E67E23"},{type:qx,text:"Dark Red",value:"#BA372A"},{type:qx,text:"Dark Purple",value:"#843FA1"},{type:qx,text:"Dark Blue",value:"#236FA1"},{type:qx,text:"Light Gray",value:"#ECF0F1"},{type:qx,text:"Medium Gray",value:"#CED4D9"},{type:qx,text:"Gray",value:"#95A5A6"},{type:qx,text:"Dark Gray",value:"#7E8C8D"},{type:qx,text:"Navy Blue",value:"#34495E"},{type:qx,text:"Black",value:"#000000"},{type:qx,text:"White",value:"#ffffff"}],Kx=function(t){void 0===t&&(t=10);var n=Wx.getItem(Gx),e=function(n){return t-n.length<0?n.slice(0,t):n}(r(n)?JSON.parse(n):[]),o=function(t){e.splice(t,1)};return{add:function(n){(function(t,n){var e=P(t,n);return-1===e?F.none():F.some(e)})(e,n).each(o),e.unshift(n),e.length>t&&e.pop(),Wx.setItem(Gx,JSON.stringify(e))},state:function(){return e.slice(0)}}}(10),Jx=function(t){return!1!==t.getParam("custom_colors")},$x=function(t){var n=function(t){return t.getParam("color_map")}(t);return void 0!==n?function(t){for(var n=[],e=0;e<t.length;e+=2)n.push({text:t[e+1],value:"#"+jx(t[e]).value,type:"choiceitem"});return n}(n):Yx},Qx=function(t){Kx.add(t)},Zx="#000000",tw=function(t){return function(t,n){return t.getParam("color_cols",n,"number")}(t,function(t){return Math.max(5,Math.ceil(Math.sqrt(t)))}($x(t).length))},nw=function(t){var n="choiceitem",e={type:n,text:"Remove color",icon:"color-swatch-remove-color",value:"remove"};return t?[e,{type:n,text:"Custom color",icon:"color-picker",value:"custom"}]:[e]},ew=function(t,n,e,o){"custom"===e?cw(t)((function(e){e.each((function(e){Qx(e),t.execCommand("mceApplyTextcolor",n,e),o(e)}))}),Zx):"remove"===e?(o(""),t.execCommand("mceRemoveTextcolor",n)):(o(e),t.execCommand("mceApplyTextcolor",n,e))},ow=function(t,n){return t.concat(U(Kx.state(),(function(t){return{type:qx,text:t,value:t}})).concat(nw(n)))},rw=function(t,n){return function(e){e(ow(t,n))}},iw=function(t,n,e){var o="forecolor"===n?"tox-icon-text-color__color":"tox-icon-highlight-bg-color__color";t.setIconFill(o,e)},uw=function(t,n,e,o,r){t.ui.registry.addSplitButton(n,{tooltip:o,presets:"color",icon:"forecolor"===n?"text-color":"highlight-bg-color",select:function(n){return function(t,n){var e;return t.dom.getParents(t.selection.getStart(),(function(t){var o;(o=t.style["forecolor"===n?"color":"background-color"])&&(e=e||o)})),F.from(e)}(t,e).bind((function(t){return Nx(t).map((function(t){var e=Ox(t).value;return _t(n.toLowerCase(),e)}))})).getOr(!1)},columns:tw(t),fetch:rw($x(t),Jx(t)),onAction:function(n){ew(t,e,r.get(),p)},onItemAction:function(o,i){ew(t,e,i,(function(e){r.set(e),function(t,n){t.fire("TextColorChange",n)}(t,{name:n,color:e})}))},onSetup:function(e){iw(e,n,r.get());var o=function(t){t.name===n&&iw(e,t.name,t.color)};return t.on("TextColorChange",o),function(){t.off("TextColorChange",o)}}})},aw=function(t,n,e,o){t.ui.registry.addNestedMenuItem(n,{text:o,icon:"forecolor"===n?"text-color":"highlight-bg-color",getSubmenuItems:function(){return[{type:"fancymenuitem",fancytype:"colorswatch",onAction:function(n){ew(t,e,n.value,p)}}]}})},cw=function(t){return function(n,e){var o=!1,r={colorpicker:e};t.windowManager.open({title:"Color Picker",size:"normal",body:{type:"panel",items:[{type:"colorpicker",name:"colorpicker",label:"Color"}]},buttons:[{type:"cancel",name:"cancel",text:"Cancel"},{type:"submit",name:"save",text:"Save",primary:!0}],initialData:r,onAction:function(t,n){"hex-valid"===n.name&&(o=n.value)},onSubmit:function(e){var r=e.getData().colorpicker;o?(n(F.from(r)),e.close()):t.windowManager.alert(t.translate(["Invalid hex color code: {0}",r]))},onClose:p,onCancel:function(){n(F.none())}})}},sw=function(t,n,e,o,r,i,u,a){var c=Nb(n),s=fw(n,e,o,"color"!==r?"normal":"color",i,u,a);return Hb(t,c,s,o,r)},fw=function(t,n,e,o,r,i,u){return St(U(t,(function(a){return"choiceitem"===a.type?function(t){return Ro("choicemenuitem",Yb,t)}(a).fold(Pb,(function(c){return F.some(function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=mx({presets:e,textContent:n?t.text:F.none(),htmlContent:F.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:n?t.shortcut:F.none(),checkMark:n?F.some(fx(u.icons)):F.none(),caret:F.none(),value:t.value},u,a);return eo(nx({data:ex(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){wp.set(t,n)},isActive:function(){return wp.isOn(t)},isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},onAction:function(n){return o(t.value)},onSetup:function(t){return t.setActive(r),p},triggersSubmenu:!1,itemBehaviours:[]},c,i,u),{toggling:{toggleClass:yb,toggleOnExecute:!1,selected:t.active}})}(c,1===e,o,n,i(a.value),r,u,Nb(t)))})):F.none()})))},lw=function(t,n){var e=Db(n);return 1===t?{mode:"menu",moveOnTab:!0}:"auto"===t?{mode:"grid",selector:"."+e.item,initSize:{numColumns:1,numRows:1}}:{mode:"matrix",rowSelector:"."+("color"===n?"tox-swatches__row":"tox-collection__group")}},dw=function(t,n){return 1===t?{mode:"menu",moveOnTab:!1,selector:".tox-collection__item"}:"auto"===t?{mode:"flatgrid",selector:".tox-collection__item",initSize:{numColumns:1,numRows:1}}:{mode:"matrix",selectors:{row:"color"===n?".tox-swatches__row":".tox-collection__group",cell:"color"===n?"."+vb:"."+hb}}},mw=function(t,n){var e=t.initData.allowCustomColors&&n.colorinput.hasCustomColors();return t.initData.colors.fold((function(){return ow(n.colorinput.getColors(),e)}),(function(t){return t.concat(nw(e))}))},gw=Qi("cell-over"),pw=Qi("cell-execute"),hw=function(t,n,e){var o,r=function(e){return Ci(e,pw,{row:t,col:n})},i=function(t,n){n.stop(),r(t)};return Yu({dom:{tag:"div",attributes:(o={role:"button"},o["aria-labelledby"]=e,o)},behaviours:gc([rp("insert-table-picker-cell",[Mi(Vr(),sp.focus),Mi(ei(),r),Mi(Gr(),i),Mi(ri(),i)]),wp.config({toggleClass:"tox-insert-table-picker__selected",toggleOnExecute:!1}),sp.config({onFocus:function(e){return Ci(e,gw,{row:t,col:n})}})])})},vw=function(t){return $(t,(function(t){return U(t,Ku)}))},bw=function(t,n){return Gu(n+"x"+t)},yw={inserttable:function(t){var n=Qi("size-label"),e=function(t,n,e){for(var o=[],r=0;r<n;r++){for(var i=[],u=0;u<e;u++)i.push(hw(r,u,t));o.push(i)}return o}(n,10,10),o=bw(0,0),r=ph({dom:{tag:"span",classes:["tox-insert-table-picker__label"],attributes:{id:n}},components:[o],behaviours:gc([op.config({})])});return{type:"widget",data:{value:Qi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vx.widget({dom:{tag:"div",classes:["tox-insert-table-picker"]},components:vw(e).concat(r.asSpec()),behaviours:gc([rp("insert-table-picker",[Li((function(t){op.set(r.get(t),[o])})),Ni(gw,(function(t,n,o){var i=o.event,u=i.row,a=i.col;(function(t,n,e,o,r){for(var i=0;i<o;i++)for(var u=0;u<r;u++)wp.set(t[i][u],i<=n&&u<=e)})(e,u,a,10,10),op.set(r.get(t),[bw(u+1,a+1)])})),Ni(pw,(function(n,e,o){var r=o.event,i=r.row,u=r.col;t.onAction({numRows:i+1,numColumns:u+1}),ki(n,ui())}))]),$g.config({initSize:{numRows:10,numColumns:10},mode:"flatgrid",selector:'[role="button"]'})])})]}},colorswatch:function(t,n){var e=mw(t,n),o=n.colorinput.getColorCols(),r="color",i=sw(Qi("menu-value"),e,(function(n){t.onAction({value:n})}),o,r,gb.CLOSE_ON_EXECUTE,C,n.shared.providers),u=T(T({},i),{markers:Db(r),movement:lw(o,r)});return{type:"widget",data:{value:Qi("widget-id")},dom:{tag:"div",classes:["tox-fancymenuitem"]},autofocus:!0,components:[vx.widget(Hp.sketch(u))]}}},xw=function(t,n,e,o,r,i,u,a){void 0===a&&(a=!0);var c=mx({presets:o,textContent:F.none(),htmlContent:e?t.text.map((function(t){return px(t,n)})):F.none(),ariaLabel:t.text,iconContent:t.icon,shortcutContent:F.none(),checkMark:F.none(),caret:F.none(),value:t.value},u.providers,a,t.icon);return nx({data:ex(t),disabled:t.disabled,getApi:b({}),onAction:function(n){return r(t.value,t.meta)},onSetup:b(p),triggersSubmenu:!1,itemBehaviours:gx(t.meta,u)},c,i,u.providers)},ww=function(t){var n=t.text.fold((function(){return{}}),(function(t){return{innerHtml:t}}));return{type:"separator",dom:T({tag:"div",classes:[hb,"tox-collection__group-heading"]},n),components:[]}},Sw=function(t,n,e,o){void 0===o&&(o=!0);var r=mx({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,caret:F.none(),checkMark:F.none(),shortcutContent:t.shortcut},e,o);return nx({data:ex(t),getApi:function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},disabled:t.disabled,onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e)},kw=function(t,n,e,o,r){void 0===o&&(o=!0),void 0===r&&(r=!1);var i=r?function(t){return ix("chevron-down",t,[Sb])}(e.icons):function(t){return ix("chevron-right",t,[Sb])}(e.icons),u=mx({presets:"normal",iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,caret:F.some(i),checkMark:F.none(),shortcutContent:t.shortcut},e,o);return nx({data:ex(t),getApi:function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},disabled:t.disabled,onAction:p,onSetup:t.onSetup,triggersSubmenu:!0,itemBehaviours:[]},u,n,e)},Cw=function(t,n,e,o){void 0===o&&(o=!0);var r=mx({iconContent:t.icon,textContent:t.text,htmlContent:F.none(),ariaLabel:t.text,checkMark:F.some(fx(e.icons)),caret:F.none(),shortcutContent:t.shortcut,presets:"normal",meta:t.meta},e,o);return eo(nx({data:ex(t),disabled:t.disabled,getApi:function(t){return{setActive:function(n){wp.set(t,n)},isActive:function(){return wp.isOn(t)},isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:[]},r,n,e),{toggling:{toggleClass:yb,toggleOnExecute:!1,selected:t.active}})},Ow=function(t,n){return bt(yw,t.fancytype).map((function(e){return e(t,n)}))},_w=function(t,n,e,o){var r={dom:dx(t.label),optComponents:[F.some({dom:{tag:"div",classes:[Cb,Ob]},components:hx(t.items,o)})]};return nx({data:ex(T({text:F.none()},t)),disabled:t.disabled,getApi:function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){Gd.set(t,n),j(Zs(t.element,"*"),(function(e){t.getSystem().getByDom(e).each((function(t){t.hasConfigured(Gd)&&Gd.set(t,n)}))}))}}},onAction:t.onAction,onSetup:t.onSetup,triggersSubmenu:!1,itemBehaviours:F.from(o.itemBehaviours).getOr([])},r,n,e.providers)};!function(t){t[t.ContentFocus=0]="ContentFocus",t[t.UiFocus=1]="UiFocus"}(Xx||(Xx={}));var Tw=function(t,n,e,o,r){var i=e.shared.providers,u=function(t){return r?T(T({},t),{shortcut:F.none(),icon:t.text.isSome()?F.none():t.icon}):t};switch(t.type){case"menuitem":return function(t){return Ro("menuitem",Zb,t)}(t).fold(Pb,(function(t){return F.some(Sw(u(t),n,i,o))}));case"nestedmenuitem":return function(t){return Ro("nestedmenuitem",ty,t)}(t).fold(Pb,(function(t){return F.some(kw(u(t),n,i,o,r))}));case"togglemenuitem":return function(t){return Ro("togglemenuitem",ny,t)}(t).fold(Pb,(function(t){return F.some(Cw(u(t),n,i,o))}));case"separator":return function(t){return Ro("separatormenuitem",Kv,t)}(t).fold(Pb,(function(t){return F.some(ww(t))}));case"fancymenuitem":return function(t){return Ro("fancymenuitem",Qb,t)}(t).fold(Pb,(function(t){return Ow(u(t),e)}));default:return console.error("Unknown item in general menu",t),F.none()}},Ew=function(t,n,e,o,r,i,u){var a=1===o,c=!a||Nb(t);return St(U(t,(function(t){switch(t.type){case"separator":return function(t){return Ro("Autocompleter.Separator",Kv,t)}(t).fold(Pb,(function(t){return F.some(ww(t))}));case"cardmenuitem":return function(t){return Ro("cardmenuitem",qb,t)}(t).fold(Pb,(function(t){return F.some(_w(T(T({},t),{onAction:function(n){t.onAction(n),e(t.value,t.meta)}}),r,i,{itemBehaviours:gx(t.meta,i),cardText:{matchText:n,highlightOn:u}}))}));case"autocompleteitem":default:return function(t){return Ro("Autocompleter.Item",Jv,t)}(t).fold(Pb,(function(t){return F.some(xw(t,n,a,"normal",e,r,i,c))}))}})))},Dw=function(t,n,e,o,r){var i=Nb(n),u=St(U(n,(function(t){var n=function(t){return Tw(t,e,o,function(t){return r?!yt(t,"text"):i}(t),r)};return"nestedmenuitem"===t.type&&t.getSubmenuItems().length<=0?n(T(T({},t),{disabled:!0})):n(t)})));return(r?Vb:Hb)(t,i,u,1,"normal")},Aw=function(t){return Gp.singleData(t.value,t)},Bw=function(t,n){var e=qc(),o=pr(!1),r=Yu(Xp.sketch({dom:{tag:"div",classes:["tox-autocompleter"]},components:[],fireDismissalEventInstead:{},inlineBehaviours:gc([rp("dismissAutocompleter",[Mi(pi(),(function(){return a()}))])]),lazySink:n.getSink})),i=function(){return e.get().isSome()},u=function(){i()&&Xp.hide(r)},a=function(){if(i()){var n=e.get().map((function(t){return t.element}));Rv(n.getOr(Ft.fromDom(t.selection.getNode()))).each(Oe),u(),e.clear(),o.set(!1)}},c=zt((function(){return db(t)})),s=function(e,r){var i=ct(r,(function(t){return F.from(t.columns)})).getOr(1);return $(r,(function(r){var c=r.items;return Ew(c,r.matchText,(function(n,i){var c=t.selection.getRng();Lv(t.dom,c,e).fold((function(){return console.error("Lost context. Cursor probably moved")}),(function(t){var e=t.range,c={hide:function(){a()},reload:function(t){u(),m(t)}};o.set(!0),r.onAction(c,e,n,i),o.set(!1)}))}),i,gb.BUBBLE_TO_SANDBOX,n,r.highlightOn)}))},f=function(n){if(!i()){var r=Iv(t,n.range);e.set({triggerChar:n.triggerChar,element:r,matchLength:n.text.length}),o.set(!1)}},l=function(n,e,o,i){n.matchLength=e.text.length;var u=ct(o,(function(t){return F.from(t.columns)})).getOr(1);Xp.showAt(r,Hp.sketch(function(t,n,e,o){var r=e===Xx.ContentFocus?Cm():km(),i=lw(n,o),u=Db(o);return{dom:t.dom,components:t.components,items:t.items,value:t.value,markers:{selectedItem:u.selectedItem,item:u.item},movement:i,fakeFocus:e===Xx.ContentFocus,focusManager:r,menuBehaviours:ry("auto"!==n?[]:[Li((function(t,n){ey(t,4,u.item).each((function(n){var e=n.numColumns,o=n.numRows;$g.setGridSize(t,o,e)}))}))])}}(Hb("autocompleter-value",!0,i,u,"normal"),u,Xx.ContentFocus,"normal")),{anchor:{type:"node",root:Ft.fromDom(t.getBody()),node:F.from(n.element)}}),Xp.getContent(r).each(em.highlightFirst)},d=function(n){return e.get().map((function(e){return Lv(t.dom,t.selection.getRng(),e.triggerChar).bind((function(e){return Yv(t,c,e,n)}))})).getOrThunk((function(){return qv(t,c)}))},m=function(t){d(t).fold(a,(function(t){f(t.context),t.lookupData.then((function(n){e.get().map((function(e){var o=t.context;if(e.triggerChar===o.triggerChar){var r=s(o.triggerChar,n);r.length>0?l(e,o,n,r):o.text.length-e.matchLength>=10?a():u()}}))}))}))},g={onKeypress:Bv((function(t){27!==t.which&&m()}),50),cancelIfNecessary:a,isMenuOpen:function(){return Xp.isOpen(r)},isActive:i,isProcessingAction:o.get,getView:function(){return Xp.getContent(r)}};!1===t.hasPlugin("rtc")&&zv(g,t)},Mw=function(t,n,e){return ra(t,n,e).isSome()},Fw=function(t,n){var e=null;return{cancel:function(){null!==e&&(clearTimeout(e),e=null)},schedule:function(){for(var o=[],r=0;r<arguments.length;r++)o[r]=arguments[r];e=setTimeout((function(){t.apply(null,o),e=null}),n)}}},Iw=function(t){var n=t.raw;return void 0===n.touches||1!==n.touches.length?F.none():F.some(n.touches[0])},Rw=function(t){var n=qc(),e=pr(!1),o=Fw((function(n){t.triggerEvent(ii(),n),e.set(!0)}),400),r=xr([{key:Ar(),value:function(t){return Iw(t).each((function(r){o.cancel();var i={x:r.clientX,y:r.clientY,target:t.target};o.schedule(t),e.set(!1),n.set(i)})),F.none()}},{key:Br(),value:function(t){return o.cancel(),Iw(t).each((function(t){n.on((function(e){(function(t,n){var e=Math.abs(t.clientX-n.x),o=Math.abs(t.clientY-n.y);return e>5||o>5})(t,e)&&n.clear()}))})),F.none()}},{key:Mr(),value:function(r){o.cancel();return n.get().filter((function(t){return gn(t.target,r.target)})).map((function(n){return e.get()?(r.prevent(),!1):t.triggerEvent(ri(),r)}))}}]);return{fireIfReady:function(t,n){return bt(r,n).bind((function(n){return n(t)}))}}},Nw=function(){return ln().browser.isFirefox()},Pw=function(t,n){var e=T({stopBackspace:!0},n),o=Rw(e),r=U(["touchstart","touchmove","touchend","touchcancel","gesturestart","mousedown","mouseup","mouseover","mousemove","mouseout","click"].concat(["selectstart","input","contextmenu","change","transitionend","transitioncancel","drag","dragstart","dragend","dragenter","dragleave","dragover","drop","keyup"]),(function(n){return Kc(t,n,(function(t){o.fireIfReady(t,n).each((function(n){n&&t.kill()})),e.triggerEvent(n,t)&&t.kill()}))})),i=qc(),u=Kc(t,"paste",(function(t){o.fireIfReady(t,"paste").each((function(n){n&&t.kill()})),e.triggerEvent("paste",t)&&t.kill(),i.set(setTimeout((function(){e.triggerEvent(ti(),t)}),0))})),a=Kc(t,"keydown",(function(t){e.triggerEvent("keydown",t)?t.kill():e.stopBackspace&&function(t){return t.raw.which===om[0]&&!V(["input","textarea"],Rt(t.target))&&!Mw(t.target,'[contenteditable="true"]')}(t)&&t.prevent()})),c=function(t,n){return Nw()?Jc(t,"focus",n):Kc(t,"focusin",n)}(t,(function(t){e.triggerEvent("focusin",t)&&t.kill()})),s=qc(),f=function(t,n){return Nw()?Jc(t,"blur",n):Kc(t,"focusout",n)}(t,(function(t){e.triggerEvent("focusout",t)&&t.kill(),s.set(setTimeout((function(){e.triggerEvent(Zr(),t)}),0))}));return{unbind:function(){j(r,(function(t){t.unbind()})),a.unbind(),c.unbind(),f.unbind(),u.unbind(),i.on(clearTimeout),s.on(clearTimeout)}}},Vw=function(t,n){var e=bt(t,"target").getOr(n);return pr(e)},Hw=hr([{stopped:[]},{resume:["element"]},{complete:[]}]),Lw=function(t,n,e,o,r,i){var u=t(n,o),a=function(t,n){var e=pr(!1),o=pr(!1);return{stop:function(){e.set(!0)},cut:function(){o.set(!0)},isStopped:e.get,isCut:o.get,event:t,setSource:n.set,getSource:n.get}}(e,r);return u.fold((function(){return i.logEventNoHandlers(n,o),Hw.complete()}),(function(t){var e=t.descHandler;return bu(e)(a),a.isStopped()?(i.logEventStopped(n,t.element,e.purpose),Hw.stopped()):a.isCut()?(i.logEventCut(n,t.element,e.purpose),Hw.complete()):wn(t.element).fold((function(){return i.logNoParent(n,t.element,e.purpose),Hw.complete()}),(function(o){return i.logEventResponse(n,t.element,e.purpose),Hw.resume(o)}))}))},zw=function(t,n,e,o,r,i){return Lw(t,n,e,o,r,i).fold(O,(function(o){return zw(t,n,e,o,r,i)}),C)},Uw=function(t,n,e){var o=function(t){var n=pr(!1);return{stop:function(){n.set(!0)},cut:p,isStopped:n.get,isCut:C,event:t,setSource:k("Cannot set source of a broadcasted event"),getSource:k("Cannot get source of a broadcasted event")}}(n);return j(t,(function(t){var n=t.descHandler;bu(n)(o)})),o.isStopped()},jw=function(t,n,e,o,r){var i=Vw(e,o);return zw(t,n,e,o,i,r)},Ww=function(){var t={};return{registerId:function(n,e,o){lt(o,(function(o,r){var i=void 0!==t[r]?t[r]:{};i[e]=function(t,n){return function(t,n){return{cHandler:t,purpose:n}}(w.apply(void 0,[t.handler].concat(n)),t.purpose)}(o,n),t[r]=i}))},unregisterId:function(n){lt(t,(function(t,e){yt(t,n)&&delete t[n]}))},filterByType:function(n){return bt(t,n).map((function(t){return pt(t,(function(t,n){return function(t,n){return{id:t,descHandler:n}}(n,t)}))})).getOr([])},find:function(n,e,o){return bt(t,e).bind((function(t){return Cr(o,(function(n){return function(t,n){return ru(n).bind((function(n){return bt(t,n)})).map((function(t){return function(t,n){return{element:t,descHandler:n}}(n,t)}))}(t,n)}),n)}))}}},Gw=function(){var t=Ww(),n={},e=function(t){var n=t.element;return ru(n).getOrThunk((function(){return function(t,n){var e=Qi(nu+t);return ou(n,e),e}("uid-",t.element)}))},o=function(t,e){var o=n[e];if(o!==t)throw new Error('The tagId "'+e+'" is already used by: '+Yi(o.element)+"\nCannot use it for: "+Yi(t.element)+"\nThe conflicting element is"+(Rn(o.element)?" ":" not ")+"already in the DOM");r(t)},r=function(e){ru(e.element).each((function(e){delete n[e],t.unregisterId(e)}))};return{find:function(n,e,o){return t.find(n,e,o)},filter:function(n){return t.filterByType(n)},register:function(r){var i=e(r);xt(n,i)&&o(r,i);var u=[r];t.registerId(u,i,r.events),n[i]=r},unregister:r,getById:function(t){return bt(n,t)}}},Xw=_d({name:"Container",factory:function(t){var n=t.dom,e=n.attributes,o=E(n,["attributes"]);return{uid:t.uid,dom:T({tag:"div",attributes:T({role:"presentation"},e)},o),components:t.components,behaviours:Cl(t.containerBehaviours),events:t.events,domModification:t.domModification,eventOrder:t.eventOrder}},configFields:[ur("components",[]),kl("containerBehaviours",[]),ur("events",{}),ur("domModification",{}),ur("eventOrder",{})]}),qw=function(t){var n=function(n){return wn(t.element).fold(O,(function(t){return gn(n,t)}))},e=Gw(),o=function(t,o){return e.find(n,t,o)},r=Pw(t.element,{triggerEvent:function(t,n){return da(t,n.target,(function(e){return function(t,n,e,o){return jw(t,n,e,e.target,o)}(o,t,n,e)}))}}),i={debugInfo:b("real"),triggerEvent:function(t,n,e){da(t,n,(function(r){return jw(o,t,e,n,r)}))},triggerFocus:function(t,n){ru(t).fold((function(){kc(t)}),(function(e){da(Qr(),t,(function(e){return function(t,n,e,o,r){var i=Vw(e,o);Lw(t,n,e,o,i,r)}(o,Qr(),{originator:n,kill:p,prevent:p,target:t},t,e),!1}))}))},triggerEscape:function(t,n){i.triggerEvent("keydown",t.element,n.event)},getByUid:function(t){return g(t)},getByDom:function(t){return h(t)},build:Yu,addToGui:function(t){c(t)},removeFromGui:function(t){s(t)},addToWorld:function(t){u(t)},removeFromWorld:function(t){a(t)},broadcast:function(t){l(t)},broadcastOn:function(t,n){d(t,n)},broadcastEvent:function(t,n){m(t,n)},isConnected:O},u=function(t){t.connect(i),Vt(t.element)||(e.register(t),j(t.components(),u),i.triggerEvent(ci(),t.element,{target:t.element}))},a=function(t){Vt(t.element)||(j(t.components(),a),e.unregister(t)),t.disconnect()},c=function(n){Vf(t,n)},s=function(t){zf(t)},f=function(t){var n=e.filter(ni());j(n,(function(n){var e=n.descHandler;bu(e)(t)}))},l=function(t){f({universal:!0,data:t})},d=function(t,n){f({universal:!1,channels:t,data:n})},m=function(t,n){var o=e.filter(t);return Uw(o,n)},g=function(t){return e.getById(t).fold((function(){return He.error(new Error('Could not find component with uid: "'+t+'" in system.'))}),He.value)},h=function(t){var n=ru(t).getOr("not found");return g(n)};return u(t),{root:t,element:t.element,destroy:function(){r.unbind(),Ce(t.element)},add:c,remove:s,getByUid:g,getByDom:h,addToWorld:u,removeFromWorld:a,broadcast:l,broadcastOn:d,broadcastEvent:m}},Yw=b([ur("prefix","form-field"),kl("fieldBehaviours",[Bd,Sl])]),Kw=b([td({schema:[jo("dom")],name:"label"}),td({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[jo("text")],name:"aria-descriptor"}),Ql({factory:{sketch:function(t){var n=br(t,["factory"]);return t.factory.sketch(n)}},schema:[jo("factory")],name:"field"})]),Jw=Td({name:"FormField",configFields:Yw(),partFields:Kw(),factory:function(t,n,e,o){var r=Ol(t.fieldBehaviours,[Bd.config({find:function(n){return dd(n,t,"field")}}),Sl.config({store:{mode:"manual",getValue:function(t){return Bd.getCurrent(t).bind(Sl.getValue)},setValue:function(t,n){Bd.getCurrent(t).each((function(t){Sl.setValue(t,n)}))}}})]),i=Di([Li((function(n,e){var o=gd(n,t,["label","field","aria-descriptor"]);o.field().each((function(n){var e=Qi(t.prefix);o.label().each((function(t){Hn(t.element,"for",e),Hn(n.element,"id",e)})),o["aria-descriptor"]().each((function(e){var o=Qi(t.prefix);Hn(e.element,"id",o),Hn(n.element,"aria-describedby",o)}))}))}))]),u={getField:function(n){return dd(n,t,"field")},getLabel:function(n){return dd(n,t,"label")}};return{uid:t.uid,dom:t.dom,components:n,behaviours:r,events:i,apis:u}},apis:{getField:function(t,n){return t.getField(n)},getLabel:function(t,n){return t.getLabel(n)}}}),$w=Object.freeze({__proto__:null,exhibit:function(t,n){return vu({attributes:xr([{key:n.tabAttr,value:"true"}])})}}),Qw=[ur("tabAttr","data-alloy-tabstop")],Zw=hc({fields:Qw,name:"tabstopping",active:$w}),tS=tinymce.util.Tools.resolve("tinymce.html.Entities"),nS=function(t,n,e,o){var r=eS(t,n,e,o);return Jw.sketch(r)},eS=function(t,n,e,o){return{dom:oS(e),components:t.toArray().concat([n]),fieldBehaviours:gc(o)}},oS=function(t){return{tag:"div",classes:["tox-form__group"].concat(t)}},rS=function(t,n){return Jw.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}})},iS=Qi("form-component-change"),uS=Qi("form-close"),aS=Qi("form-cancel"),cS=Qi("form-action"),sS=Qi("form-submit"),fS=Qi("form-block"),lS=Qi("form-unblock"),dS=Qi("form-tabchange"),mS=Qi("form-resize"),gS=b([Qo("data"),ur("inputAttributes",{}),ur("inputStyles",{}),ur("tag","input"),ur("inputClasses",[]),wa("onSetValue"),ur("styles",{}),ur("eventOrder",{}),kl("inputBehaviours",[Sl,sp]),ur("selectOnFocus",!0)]),pS=function(t){return gc([sp.config({onFocus:t.selectOnFocus?function(t){var n=t.element,e=Pu(n);n.dom.setSelectionRange(0,e.length)}:p})])},hS=function(t){return T(T({},pS(t)),Ol(t.inputBehaviours,[Sl.config({store:T(T({mode:"manual"},t.data.map((function(t){return{initialValue:t}})).getOr({})),{getValue:function(t){return Pu(t.element)},setValue:function(t,n){Pu(t.element)!==n&&Vu(t.element,n)}}),onSetValue:t.onSetValue})]))},vS=function(t){return{tag:t.tag,attributes:T({type:"text"},t.inputAttributes),styles:t.inputStyles,classes:t.inputClasses}},bS=_d({name:"Input",configFields:gS(),factory:function(t,n){return{uid:t.uid,dom:vS(t),components:[],behaviours:hS(t),eventOrder:t.eventOrder}}}),yS={},xS={exports:yS};!function(n,e,o,r){!function(t,n){"object"==typeof e&&void 0!==o?o.exports=n():(t="undefined"!=typeof globalThis?globalThis:t||self).EphoxContactWrapper=n()}(this,(function(){var n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==t?t:"undefined"!=typeof self?self:{},e={exports:{}};!function(t){!function(n){var e=setTimeout;function o(){}function r(t){if("object"!=typeof this)throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],f(t,this)}function i(t,n){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,r._immediateFn((function(){var e=1===t._state?n.onFulfilled:n.onRejected;if(null!==e){var o;try{o=e(t._value)}catch(t){return void a(n.promise,t)}u(n.promise,o)}else(1===t._state?u:a)(n.promise,t._value)}))):t._deferreds.push(n)}function u(t,n){try{if(n===t)throw new TypeError("A promise cannot be resolved with itself.");if(n&&("object"==typeof n||"function"==typeof n)){var e=n.then;if(n instanceof r)return t._state=3,t._value=n,void c(t);if("function"==typeof e)return void f(function(t,n){return function(){t.apply(n,arguments)}}(e,n),t)}t._state=1,t._value=n,c(t)}catch(n){a(t,n)}}function a(t,n){t._state=2,t._value=n,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&r._immediateFn((function(){t._handled||r._unhandledRejectionFn(t._value)}));for(var n=0,e=t._deferreds.length;n<e;n++)i(t,t._deferreds[n]);t._deferreds=null}function s(t,n,e){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof n?n:null,this.promise=e}function f(t,n){var e=!1;try{t((function(t){e||(e=!0,u(n,t))}),(function(t){e||(e=!0,a(n,t))}))}catch(t){if(e)return;e=!0,a(n,t)}}r.prototype.catch=function(t){return this.then(null,t)},r.prototype.then=function(t,n){var e=new this.constructor(o);return i(this,new s(t,n,e)),e},r.all=function(t){var n=Array.prototype.slice.call(t);return new r((function(t,e){if(0===n.length)return t([]);var o=n.length;function r(i,u){try{if(u&&("object"==typeof u||"function"==typeof u)){var a=u.then;if("function"==typeof a)return void a.call(u,(function(t){r(i,t)}),e)}n[i]=u,0==--o&&t(n)}catch(t){e(t)}}for(var i=0;i<n.length;i++)r(i,n[i])}))},r.resolve=function(t){return t&&"object"==typeof t&&t.constructor===r?t:new r((function(n){n(t)}))},r.reject=function(t){return new r((function(n,e){e(t)}))},r.race=function(t){return new r((function(n,e){for(var o=0,r=t.length;o<r;o++)t[o].then(n,e)}))},r._immediateFn="function"==typeof setImmediate?function(t){setImmediate(t)}:function(t){e(t,0)},r._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},r._setImmediateFn=function(t){r._immediateFn=t},r._setUnhandledRejectionFn=function(t){r._unhandledRejectionFn=t},t.exports?t.exports=r:n.Promise||(n.Promise=r)}(n)}(e);var o=e.exports;return{boltExport:("undefined"!=typeof window?window:Function("return this;")()).Promise||o}}))}(0,yS,xS);var wS,SS=xS.exports.boltExport,kS=function(t){var n=F.none(),e=[],o=function(t){r()?u(t):e.push(t)},r=function(){return n.isSome()},i=function(t){j(t,u)},u=function(t){n.each((function(n){setTimeout((function(){t(n)}),0)}))};return t((function(t){r()||(n=F.some(t),i(e),e=[])})),{get:o,map:function(t){return kS((function(n){o((function(e){n(t(e))}))}))},isReady:r}},CS={nu:kS,pure:function(t){return kS((function(n){n(t)}))}},OS=function(t){setTimeout((function(){throw t}),0)},_S=function(t){var n=function(n){t().then(n,OS)};return{map:function(n){return _S((function(){return t().then(n)}))},bind:function(n){return _S((function(){return t().then((function(t){return n(t).toPromise()}))}))},anonBind:function(n){return _S((function(){return t().then((function(){return n.toPromise()}))}))},toLazy:function(){return CS.nu(n)},toCached:function(){var n=null;return _S((function(){return null===n&&(n=t()),n}))},toPromise:t,get:n}},TS=function(t){return _S((function(){return new SS(t)}))},ES=function(t){return _S((function(){return SS.resolve(t)}))},DS=["input","textarea"],AS=function(t){var n=Rt(t);return V(DS,n)},BS=function(t,n){var e=n.getRoot(t).getOr(t.element);Fu(e,n.invalidClass),n.notify.each((function(n){AS(t.element)&&Hn(t.element,"aria-invalid",!1),n.getContainer(t).each((function(t){Gi(t,n.validHtml)})),n.onValid(t)}))},MS=function(t,n,e,o){var r=n.getRoot(t).getOr(t.element);Bu(r,n.invalidClass),n.notify.each((function(n){AS(t.element)&&Hn(t.element,"aria-invalid",!0),n.getContainer(t).each((function(t){Gi(t,o)})),n.onInvalid(t,o)}))},FS=function(t,n,e){return n.validator.fold((function(){return ES(He.value(!0))}),(function(n){return n.validate(t)}))},IS=function(t,n,e){return n.notify.each((function(n){n.onValidate(t)})),FS(t,n).map((function(e){return t.getSystem().isConnected()?e.fold((function(e){return MS(t,n,0,e),He.error(e)}),(function(e){return BS(t,n),He.value(e)})):He.error("No longer in system")}))},RS=Object.freeze({__proto__:null,markValid:BS,markInvalid:MS,query:FS,run:IS,isInvalid:function(t,n){var e=n.getRoot(t).getOr(t.element);return Iu(e,n.invalidClass)}}),NS=Object.freeze({__proto__:null,events:function(t,n){return t.validator.map((function(n){return Di([Mi(n.onEvent,(function(n){IS(n,t).get(y)}))].concat(n.validateOnLoad?[Li((function(n){IS(n,t).get(p)}))]:[]))})).getOr({})}}),PS=[jo("invalidClass"),ur("getRoot",F.none),rr("notify",[ur("aria","alert"),ur("getContainer",F.none),ur("validHtml",""),wa("onValid"),wa("onInvalid"),wa("onValidate")]),rr("validator",[jo("validate"),ur("onEvent","input"),ur("validateOnLoad",!0)])],VS=hc({fields:PS,name:"invalidating",active:NS,apis:RS,extra:{validation:function(t){return function(n){var e=Sl.getValue(n);return ES(t(e))}}}}),HS=Object.freeze({__proto__:null,getCoupled:function(t,n,e,o){return e.getOrCreate(t,n,o)}}),LS=[Wo("others",Io(He.value,ko()))],zS=Object.freeze({__proto__:null,init:function(){var t={},n=b({});return pu({readState:n,getOrCreate:function(n,e,o){var r=st(e.others);if(r)return bt(t,o).getOrThunk((function(){var r=bt(e.others,o).getOrDie("No information found for coupled component: "+o)(n),i=n.getSystem().build(r);return t[o]=i,i}));throw new Error("Cannot find coupled component: "+o+". Known coupled components: "+JSON.stringify(r,null,2))}})}}),US=hc({fields:LS,name:"coupling",apis:HS,state:zS}),jS=b("sink"),WS=b(td({name:jS(),overrides:b({dom:{tag:"div"},behaviours:gc([Ff.config({useFixed:O})]),events:Di([Pi(zr()),Pi(Ir()),Pi(Gr())])})}));!function(t){t[t.HighlightFirst=0]="HighlightFirst",t[t.HighlightNone=1]="HighlightNone"}(wS||(wS={}));var GS,XS=function(t,n){var e=t.getHotspot(n).getOr(n),o="hotspot",r=t.getAnchorOverrides();return t.layouts.fold((function(){return{type:o,hotspot:e,overrides:r}}),(function(t){return{type:o,hotspot:e,overrides:r,layouts:t}}))},qS=function(t,n,e,o,r,i,u){return function(t,n,e,o,r,i,u){var a=function(t,n,e){return(0,t.fetch)(e).map(n)}(t,n,o),c=$S(o,t);return a.map((function(t){return t.bind((function(t){return F.from(Gp.sketch(T(T({},i.menu()),{uid:iu(""),data:t,highlightImmediately:u===wS.HighlightFirst,onOpenMenu:function(t,n){var o=c().getOrDie();Ff.position(o,n,{anchor:e}),el.decloak(r)},onOpenSubmenu:function(t,n,e){var o=c().getOrDie();Ff.position(o,e,{anchor:{type:"submenu",item:n}}),el.decloak(r)},onRepositionMenu:function(t,n,o){var r=c().getOrDie();Ff.position(r,n,{anchor:e}),j(o,(function(t){Ff.position(r,t.triggeredMenu,{anchor:{type:"submenu",item:t.triggeringItem}})}))},onEscape:function(){return sp.focus(o),el.close(r),F.some(!0)}})))}))}))}(t,n,XS(t,e),e,o,r,u).map((function(t){return t.fold((function(){el.isOpen(o)&&el.close(o)}),(function(t){el.cloak(o),el.open(o,t),i(o)})),o}))},YS=function(t,n,e,o,r,i,u){return el.close(o),ES(o)},KS=function(t,n,e,o,r,i){var u=US.getCoupled(e,"sandbox");return(el.isOpen(u)?YS:qS)(t,n,e,u,o,r,i)},JS=function(t,n,e){var o=Bd.getCurrent(n).getOr(n),r=me(t.element);e?qn(o.element,"min-width",r+"px"):function(t,n){de.set(t,n)}(o.element,r)},$S=function(t,n){return t.getSystem().getByUid(n.uid+"-"+jS()).map((function(t){return function(){return He.value(t)}})).getOrThunk((function(){return n.lazySink.fold((function(){return function(){return He.error(new Error("No internal sink is specified, nor could an external sink be found"))}}),(function(n){return function(){return n(t)}}))}))},QS=function(t){el.getState(t).each((function(t){Gp.repositionMenus(t)}))},ZS=function(t,n,e){var o=ia(),r=$S(n,t);return{dom:{tag:"div",classes:t.sandboxClasses,attributes:{id:o.id,role:"listbox"}},behaviours:Tl(t.sandboxBehaviours,[Sl.config({store:{mode:"memory",initialValue:n}}),el.config({onOpen:function(r,i){var u=XS(t,n);o.link(n.element),t.matchWidth&&JS(u.hotspot,i,t.useMinWidth),t.onOpen(u,r,i),void 0!==e&&void 0!==e.onOpen&&e.onOpen(r,i)},onClose:function(t,r){o.unlink(n.element),void 0!==e&&void 0!==e.onClose&&e.onClose(t,r)},isPartOf:function(t,e,o){return aa(e,o)||aa(n,o)},getAttachPoint:function(){return r().getOrDie()}}),Bd.config({find:function(t){return el.getState(t).bind((function(t){return Bd.getCurrent(t)}))}}),xc.config({channels:T(T({},al({isExtraPart:C})),sl({doReposition:QS}))})])}},tk=function(t){var n=US.getCoupled(t,"sandbox");QS(n)},nk=function(){return[ur("sandboxClasses",[]),_l("sandboxBehaviours",[Bd,xc,el,Sl])]},ek=b([jo("dom"),jo("fetch"),wa("onOpen"),Sa("onExecute"),ur("getHotspot",F.some),ur("getAnchorOverrides",b({})),xs(),kl("dropdownBehaviours",[wp,US,$g,sp]),jo("toggleClass"),ur("eventOrder",{}),Qo("lazySink"),ur("matchWidth",!1),ur("useMinWidth",!1),Qo("role")].concat(nk())),ok=b([Zl({schema:[ba()],name:"menu",defaults:function(t){return{onExecute:t.onExecute}}}),WS()]),rk=Td({name:"Dropdown",configFields:ek(),partFields:ok(),factory:function(t,n,e,o){var r,i=function(t){el.getState(t).each((function(t){Gp.highlightPrimary(t)}))},u={expand:function(n){wp.isOn(n)||KS(t,y,n,o,p,wS.HighlightNone).get(p)},open:function(n){wp.isOn(n)||KS(t,y,n,o,p,wS.HighlightFirst).get(p)},isOpen:wp.isOn,close:function(n){wp.isOn(n)&&KS(t,y,n,o,p,wS.HighlightFirst).get(p)},repositionMenus:function(t){wp.isOn(t)&&tk(t)}},a=function(t,n){return Oi(t),F.some(!0)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.dropdownBehaviours,[wp.config({toggleClass:t.toggleClass,aria:{mode:"expanded"}}),US.config({others:{sandbox:function(n){return ZS(t,n,{onOpen:function(){return wp.on(n)},onClose:function(){return wp.off(n)}})}}}),$g.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t,n){if(rk.isOpen(t)){var e=US.getCoupled(t,"sandbox");i(e)}else rk.open(t);return F.some(!0)},onEscape:function(t,n){return rk.isOpen(t)?(rk.close(t),F.some(!0)):F.none()}}),sp.config({})]),events:kp(F.some((function(n){KS(t,y,n,o,i,wS.HighlightFirst).get(p)}))),eventOrder:T(T({},t.eventOrder),(r={},r[ei()]=["disabling","toggling","alloy.base.behaviour"],r)),apis:u,domModification:{attributes:T(T({"aria-haspopup":"true"},t.role.fold((function(){return{}}),(function(t){return{role:t}}))),"button"===t.dom.tag?{type:function(n){return bt(t.dom,"attributes").bind((function(t){return bt(t,n)}))}("type").getOr("button")}:{})}}},apis:{open:function(t,n){return t.open(n)},expand:function(t,n){return t.expand(n)},close:function(t,n){return t.close(n)},isOpen:function(t,n){return t.isOpen(n)},repositionMenus:function(t,n){return t.repositionMenus(n)}}}),ik=Object.freeze({__proto__:null,events:function(){return Di([Ai(Kr(),O)])},exhibit:function(){return vu({styles:{"-webkit-user-select":"none","user-select":"none","-ms-user-select":"none","-moz-user-select":"-moz-none"},attributes:{unselectable:"on"}})}}),uk=hc({fields:[],name:"unselecting",active:ik}),ak=Qi("color-input-change"),ck=Qi("color-swatch-change"),sk=Qi("color-picker-cancel"),fk=function(t,n,e){var o=Jw.parts.field({factory:bS,inputClasses:["tox-textfield"],onSetValue:function(t){return VS.run(t).get(p)},inputBehaviours:gc([Gd.config({disabled:n.providers.isDisabled}),Wy(),Zw.config({}),VS.config({invalidClass:"tox-textbox-field-invalid",getRoot:function(t){return wn(t.element)},notify:{onValid:function(t){var n=Sl.getValue(t);Ci(t,ak,{color:n})}},validator:{validateOnLoad:!1,validate:function(t){var n=Sl.getValue(t);if(0===n.length)return ES(He.value(!0));var e=Ft.fromTag("span");qn(e,"background-color",n);var o=Qn(e,"background-color").fold((function(){return He.error("blah")}),(function(t){return He.value(n)}));return ES(o)}}})]),selectOnFocus:!1}),r=t.label.map((function(t){return rS(t,n.providers)})),i=function(t,n){Ci(t,ck,{value:n})},u=ph(function(t,n){return rk.sketch({dom:t.dom,components:t.components,toggleClass:"mce-active",dropdownBehaviours:gc([Xy(n.providers.isDisabled),Wy(),uk.config({}),Zw.config({})]),layouts:t.layouts,sandboxClasses:["tox-dialog__popups"],lazySink:n.getSink,fetch:function(e){return TS((function(n){return t.fetch(n)})).map((function(o){return F.from(Aw(eo(sw(Qi("menu-value"),o,(function(n){t.onItemAction(e,n)}),t.columns,t.presets,gb.CLOSE_ON_EXECUTE,C,n.providers),{movement:lw(t.columns,t.presets)})))}))},parts:{menu:Mb(0,0,t.presets)}})}({dom:{tag:"span",attributes:{"aria-label":n.providers.translate("Color swatch")}},layouts:{onRtl:function(){return[Ka,Ya,Za]},onLtr:function(){return[Ya,Ka,Za]}},components:[],fetch:rw(e.getColors(),e.hasCustomColors()),columns:e.getColorCols(),presets:"color",onItemAction:function(t,n){u.getOpt(t).each((function(t){"custom"===n?e.colorPicker((function(n){n.fold((function(){return ki(t,sk)}),(function(n){i(t,n),Qx(n)}))}),"#ffffff"):i(t,"remove"===n?"":n)}))}},n));return Jw.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:r.toArray().concat([{dom:{tag:"div",classes:["tox-color-input"]},components:[o,u.asSpec()]}]),fieldBehaviours:gc([rp("form-field-events",[Mi(ak,(function(n,e){u.getOpt(n).each((function(t){qn(t.element,"background-color",e.event.color)})),Ci(n,iS,{name:t.name})})),Mi(ck,(function(t,n){Jw.getField(t).each((function(e){Sl.setValue(e,n.event.value),Bd.getCurrent(t).each(sp.focus)}))})),Mi(sk,(function(t,n){Jw.getField(t).each((function(n){Bd.getCurrent(t).each(sp.focus)}))}))])])})},lk=td({schema:[jo("dom")],name:"label"}),dk=function(t){return td({name:t+"-edge",overrides:function(n){return n.model.manager.edgeActions[t].fold((function(){return{}}),(function(t){return{events:Di([Fi(Ar(),(function(n,e,o){return t(n,o)}),[n]),Fi(Ir(),(function(n,e,o){return t(n,o)}),[n]),Fi(Rr(),(function(n,e,o){o.mouseIsDown.get()&&t(n,o)}),[n])])}}))}})},mk=dk("top-left"),gk=dk("top"),pk=dk("top-right"),hk=dk("right"),vk=dk("bottom-right"),bk=dk("bottom"),yk=dk("bottom-left"),xk=dk("left"),wk=Ql({name:"thumb",defaults:b({dom:{styles:{position:"absolute"}}}),overrides:function(t){return{events:Di([Ri(Ar(),t,"spectrum"),Ri(Br(),t,"spectrum"),Ri(Mr(),t,"spectrum"),Ri(Ir(),t,"spectrum"),Ri(Rr(),t,"spectrum"),Ri(Pr(),t,"spectrum")])}}}),Sk=Ql({schema:[zo("mouseIsDown",(function(){return pr(!1)}))],name:"spectrum",overrides:function(t){var n=t.model.manager,e=function(e,o){return n.getValueFromEvent(o).map((function(o){return n.setValueFrom(e,t,o)}))};return{behaviours:gc([$g.config({mode:"special",onLeft:function(e){return n.onLeft(e,t)},onRight:function(e){return n.onRight(e,t)},onUp:function(e){return n.onUp(e,t)},onDown:function(e){return n.onDown(e,t)}}),sp.config({})]),events:Di([Mi(Ar(),e),Mi(Br(),e),Mi(Ir(),e),Mi(Rr(),(function(n,o){t.mouseIsDown.get()&&e(n,o)}))])}}}),kk=[lk,xk,hk,gk,bk,mk,pk,yk,vk,wk,Sk],Ck=b("slider.change.value"),Ok=function(t){var n=t.event.raw;if(function(t){return-1!==t.type.indexOf("touch")}(n)){var e=n;return void 0!==e.touches&&1===e.touches.length?F.some(e.touches[0]).map((function(t){return ce(t.clientX,t.clientY)})):F.none()}var o=n;return void 0!==o.clientX?F.some(o).map((function(t){return ce(t.clientX,t.clientY)})):F.none()},_k=function(t){return t.model.minX},Tk=function(t){return t.model.minY},Ek=function(t){return t.model.minX-1},Dk=function(t){return t.model.minY-1},Ak=function(t){return t.model.maxX},Bk=function(t){return t.model.maxY},Mk=function(t){return t.model.maxX+1},Fk=function(t){return t.model.maxY+1},Ik=function(t,n,e){return n(t)-e(t)},Rk=function(t){return Ik(t,Ak,_k)},Nk=function(t){return Ik(t,Bk,Tk)},Pk=function(t){return Rk(t)/2},Vk=function(t){return Nk(t)/2},Hk=function(t){return t.stepSize},Lk=function(t){return t.snapToGrid},zk=function(t){return t.snapStart},Uk=function(t){return t.rounded},jk=function(t,n){return void 0!==t[n+"-edge"]},Wk=function(t){return jk(t,"left")},Gk=function(t){return jk(t,"right")},Xk=function(t){return jk(t,"top")},qk=function(t){return jk(t,"bottom")},Yk=function(t){return t.model.value.get()},Kk=function(t){return{x:t}},Jk=function(t){return{y:t}},$k=function(t,n){return{x:t,y:n}},Qk=function(t,n){Ci(t,Ck(),{value:n})},Zk=function(t,n,e,o){return t<n?t:t>e?e:t===n?n-1:Math.max(n,t-o)},tC=function(t,n,e,o){return t>e?t:t<n?n:t===e?e+1:Math.min(e,t+o)},nC=function(t,n,e){return Math.max(n,Math.min(e,t))},eC=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.step,u=t.snap,a=t.snapStart,c=t.rounded,s=t.hasMinEdge,f=t.hasMaxEdge,l=t.minBound,d=t.maxBound,m=t.screenRange,g=s?n-1:n,p=f?e+1:e;if(r<l)return g;if(r>d)return p;var h=function(t,n,e){return Math.min(e,Math.max(t,n))-n}(r,l,d),v=nC(h/m*o+n,g,p);return u&&v>=n&&v<=e?function(t,n,e,o,r){return r.fold((function(){var r=t-n,i=Math.round(r/o)*o;return nC(n+i,n-1,e+1)}),(function(n){var r=(t-n)%o,i=Math.round(r/o),u=Math.floor((t-n)/o),a=Math.floor((e-n)/o),c=n+Math.min(a,u+i)*o;return Math.max(n,c)}))}(v,n,e,i,a):c?Math.round(v):v},oC=function(t){var n=t.min,e=t.max,o=t.range,r=t.value,i=t.hasMinEdge,u=t.hasMaxEdge,a=t.maxBound,c=t.maxOffset,s=t.centerMinEdge,f=t.centerMaxEdge;return r<n?i?0:s:r>e?u?a:f:(r-n)/o*c},rC="left",iC=function(t){return t.element.dom.getBoundingClientRect()},uC=function(t,n){return t[n]},aC=function(t){var n=iC(t);return uC(n,rC)},cC=function(t){var n=iC(t);return uC(n,"right")},sC=function(t){var n=iC(t);return uC(n,"top")},fC=function(t){var n=iC(t);return uC(n,"bottom")},lC=function(t){var n=iC(t);return uC(n,"width")},dC=function(t){var n=iC(t);return uC(n,"height")},mC=function(t,n,e){return(t+n)/2-e},gC=function(t,n){var e=iC(t),o=iC(n),r=uC(e,rC),i=uC(e,"right"),u=uC(o,rC);return mC(r,i,u)},pC=function(t,n){var e=iC(t),o=iC(n),r=uC(e,"top"),i=uC(e,"bottom"),u=uC(o,"top");return mC(r,i,u)},hC=function(t,n){Ci(t,Ck(),{value:n})},vC=function(t){return{x:t}},bC=function(t,n,e){var o={min:_k(n),max:Ak(n),range:Rk(n),value:e,step:Hk(n),snap:Lk(n),snapStart:zk(n),rounded:Uk(n),hasMinEdge:Wk(n),hasMaxEdge:Gk(n),minBound:aC(t),maxBound:cC(t),screenRange:lC(t)};return eC(o)},yC=function(t){return function(n,e){return function(t,n,e){var o=(t>0?tC:Zk)(Yk(e).x,_k(e),Ak(e),Hk(e));return hC(n,vC(o)),F.some(o)}(t,n,e).map(O)}},xC=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=lC(t),u=o.bind((function(n){return F.some(gC(n,t))})).getOr(0),a=r.bind((function(n){return F.some(gC(n,t))})).getOr(i),c={min:_k(n),max:Ak(n),range:Rk(n),value:e,hasMinEdge:Wk(n),hasMaxEdge:Gk(n),minBound:aC(t),minOffset:0,maxBound:cC(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return oC(c)}(n,i,e,o,r);return aC(n)-aC(t)+u},wC=yC(-1),SC=yC(1),kC=F.none,CC=F.none,OC={"top-left":F.none(),top:F.none(),"top-right":F.none(),right:F.some((function(t,n){Qk(t,Kk(Mk(n)))})),"bottom-right":F.none(),bottom:F.none(),"bottom-left":F.none(),left:F.some((function(t,n){Qk(t,Kk(Ek(n)))}))},_C=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=bC(t,n,e),r=vC(o);return hC(t,r),o},setToMin:function(t,n){var e=_k(n);hC(t,vC(e))},setToMax:function(t,n){var e=Ak(n);hC(t,vC(e))},findValueOfOffset:bC,getValueFromEvent:function(t){return Ok(t).map((function(t){return t.left}))},findPositionOfValue:xC,setPositionFromValue:function(t,n,e,o){var r=Yk(e),i=xC(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=me(n.element)/2;qn(n.element,"left",i-u+"px")},onLeft:wC,onRight:SC,onUp:kC,onDown:CC,edgeActions:OC}),TC=function(t,n){Ci(t,Ck(),{value:n})},EC=function(t){return{y:t}},DC=function(t,n,e){var o={min:Tk(n),max:Bk(n),range:Nk(n),value:e,step:Hk(n),snap:Lk(n),snapStart:zk(n),rounded:Uk(n),hasMinEdge:Xk(n),hasMaxEdge:qk(n),minBound:sC(t),maxBound:fC(t),screenRange:dC(t)};return eC(o)},AC=function(t){return function(n,e){return function(t,n,e){var o=(t>0?tC:Zk)(Yk(e).y,Tk(e),Bk(e),Hk(e));return TC(n,EC(o)),F.some(o)}(t,n,e).map(O)}},BC=function(t,n,e,o,r,i){var u=function(t,n,e,o,r){var i=dC(t),u=o.bind((function(n){return F.some(pC(n,t))})).getOr(0),a=r.bind((function(n){return F.some(pC(n,t))})).getOr(i),c={min:Tk(n),max:Bk(n),range:Nk(n),value:e,hasMinEdge:Xk(n),hasMaxEdge:qk(n),minBound:sC(t),minOffset:0,maxBound:fC(t),maxOffset:i,centerMinEdge:u,centerMaxEdge:a};return oC(c)}(n,i,e,o,r);return sC(n)-sC(t)+u},MC=F.none,FC=F.none,IC=AC(-1),RC=AC(1),NC={"top-left":F.none(),top:F.some((function(t,n){Qk(t,Jk(Dk(n)))})),"top-right":F.none(),right:F.none(),"bottom-right":F.none(),bottom:F.some((function(t,n){Qk(t,Jk(Fk(n)))})),"bottom-left":F.none(),left:F.none()},PC=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=DC(t,n,e),r=EC(o);return TC(t,r),o},setToMin:function(t,n){var e=Tk(n);TC(t,EC(e))},setToMax:function(t,n){var e=Bk(n);TC(t,EC(e))},findValueOfOffset:DC,getValueFromEvent:function(t){return Ok(t).map((function(t){return t.top}))},findPositionOfValue:BC,setPositionFromValue:function(t,n,e,o){var r=Yk(e),i=BC(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),u=ie(n.element)/2;qn(n.element,"top",i-u+"px")},onLeft:MC,onRight:FC,onUp:IC,onDown:RC,edgeActions:NC}),VC=function(t,n){Ci(t,Ck(),{value:n})},HC=function(t,n){return{x:t,y:n}},LC=function(t,n){return function(e,o){return function(t,n,e,o){var r=t>0?tC:Zk,i=n?Yk(o).x:r(Yk(o).x,_k(o),Ak(o),Hk(o)),u=n?r(Yk(o).y,Tk(o),Bk(o),Hk(o)):Yk(o).y;return VC(e,HC(i,u)),F.some(i)}(t,n,e,o).map(O)}},zC=LC(-1,!1),UC=LC(1,!1),jC=LC(-1,!0),WC=LC(1,!0),GC={"top-left":F.some((function(t,n){Qk(t,$k(Ek(n),Dk(n)))})),top:F.some((function(t,n){Qk(t,$k(Pk(n),Dk(n)))})),"top-right":F.some((function(t,n){Qk(t,$k(Mk(n),Dk(n)))})),right:F.some((function(t,n){Qk(t,$k(Mk(n),Vk(n)))})),"bottom-right":F.some((function(t,n){Qk(t,$k(Mk(n),Fk(n)))})),bottom:F.some((function(t,n){Qk(t,$k(Pk(n),Fk(n)))})),"bottom-left":F.some((function(t,n){Qk(t,$k(Ek(n),Fk(n)))})),left:F.some((function(t,n){Qk(t,$k(Ek(n),Vk(n)))}))},XC=Object.freeze({__proto__:null,setValueFrom:function(t,n,e){var o=bC(t,n,e.left),r=DC(t,n,e.top),i=HC(o,r);return VC(t,i),i},setToMin:function(t,n){var e=_k(n),o=Tk(n);VC(t,HC(e,o))},setToMax:function(t,n){var e=Ak(n),o=Bk(n);VC(t,HC(e,o))},getValueFromEvent:function(t){return Ok(t)},setPositionFromValue:function(t,n,e,o){var r=Yk(e),i=xC(t,o.getSpectrum(t),r.x,o.getLeftEdge(t),o.getRightEdge(t),e),u=BC(t,o.getSpectrum(t),r.y,o.getTopEdge(t),o.getBottomEdge(t),e),a=me(n.element)/2,c=ie(n.element)/2;qn(n.element,"left",i-a+"px"),qn(n.element,"top",u-c+"px")},onLeft:zC,onRight:UC,onUp:jC,onDown:WC,edgeActions:GC}),qC=Td({name:"Slider",configFields:[ur("stepSize",1),ur("onChange",p),ur("onChoose",p),ur("onInit",p),ur("onDragStart",p),ur("onDragEnd",p),ur("snapToGrid",!1),ur("rounded",!0),Qo("snapStart"),Wo("model",Ho("mode",{x:[ur("minX",0),ur("maxX",100),zo("value",(function(t){return pr(t.mode.minX)})),jo("getInitialValue"),Oa("manager",_C)],y:[ur("minY",0),ur("maxY",100),zo("value",(function(t){return pr(t.mode.minY)})),jo("getInitialValue"),Oa("manager",PC)],xy:[ur("minX",0),ur("maxX",100),ur("minY",0),ur("maxY",100),zo("value",(function(t){return pr({x:t.mode.minX,y:t.mode.minY})})),jo("getInitialValue"),Oa("manager",XC)]})),kl("sliderBehaviours",[$g,Sl]),zo("mouseIsDown",(function(){return pr(!1)}))],partFields:kk,factory:function(t,n,e,o){var r,i=function(n){return md(n,t,"thumb")},u=function(n){return md(n,t,"spectrum")},a=function(n){return dd(n,t,"left-edge")},c=function(n){return dd(n,t,"right-edge")},s=function(n){return dd(n,t,"top-edge")},f=function(n){return dd(n,t,"bottom-edge")},l=t.model,d=l.manager,m=function(n,e){d.setPositionFromValue(n,e,t,{getLeftEdge:a,getRightEdge:c,getTopEdge:s,getBottomEdge:f,getSpectrum:u})},g=function(t,n){l.value.set(n);var e=i(t);m(t,e)},p=function(n,e){g(n,e);var o=i(n);return t.onChange(n,o,e),F.some(!0)},h=function(n){var e=t.mouseIsDown.get();t.mouseIsDown.set(!1),e&&dd(n,t,"thumb").each((function(e){var o=l.value.get();t.onChoose(n,e,o)}))},v=function(n,e){e.stop(),t.mouseIsDown.set(!0),t.onDragStart(n,i(n))},b=function(n,e){e.stop(),t.onDragEnd(n,i(n)),h(n)};return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.sliderBehaviours,[$g.config({mode:"special",focusIn:function(n){return dd(n,t,"spectrum").map($g.focusIn).map(O)}}),Sl.config({store:{mode:"manual",getValue:function(t){return l.value.get()}}}),xc.config({channels:(r={},r[il()]={onReceive:h},r)})]),events:Di([Mi(Ck(),(function(t,n){p(t,n.event.value)})),Li((function(n,e){var o=l.getInitialValue();l.value.set(o);var r=i(n);m(n,r);var a=u(n);t.onInit(n,r,a,l.value.get())})),Mi(Ar(),v),Mi(Mr(),b),Mi(Ir(),v),Mi(Pr(),b)]),apis:{resetToMin:function(n){d.setToMin(n,t)},resetToMax:function(n){d.setToMax(n,t)},setValue:g,refresh:m},domModification:{styles:{position:"relative"}}}},apis:{setValue:function(t,n,e){t.setValue(n,e)},resetToMin:function(t,n){t.resetToMin(n)},resetToMax:function(t,n){t.resetToMax(n)},refresh:function(t,n){t.refresh(n)}}}),YC=Qi("rgb-hex-update"),KC=Qi("slider-update"),JC=Qi("palette-update"),$C=[kl("formBehaviours",[Sl])],QC=function(t){return"<alloy.field."+t+">"},ZC=function(t,n){return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.formBehaviours,[Sl.config({store:{mode:"manual",getValue:function(n){var e=pd(n,t);return dt(e,(function(t,n){return t().bind((function(t){return function(t,n){return t.fold((function(){return He.error(n)}),He.value)}(Bd.getCurrent(t),new Error("Cannot find a current component to extract the value from for form part '"+n+"': "+Yi(t.element)))})).map(Sl.getValue)}))},setValue:function(n,e){lt(e,(function(e,o){dd(n,t,o).each((function(t){Bd.getCurrent(t).each((function(t){Sl.setValue(t,e)}))}))}))}}})]),apis:{getField:function(n,e){return dd(n,t,e).bind(Bd.getCurrent)}}}},tO={getField:mu((function(t,n,e){return t.getField(n,e)})),sketch:function(t){var n=function(){var t=[];return{field:function(n,e){return t.push(n),ad("form",QC(n),e)},record:b(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return Ql({name:t,pname:QC(t)})}));return Sd("form",$C,r,ZC,e)}},nO=Qi("valid-input"),eO=Qi("invalid-input"),oO=Qi("validating-input"),rO="colorcustom.rgb.",iO=function(t,n,e,o){var r=function(e,o){return VS.config({invalidClass:n("invalid"),notify:{onValidate:function(t){Ci(t,oO,{type:e})},onValid:function(t){Ci(t,nO,{type:e,value:Sl.getValue(t)})},onInvalid:function(t){Ci(t,eO,{type:e,value:Sl.getValue(t)})}},validator:{validate:function(n){var e=Sl.getValue(n),r=o(e)?He.value(!0):He.error(t("aria.input.invalid"));return ES(r)},validateOnLoad:!1}})},i=function(e,o,i,u,a){var c=t(rO+"range"),s=[Jw.parts.label({dom:{tag:"label",innerHtml:i,attributes:{"aria-label":u}}}),Jw.parts.field({data:a,factory:bS,inputAttributes:T({type:"text"},"hex"===o?{"aria-live":"polite"}:{}),inputClasses:[n("textfield")],inputBehaviours:gc([r(o,e),Zw.config({})]),onSetValue:function(t){VS.isInvalid(t)&&VS.run(t).get(p)}})],f="hex"!==o?[Jw.parts["aria-descriptor"]({text:c})]:[];return{dom:{tag:"div",attributes:{role:"presentation"}},components:s.concat(f)}},u=function(t,n){var e=n.red,o=n.green,r=n.blue;Sl.setValue(t,{red:e,green:o,blue:r})},a=ph({dom:{tag:"div",classes:[n("rgba-preview")],styles:{"background-color":"white"},attributes:{role:"presentation"}}}),c=function(t,n){a.getOpt(t).each((function(t){qn(t.element,"background-color","#"+n.value)}))};return _d({factory:function(){var r={red:pr(F.some(255)),green:pr(F.some(255)),blue:pr(F.some(255)),hex:pr(F.some("ffffff"))},s=function(t){return r[t].get()},f=function(t,n){r[t].set(n)},l=function(t){var n=t.red,e=t.green,o=t.blue;f("red",F.some(n)),f("green",F.some(e)),f("blue",F.some(o))},d=function(t,n){var e=n.event;"hex"!==e.type?f(e.type,F.none()):o(t)},m=function(t,n){e(t);var o=bx(n);f("hex",F.some(n));var r=Ix(o);u(t,r),l(r),Ci(t,YC,{hex:o}),c(t,o)},g=function(t,n,e){var o=parseInt(e,10);f(n,F.some(o)),s("red").bind((function(t){return s("green").bind((function(n){return s("blue").map((function(e){return Bx(t,n,e,1)}))}))})).each((function(n){var e=function(t,n){var e=Ox(n);return tO.getField(t,"hex").each((function(n){sp.isFocused(n)||Sl.setValue(t,{hex:e.value})})),e}(t,n);Ci(t,YC,{hex:e}),c(t,e)}))},p=function(t,n){var e=n.event;!function(t){return"hex"===t.type}(e)?g(t,e.type,e.value):m(t,e.value)},h=function(n){return{label:t(rO+n+".label"),description:t(rO+n+".description")}},v=h("red"),b=h("green"),y=h("blue"),x=h("hex");return eo(tO.sketch((function(e){return{dom:{tag:"form",classes:[n("rgb-form")],attributes:{"aria-label":t("aria.color.picker")}},components:[e.field("red",Jw.sketch(i(Mx,"red",v.label,v.description,255))),e.field("green",Jw.sketch(i(Mx,"green",b.label,b.description,255))),e.field("blue",Jw.sketch(i(Mx,"blue",y.label,y.description,255))),e.field("hex",Jw.sketch(i(wx,"hex",x.label,x.description,"ffffff"))),a.asSpec()],formBehaviours:gc([VS.config({invalidClass:n("form-invalid")}),rp("rgb-form-events",[Mi(nO,p),Mi(eO,d),Mi(oO,d)])])}})),{apis:{updateHex:function(t,n){Sl.setValue(t,{hex:n.value}),function(t,n){var e=Ix(n);u(t,e),l(e)}(t,n),c(t,n)}}})},name:"RgbForm",configFields:[],apis:{updateHex:function(t,n,e){t.updateHex(n,e)}},extraApis:{}})},uO=function(t,n){var e=qC.parts.spectrum({dom:{tag:"canvas",attributes:{role:"presentation"},classes:[n("sv-palette-spectrum")]}}),o=qC.parts.thumb({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette-thumb")],innerHtml:"<div class="+n("sv-palette-inner-thumb")+' role="presentation"></div>'}}),r=function(t,n){var e=t.width,o=t.height,r=t.getContext("2d");if(null!==r){r.fillStyle=n,r.fillRect(0,0,e,o);var i=r.createLinearGradient(0,0,e,0);i.addColorStop(0,"rgba(255,255,255,1)"),i.addColorStop(1,"rgba(255,255,255,0)"),r.fillStyle=i,r.fillRect(0,0,e,o);var u=r.createLinearGradient(0,0,0,o);u.addColorStop(0,"rgba(0,0,0,0)"),u.addColorStop(1,"rgba(0,0,0,1)"),r.fillStyle=u,r.fillRect(0,0,e,o)}};return _d({factory:function(t){var i=b({x:0,y:0}),u=gc([Bd.config({find:F.some}),sp.config({})]);return qC.sketch({dom:{tag:"div",attributes:{role:"presentation"},classes:[n("sv-palette")]},model:{mode:"xy",getInitialValue:i},rounded:!1,components:[e,o],onChange:function(t,n,e){Ci(t,JC,{value:e})},onInit:function(t,n,e,o){r(e.element.dom,Px(Vx))},sliderBehaviours:u})},name:"SaturationBrightnessPalette",configFields:[],apis:{setHue:function(t,n,e){!function(t,n){var e=t.components()[0].element.dom,o=Lx(n,100,100),i=Fx(o);r(e,Px(i))}(n,e)},setThumb:function(t,n,e){!function(t,n){var e=zx(Ix(n));qC.setValue(t,{x:e.saturation,y:100-e.value})}(n,e)}},extraApis:{}})},aO=function(t,n){return _d({name:"ColourPicker",configFields:[jo("dom"),ur("onValidHex",p),ur("onInvalidHex",p)],factory:function(e){var o=iO(t,n,e.onValidHex,e.onInvalidHex),r=uO(0,n),i=function(t){return 100-t/360*100},u={paletteRgba:pr(Vx),paletteHue:pr(0)},a=ph(function(t,n){var e=qC.parts.spectrum({dom:{tag:"div",classes:[n("hue-slider-spectrum")],attributes:{role:"presentation"}}}),o=qC.parts.thumb({dom:{tag:"div",classes:[n("hue-slider-thumb")],attributes:{role:"presentation"}}});return qC.sketch({dom:{tag:"div",classes:[n("hue-slider")],attributes:{role:"presentation"}},rounded:!1,model:{mode:"y",getInitialValue:b({y:0})},components:[e,o],sliderBehaviours:gc([sp.config({})]),onChange:function(t,n,e){Ci(t,KC,{value:e})}})}(0,n)),c=ph(r.sketch({})),s=ph(o.sketch({})),f=function(t,n,e){c.getOpt(t).each((function(t){r.setHue(t,e)}))},l=function(t,n){s.getOpt(t).each((function(t){o.updateHex(t,n)}))},d=function(t,n,e){a.getOpt(t).each((function(t){qC.setValue(t,{y:i(e)})}))},m=function(t,n){c.getOpt(t).each((function(t){r.setThumb(t,n)}))},g=function(t,n,e,o){(function(t,n){var e=Ix(t);u.paletteRgba.set(e),u.paletteHue.set(n)})(n,e),j(o,(function(o){o(t,n,e)}))};return{uid:e.uid,dom:e.dom,components:[c.asSpec(),a.asSpec(),s.asSpec()],behaviours:gc([rp("colour-picker-events",[Mi(YC,function(){var t=[f,d,m];return function(n,e){var o=e.event.hex,r=function(t){return zx(Ix(t))}(o);g(n,o,r.hue,t)}}()),Mi(JC,function(){var t=[l];return function(n,e){var o=e.event.value,r=u.paletteHue.get(),i=Lx(r,o.x,100-o.y),a=Ux(i);g(n,a,r,t)}}()),Mi(KC,function(){var t=[f,l];return function(n,e){var o=function(t){return(100-t)/100*360}(e.event.value.y),r=u.paletteRgba.get(),i=zx(r),a=Lx(o,i.saturation,i.value),c=Ux(a);g(n,c,o,t)}}())]),Bd.config({find:function(t){return s.getOpt(t)}}),$g.config({mode:"acyclic"})])}}})},cO=function(){return Bd.config({find:F.some})},sO=function(t){return Bd.config({find:t.getOpt})},fO=function(t){return Bd.config({find:function(n){return Cn(n.element,t).bind((function(t){return n.getSystem().getByDom(t).toOptional()}))}})},lO={"colorcustom.rgb.red.label":"R","colorcustom.rgb.red.description":"Red component","colorcustom.rgb.green.label":"G","colorcustom.rgb.green.description":"Green component","colorcustom.rgb.blue.label":"B","colorcustom.rgb.blue.description":"Blue component","colorcustom.rgb.hex.label":"#","colorcustom.rgb.hex.description":"Hex color code","colorcustom.rgb.range":"Range 0 to 255","colorcustom.sb.saturation":"Saturation","colorcustom.sb.brightness":"Brightness","colorcustom.sb.picker":"Saturation and Brightness Picker","colorcustom.sb.palette":"Saturation and Brightness Palette","colorcustom.sb.instructions":"Use arrow keys to select saturation and brightness, on x and y axes","colorcustom.hue.hue":"Hue","colorcustom.hue.slider":"Hue Slider","colorcustom.hue.palette":"Hue Palette","colorcustom.hue.instructions":"Use arrow keys to select a hue","aria.color.picker":"Color Picker","aria.input.invalid":"Invalid input"},dO=function(t){return function(t){return lO[t]}(t)},mO=tinymce.util.Tools.resolve("tinymce.Resource"),gO=tinymce.util.Tools.resolve("tinymce.util.Tools"),pO=yo([ur("preprocess",y),ur("postprocess",y)]),hO=function(t,n,e){return Sl.config(eo({store:{mode:"manual",getValue:n,setValue:e}},t.map((function(t){return{store:{initialValue:t}}})).getOr({})))},vO=function(t,n,e){return hO(t,(function(t){return n(t.element)}),(function(t,n){return e(t.element,n)}))},bO=function(t,n){var e=Po("RepresentingConfigs.memento processors",pO,n);return Sl.config({store:{mode:"manual",getValue:function(n){var o=t.get(n),r=Sl.getValue(o);return e.postprocess(r)},setValue:function(n,o){var r=e.preprocess(o),i=t.get(n);Sl.setValue(i,r)}}})},yO=hO,xO=function(t){return vO(t,Wi,Gi)},wO=function(t){return Sl.config({store:{mode:"memory",initialValue:t}})},SO=function(t,n){var e=function(t,n){n.stop()},o=function(t){return function(n,e){j(t,(function(t){t(n,e)}))}},r=function(t,n){if(!Gd.isDisabled(t)){var e=n.event.raw;u(t,e.dataTransfer.files)}},i=function(t,n){var e=n.event.raw.target;u(t,e.files)},u=function(e,o){Sl.setValue(e,function(t,n){var e=gO.explode(n.getSetting("images_file_types","jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp","string"));return G(at(t),(function(t){return H(e,(function(n){return Et(t.name.toLowerCase(),"."+n.toLowerCase())}))}))}(o,n)),Ci(e,iS,{name:t.name})},a=ph({dom:{tag:"input",attributes:{type:"file",accept:"image/*"},styles:{display:"none"}},behaviours:gc([rp("input-file-events",[Pi(Gr()),Pi(ri())])])}),c=t.label.map((function(t){return rS(t,n)})),s=Jw.parts.field({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-dropzone-container"]},behaviours:gc([wO([]),cO(),Gd.config({}),wp.config({toggleClass:"dragenter",toggleOnExecute:!1}),rp("dropzone-events",[Mi("dragenter",o([e,wp.toggle])),Mi("dragleave",o([e,wp.toggle])),Mi("dragover",e),Mi("drop",o([e,r])),Mi(Wr(),i)])]),components:[{dom:{tag:"div",classes:["tox-dropzone"],styles:{}},components:[{dom:{tag:"p",innerHtml:n.translate("Drop an image here")}},mh.sketch({dom:{tag:"button",innerHtml:n.translate("Browse for an image"),styles:{position:"relative"},classes:["tox-button","tox-button--secondary"]},components:[a.asSpec()],action:function(t){a.get(t).element.dom.click()},buttonBehaviours:gc([Zw.config({}),Xy(n.isDisabled),Wy()])})]}]}}}});return nS(c,s,["tox-form__group--stretched"],[])},kO=Qi("alloy-fake-before-tabstop"),CO=Qi("alloy-fake-after-tabstop"),OO=function(t){return{dom:{tag:"div",styles:{width:"1px",height:"1px",outline:"none"},attributes:{tabindex:"0"},classes:t},behaviours:gc([sp.config({ignore:!0}),Zw.config({})])}},_O=function(t){return{dom:{tag:"div",classes:["tox-navobj"]},components:[OO([kO]),t,OO([CO])],behaviours:gc([fO(1)])}},TO=function(t,n){Ci(t,zr(),{raw:{which:9,shiftKey:n}})},EO=function(t,n){var e=n.element;Iu(e,kO)?TO(t,!0):Iu(e,CO)&&TO(t,!1)},DO=function(t){return Mw(t,["."+kO,"."+CO].join(","),C)},AO=!(ln().browser.isIE()||ln().browser.isEdge()),BO=function(t,n){var e=AO&&t.sandboxed,o=T(T({},t.label.map((function(t){return{title:t}})).getOr({})),e?{sandbox:"allow-scripts allow-same-origin"}:{}),r=function(t){var n=pr("");return{getValue:function(t){return n.get()},setValue:function(e,o){if(t)Hn(e.element,"srcdoc",o);else{Hn(e.element,"src","javascript:''");var r=e.element.dom.contentWindow.document;r.open(),r.write(o),r.close()}n.set(o)}}}(e),i=t.label.map((function(t){return rS(t,n)})),u=Jw.parts.field({factory:{sketch:function(t){return _O({uid:t.uid,dom:{tag:"iframe",attributes:o},behaviours:gc([Zw.config({}),sp.config({}),yO(F.none(),r.getValue,r.setValue)])})}}});return nS(i,u,["tox-form__group--stretched"],[])},MO=function(t,n){return RO(document.createElement("canvas"),t,n)},FO=function(t){var n=MO(t.width,t.height);return IO(n).drawImage(t,0,0),n},IO=function(t){return t.getContext("2d")},RO=function(t,n,e){return t.width=n,t.height=e,t},NO=function(t){return t.naturalWidth||t.width},PO=function(t){return t.naturalHeight||t.height},VO=function(t){return new SS((function(n,e){(function(t){var n=t.split(","),e=/data:([^;]+)/.exec(n[0]);if(!e)return F.none();for(var o=e[1],r=n[1],i=1024,u=atob(r),a=u.length,c=Math.ceil(a/i),s=new Array(c),f=0;f<c;++f){for(var l=f*i,d=Math.min(l+i,a),m=new Array(d-l),g=l,p=0;g<d;++p,++g)m[p]=u[g].charCodeAt(0);s[f]=new Uint8Array(m)}return F.some(new Blob(s,{type:o}))})(t).fold((function(){e("uri is not base64: "+t)}),n)}))},HO=function(t,n,e){return n=n||"image/png",d(HTMLCanvasElement.prototype.toBlob)?new SS((function(o,r){t.toBlob((function(t){t?o(t):r()}),n,e)})):VO(t.toDataURL(n,e))},LO=function(t){return function(t){return new SS((function(n,e){var o=URL.createObjectURL(t),r=new Image,i=function(){r.removeEventListener("load",u),r.removeEventListener("error",a)},u=function(){i(),n(r)},a=function(){i(),e("Unable to load data of type "+t.type+": "+o)};r.addEventListener("load",u),r.addEventListener("error",a),r.src=o,r.complete&&setTimeout(u,0)}))}(t).then((function(t){zO(t);var n=MO(NO(t),PO(t));return IO(n).drawImage(t,0,0),n}))},zO=function(t){URL.revokeObjectURL(t.src)},UO=function(t,n,e){var o=n.type,r=b(o),i=b(e),u=function(n,e){return t.then((function(t){return function(t,n,e){return n=n||"image/png",t.toDataURL(n,e)}(t,n,e)}))};return{getType:r,toBlob:function(){return SS.resolve(n)},toDataURL:i,toBase64:function(){return e.split(",")[1]},toAdjustedBlob:function(n,e){return t.then((function(t){return HO(t,n,e)}))},toAdjustedDataURL:u,toAdjustedBase64:function(t,n){return u(t,n).then((function(t){return t.split(",")[1]}))},toCanvas:function(){return t.then(FO)}}},jO=function(t){return function(t){return new SS((function(n){var e=new FileReader;e.onloadend=function(){n(e.result)},e.readAsDataURL(t)}))}(t).then((function(n){return UO(LO(t),t,n)}))},WO=function(t,n){return HO(t,n).then((function(n){return UO(SS.resolve(t),n,t.toDataURL())}))},GO=function(t,n,e){var o="string"==typeof t?parseFloat(t):t;return o>e?o=e:o<n&&(o=n),o},XO=[0,.01,.02,.04,.05,.06,.07,.08,.1,.11,.12,.14,.15,.16,.17,.18,.2,.21,.22,.24,.25,.27,.28,.3,.32,.34,.36,.38,.4,.42,.44,.46,.48,.5,.53,.56,.59,.62,.65,.68,.71,.74,.77,.8,.83,.86,.89,.92,.95,.98,1,1.06,1.12,1.18,1.24,1.3,1.36,1.42,1.48,1.54,1.6,1.66,1.72,1.78,1.84,1.9,1.96,2,2.12,2.25,2.37,2.5,2.62,2.75,2.87,3,3.2,3.4,3.6,3.8,4,4.3,4.7,4.9,5,5.5,6,6.5,6.8,7,7.3,7.5,7.8,8,8.4,8.7,9,9.4,9.6,9.8,10],qO=function(t,n){for(var e,o=[],r=new Array(25),i=0;i<5;i++){for(var u=0;u<5;u++)o[u]=n[u+5*i];for(u=0;u<5;u++){e=0;for(var a=0;a<5;a++)e+=t[u+5*a]*o[a];r[u+5*i]=e}}return r},YO=function(t,n){return t.toCanvas().then((function(e){return KO(e,t.getType(),n)}))},KO=function(t,n,e){var o=IO(t),r=function(t,n){for(var e,o,r,i,u=t.data,a=n[0],c=n[1],s=n[2],f=n[3],l=n[4],d=n[5],m=n[6],g=n[7],p=n[8],h=n[9],v=n[10],b=n[11],y=n[12],x=n[13],w=n[14],S=n[15],k=n[16],C=n[17],O=n[18],_=n[19],T=0;T<u.length;T+=4)e=u[T],o=u[T+1],r=u[T+2],i=u[T+3],u[T]=e*a+o*c+r*s+i*f+l,u[T+1]=e*d+o*m+r*g+i*p+h,u[T+2]=e*v+o*b+r*y+i*x+w,u[T+3]=e*S+o*k+r*C+i*O+_;return t}(o.getImageData(0,0,t.width,t.height),e);return o.putImageData(r,0,0),WO(t,n)},JO=function(t,n,e){var o=IO(t),r=o.getImageData(0,0,t.width,t.height),i=o.getImageData(0,0,t.width,t.height);return i=function(t,n,e){for(var o=function(t,n,e){return t>e?t=e:t<n&&(t=n),t},r=Math.round(Math.sqrt(e.length)),i=Math.floor(r/2),u=t.data,a=n.data,c=t.width,s=t.height,f=0;f<s;f++)for(var l=0;l<c;l++){for(var d=0,m=0,g=0,p=0;p<r;p++)for(var h=0;h<r;h++){var v=o(l+h-i,0,c-1),b=4*(o(f+p-i,0,s-1)*c+v),y=e[p*r+h];d+=u[b]*y,m+=u[b+1]*y,g+=u[b+2]*y}var x=4*(f*c+l);a[x]=o(d,0,255),a[x+1]=o(m,0,255),a[x+2]=o(g,0,255)}return n}(r,i,e),o.putImageData(i,0,0),WO(t,n)},$O=function(t){return function(n,e){return YO(n,t([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],e))}},QO=function(t){return function(n){return YO(n,t)}}([-1,0,0,0,255,0,-1,0,0,255,0,0,-1,0,255,0,0,0,1,0,0,0,0,0,1]),ZO=$O((function(t,n){return n=GO(255*n,-255,255),qO(t,[1,0,0,0,n,0,1,0,0,n,0,0,1,0,n,0,0,0,1,0,0,0,0,0,1])})),t_=$O((function(t,n){var e;return n=GO(n,-1,1),(n*=100)<0?e=127+n/100*127:e=127*(e=0===(e=n%1)?XO[n]:XO[Math.floor(n)]*(1-e)+XO[Math.floor(n)+1]*e)+127,qO(t,[e/127,0,0,0,.5*(127-e),0,e/127,0,0,.5*(127-e),0,0,e/127,0,.5*(127-e),0,0,0,1,0,0,0,0,0,1])})),n_=function(t,n,e,o){return YO(t,function(t,n,e,o){return n=GO(n,0,2),e=GO(e,0,2),o=GO(o,0,2),qO(t,[n,0,0,0,0,0,e,0,0,0,0,0,o,0,0,0,0,0,1,0,0,0,0,0,1])}([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1],n,e,o))},e_=function(t){return function(n){return function(t,n){return t.toCanvas().then((function(e){return JO(e,t.getType(),n)}))}(n,t)}}([0,-1,0,-1,5,-1,0,-1,0]),o_=function(t){var n=function(n,e,o){for(var r=IO(n),i=new Array(256),u=0;u<i.length;u++)i[u]=t(u,o);var a=function(t,n){for(var e=t.data,o=0;o<e.length;o+=4)e[o]=n[e[o]],e[o+1]=n[e[o+1]],e[o+2]=n[e[o+2]];return t}(r.getImageData(0,0,n.width,n.height),i);return r.putImageData(a,0,0),WO(n,e)};return function(t,e){return t.toCanvas().then((function(o){return n(o,t.getType(),e)}))}}((function(t,n){return 255*Math.pow(t/255,1-n)})),r_=function(t,n,e){var o=NO(t),r=PO(t),i=n/o,u=e/r,a=!1;(i<.5||i>2)&&(i=i<.5?.5:2,a=!0),(u<.5||u>2)&&(u=u<.5?.5:2,a=!0);var c=i_(t,i,u);return a?c.then((function(t){return r_(t,n,e)})):c},i_=function(t,n,e){return new SS((function(o){var r=NO(t),i=PO(t),u=Math.floor(r*n),a=Math.floor(i*e),c=MO(u,a);IO(c).drawImage(t,0,0,r,i,0,0,u,a),o(c)}))},u_=function(t,n){void 0===n&&(n=2);var e=Math.pow(10,n),o=Math.round(t*e);return Math.ceil(o/e)},a_=function(t,n,e){var o=(e<0?360+e:e)*Math.PI/180,r=t.width,i=t.height,u=Math.sin(o),a=Math.cos(o),c=u_(Math.abs(r*a)+Math.abs(i*u)),s=u_(Math.abs(r*u)+Math.abs(i*a)),f=MO(c,s),l=IO(f);return l.translate(c/2,s/2),l.rotate(o),l.drawImage(t,-r/2,-i/2),WO(f,n)},c_=function(t,n,e){var o=MO(t.width,t.height),r=IO(o);return"v"===e?(r.scale(1,-1),r.drawImage(t,0,-o.height)):(r.scale(-1,1),r.drawImage(t,-o.width,0)),WO(o,n)},s_=function(t,n,e,o,r,i){var u=MO(r,i);return IO(u).drawImage(t,-e,-o),WO(u,n)},f_=function(t){return QO(t)},l_=function(t){return e_(t)},d_=function(t,n){return o_(t,n)},m_=function(t,n){return ZO(t,n)},g_=function(t,n){return t_(t,n)},p_=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return c_(e,t.getType(),n)}))}(t,n)},h_=function(t,n,e,o,r){return function(t,n,e,o,r){return t.toCanvas().then((function(i){return s_(i,t.getType(),n,e,o,r)}))}(t,n,e,o,r)},v_=function(t,n,e){return function(t,n,e){return t.toCanvas().then((function(o){return r_(o,n,e).then((function(n){return WO(n,t.getType())}))}))}(t,n,e)},b_=function(t,n){return function(t,n){return t.toCanvas().then((function(e){return a_(e,t.getType(),n)}))}(t,n)},y_=function(t,n,e){return Ov(t,{tag:"span",classes:["tox-icon","tox-tbtn__icon-wrap"],behaviours:e},n)},x_=function(t,n){return y_(t,n,[])},w_=function(t,n){return y_(t,n,[op.config({})])},S_=function(t,n,e){return{dom:{tag:"span",innerHtml:e.translate(t),classes:[n+"__select-label"]},behaviours:gc([op.config({})])}},k_=Qi("toolbar.button.execute"),C_=function(t){return ji((function(n,e){Ky(t,n)((function(e){Ci(n,k_,{buttonApi:e}),t.onAction(e)}))}))},O_=((GS={})[ei()]=["disabling","alloy.base.behaviour","toggling","toolbar-button-events"],GS),__=Qi("update-menu-text"),T_=Qi("update-menu-icon"),E_=function(t,n,e){var o=pr(p),r=t.text.map((function(t){return ph(S_(t,n,e.providers))})),i=t.icon.map((function(t){return ph(w_(t,e.providers.icons))})),u=function(t,n){var e=Sl.getValue(t);return sp.focus(e),Ci(e,"keydown",{raw:n.event.raw}),rk.close(e),F.some(!0)},a=t.role.fold((function(){return{}}),(function(t){return{role:t}})),c=t.tooltip.fold((function(){return{}}),(function(t){var n=e.providers.translate(t);return{title:n,"aria-label":n}})),s=Ov("chevron-down",{tag:"div",classes:[n+"__select-chevron"]},e.providers.icons);return ph(rk.sketch(T(T(T({},t.uid?{uid:t.uid}:{}),a),{dom:{tag:"button",classes:[n,n+"--select"].concat(U(t.classes,(function(t){return n+"--"+t}))),attributes:T({},c)},components:tx([i.map((function(t){return t.asSpec()})),r.map((function(t){return t.asSpec()})),F.some(s)]),matchWidth:!0,useMinWidth:!0,dropdownBehaviours:gc(D(D([],t.dropdownBehaviours,!0),[Xy((function(){return t.disabled||e.providers.isDisabled()})),Wy(),uk.config({}),op.config({}),rp("dropdown-events",[Jy(t,o),$y(t,o)]),rp("menubutton-update-display-text",[Mi(__,(function(t,n){r.bind((function(n){return n.getOpt(t)})).each((function(t){op.set(t,[Gu(e.providers.translate(n.event.text))])}))})),Mi(T_,(function(t,n){i.bind((function(n){return n.getOpt(t)})).each((function(t){op.set(t,[w_(n.event.icon,e.providers.icons)])}))}))])],!1)),eventOrder:eo(O_,{mousedown:["focusing","alloy.base.behaviour","item-type-events","normal-dropdown-events"]}),sandboxBehaviours:gc([$g.config({mode:"special",onLeft:u,onRight:u})]),lazySink:e.getSink,toggleClass:n+"--active",parts:{menu:Mb(0,t.columns,t.presets)},fetch:function(n){return TS(w(t.fetch,n))}}))).asSpec()},D_=function(t){return"separator"===t.type},A_={type:"separator"},B_=function(t,n){var e=q(t,(function(t,e){return function(t){return r(t)}(e)?""===e?t:"|"===e?t.length>0&&!D_(t[t.length-1])?t.concat([A_]):t:yt(n,e.toLowerCase())?t.concat([n[e.toLowerCase()]]):t:t.concat([e])}),[]);return e.length>0&&D_(e[e.length-1])&&e.pop(),e},M_=function(t,n){return function(t){return yt(t,"getSubmenuItems")}(t)?function(t,n){var e=t.getSubmenuItems(),o=F_(e,n);return{item:t,menus:eo(o.menus,yr(t.value,o.items)),expansions:eo(o.expansions,yr(t.value,t.value))}}(t,n):{item:t,menus:{},expansions:{}}},F_=function(t,n){var e=B_(r(t)?t.split(" "):t,n);return X(e,(function(t,e){var o=function(t){if(D_(t))return t;var n=bt(t,"value").getOrThunk((function(){return Qi("generated-menu-item")}));return eo({value:n},t)}(e),r=M_(o,n);return{menus:eo(t.menus,r.menus),items:[r.item].concat(t.items),expansions:eo(t.expansions,r.expansions)}}),{menus:{},expansions:{},items:[]})},I_=function(t,n,e,o){var r=Qi("primary-menu"),i=F_(t,e.shared.providers.menuItems());if(0===i.items.length)return F.none();var u=Dw(r,i.items,n,e,o),a=dt(i.menus,(function(t,o){return Dw(o,t,n,e,!1)})),c=eo(a,yr(r,u));return F.from(Gp.tieredData(r,c,i.expansions))},R_=function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)},setActive:function(n){var e=t.element;n?(Bu(e,"tox-tbtn--enabled"),Hn(e,"aria-pressed",!0)):(Fu(e,"tox-tbtn--enabled"),Wn(e,"aria-pressed"))},isActive:function(){return Iu(t.element,"tox-tbtn--enabled")}}},N_=function(t,n,e,o){return E_({text:t.text,icon:t.icon,tooltip:t.tooltip,role:o,fetch:function(n,o){t.fetch((function(t){o(I_(t,gb.CLOSE_ON_EXECUTE,e,!1))}))},onSetup:t.onSetup,getApi:R_,columns:1,presets:"normal",classes:[],dropdownBehaviours:[Zw.config({})]},n,e.shared)},P_=function(t,n,e){var o=function(t){return function(o){var r=!o.isActive();o.setActive(r),t.storage.set(r),e.shared.getSink().each((function(e){n().getOpt(e).each((function(n){kc(n.element),Ci(n,cS,{name:t.name,value:t.storage.get()})}))}))}},r=function(t){return function(n){n.setActive(t.storage.get())}};return function(n){n(U(t,(function(t){var n=t.text.fold((function(){return{}}),(function(t){return{text:t}}));return T(T({type:t.type,active:!1},n),{onAction:o(t),onSetup:r(t)})})))}},V_=function(t,n,e,o,r,i){void 0===e&&(e=[]);var u=n.fold((function(){return{}}),(function(t){return{action:t}})),a=T({buttonBehaviours:gc([Xy((function(){return t.disabled||i.isDisabled()})),Wy(),Zw.config({}),rp("button press",[Bi("click"),Bi("mousedown")])].concat(e)),eventOrder:{click:["button press","alloy.base.behaviour"],mousedown:["button press","alloy.base.behaviour"]}},u),c=eo(a,{dom:o});return eo(c,{components:r})},H_=function(t,n,e,o){void 0===o&&(o=[]);var r={tag:"button",classes:["tox-tbtn"],attributes:t.tooltip.map((function(t){return{"aria-label":e.translate(t),title:e.translate(t)}})).getOr({})},i=t.icon.map((function(t){return x_(t,e.icons)})),u=tx([i]);return V_(t,n,o,r,u,e)},L_=function(t,n,e,o){void 0===o&&(o=[]);var r=H_(t,F.some(n),e,o);return mh.sketch(r)},z_=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=e.translate(t.text),u=t.icon?t.icon.map((function(t){return x_(t,e.icons)})):F.none(),a=u.isSome()?tx([u]):[],c=u.isSome()?{}:{innerHtml:i},s=D(D(D(D([],t.primary||t.borderless?["tox-button"]:["tox-button","tox-button--secondary"],!0),u.isSome()?["tox-button--icon"]:[],!0),t.borderless?["tox-button--naked"]:[],!0),r,!0),f=T(T({tag:"button",classes:s},c),{attributes:{title:i}});return V_(t,n,o,f,a,e)},U_=function(t,n,e,o,r){void 0===o&&(o=[]),void 0===r&&(r=[]);var i=z_(t,F.some(n),e,o,r);return mh.sketch(i)},j_=function(t,n){return function(e){"custom"===n?Ci(e,cS,{name:t,value:{}}):"submit"===n?ki(e,sS):"cancel"===n?ki(e,aS):console.error("Unknown button type: ",n)}},W_=function(t,n,e){if(function(t,n){return"menu"===n}(0,n)){var o=t,r=T(T({},t),{onSetup:function(n){return n.setDisabled(t.disabled),p},fetch:P_(o.items,(function(){return i}),e)}),i=ph(N_(r,"tox-tbtn",e,F.none()));return i.asSpec()}if(function(t,n){return"custom"===n||"cancel"===n||"submit"===n}(0,n)){var u=j_(t.name,n),a=T(T({},t),{borderless:!1});return U_(a,u,e.shared.providers,[])}console.error("Unknown footer button type: ",n)},G_=function(t,n){var e=j_(t.name,"custom");return function(t,n){return nS(t,n,[],[])}(F.none(),Jw.parts.field(T({factory:mh},z_(t,F.some(e),n,[wO(""),cO()]))))},X_=b([ur("field1Name","field1"),ur("field2Name","field2"),ka("onLockedChange"),ya(["lockClass"]),ur("locked",!1),_l("coupledFieldBehaviours",[Bd,Sl])]),q_=function(t,n){return Ql({factory:Jw,name:t,overrides:function(t){return{fieldBehaviours:gc([rp("coupled-input-behaviour",[Mi(jr(),(function(e){(function(t,n,e){return dd(t,n,e).bind(Bd.getCurrent)})(e,t,n).each((function(n){dd(e,t,"lock").each((function(o){wp.isOn(o)&&t.onLockedChange(e,n,o)}))}))}))])])}}})},Y_=b([q_("field1","field2"),q_("field2","field1"),Ql({factory:mh,schema:[jo("dom")],name:"lock",overrides:function(t){return{buttonBehaviours:gc([wp.config({selected:t.locked,toggleClass:t.markers.lockClass,aria:{mode:"pressed"}})])}}})]),K_=Td({name:"FormCoupledInputs",configFields:X_(),partFields:Y_(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Tl(t.coupledFieldBehaviours,[Bd.config({find:F.some}),Sl.config({store:{mode:"manual",getValue:function(n){var e,o=vd(n,t,["field1","field2"]);return(e={})[t.field1Name]=Sl.getValue(o.field1()),e[t.field2Name]=Sl.getValue(o.field2()),e},setValue:function(n,e){var o=vd(n,t,["field1","field2"]);xt(e,t.field1Name)&&Sl.setValue(o.field1(),e[t.field1Name]),xt(e,t.field2Name)&&Sl.setValue(o.field2(),e[t.field2Name])}}})]),apis:{getField1:function(n){return dd(n,t,"field1")},getField2:function(n){return dd(n,t,"field2")},getLock:function(n){return dd(n,t,"lock")}}}},apis:{getField1:function(t,n){return t.getField1(n)},getField2:function(t,n){return t.getField2(n)},getLock:function(t,n){return t.getLock(n)}}}),J_=function(t){var n=/^\s*(\d+(?:\.\d+)?)\s*(|cm|mm|in|px|pt|pc|em|ex|ch|rem|vw|vh|vmin|vmax|%)\s*$/.exec(t);if(null!==n){var e=parseFloat(n[1]),o=n[2];return He.value({value:e,unit:o})}return He.error(t)},$_=function(t,n){var e={"":96,px:96,pt:72,cm:2.54,pc:12,mm:25.4,in:1},o=function(t){return yt(e,t)};return t.unit===n?F.some(t.value):o(t.unit)&&o(n)?e[t.unit]===e[n]?F.some(t.value):F.some(t.value/e[t.unit]*e[n]):F.none()},Q_=function(t){return F.none()},Z_=function(t,n){var e=J_(t).toOptional(),o=J_(n).toOptional();return kt(e,o,(function(t,n){return $_(t,n.unit).map((function(t){return n.value/t})).map((function(t){return function(t,n){return function(e){return $_(e,n).map((function(e){return{value:e*t,unit:n}}))}}(t,n.unit)})).getOr(Q_)})).getOr(Q_)},tT=function(t,n){var e=Q_,o=Qi("ratio-event"),r=function(t){return Ov(t,{tag:"span",classes:["tox-icon","tox-lock-icon__"+t]},n.icons)},i=K_.parts.lock({dom:{tag:"button",classes:["tox-lock","tox-button","tox-button--naked","tox-button--icon"],attributes:{title:n.translate(t.label.getOr("Constrain proportions"))}},components:[r("lock"),r("unlock")],buttonBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wy(),Zw.config({})])}),u=function(t){return{dom:{tag:"div",classes:["tox-form__group"]},components:t}},a=function(e){return Jw.parts.field({factory:bS,inputClasses:["tox-textfield"],inputBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wy(),Zw.config({}),rp("size-input-events",[Mi(Hr(),(function(t,n){Ci(t,o,{isField1:e})})),Mi(Wr(),(function(n,e){Ci(n,iS,{name:t.name})}))])]),selectOnFocus:!1})},c=function(t){return{dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}},s=K_.parts.field1(u([Jw.parts.label(c("Width")),a(!0)])),f=K_.parts.field2(u([Jw.parts.label(c("Height")),a(!1)]));return K_.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:[{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:[s,f,u([c("&nbsp;"),i])]}],field1Name:"width",field2Name:"height",locked:!0,markers:{lockClass:"tox-locked"},onLockedChange:function(t,n,o){J_(Sl.getValue(t)).each((function(t){e(t).each((function(t){Sl.setValue(n,function(t){var n={"":0,px:0,pt:1,mm:1,pc:2,ex:2,em:2,ch:2,rem:2,cm:3,in:4,"%":4},e=t.value.toFixed(function(t){return t in n?n[t]:1}(t.unit));return-1!==e.indexOf(".")&&(e=e.replace(/\.?0*$/,"")),e+t.unit}(t))}))}))},coupledFieldBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){K_.getField1(t).bind(Jw.getField).each(Gd.disable),K_.getField2(t).bind(Jw.getField).each(Gd.disable),K_.getLock(t).each(Gd.disable)},onEnabled:function(t){K_.getField1(t).bind(Jw.getField).each(Gd.enable),K_.getField2(t).bind(Jw.getField).each(Gd.enable),K_.getLock(t).each(Gd.enable)}}),Wy(),rp("size-input-events2",[Mi(o,(function(t,n){var o=n.event.isField1,r=o?K_.getField1(t):K_.getField2(t),i=o?K_.getField2(t):K_.getField1(t),u=r.map(Sl.getValue).getOr(""),a=i.map(Sl.getValue).getOr("");e=Z_(u,a)}))])])})},nT={undo:b(Qi("undo")),redo:b(Qi("redo")),zoom:b(Qi("zoom")),back:b(Qi("back")),apply:b(Qi("apply")),swap:b(Qi("swap")),transform:b(Qi("transform")),tempTransform:b(Qi("temp-transform")),transformApply:b(Qi("transform-apply"))},eT=b("save-state"),oT=b("disable"),rT=b("enable"),iT={formActionEvent:cS,saveState:eT,disable:oT,enable:rT},uT=function(t,n){var e=function(t,e,o,r){return ph(U_({name:t,text:t,disabled:o,primary:r,icon:F.none(),borderless:!1},e,n))},o=function(t,e,o,r){return ph(L_({name:t,icon:F.some(t),tooltip:F.some(e),disabled:r,primary:!1,borderless:!1},o,n))},r=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Gd)&&Gd.disable(e)}))},i=function(t,n){t.map((function(t){var e=t.get(n);e.hasConfigured(Gd)&&Gd.enable(e)}))},u={tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools-edit-panel"]},a=p,c=function(t,n,e){Ci(t,n,e)},s=function(t){return ki(t,iT.disable())},f=function(t){return ki(t,iT.enable())},l=function(t,n){s(t),c(t,nT.transform(),{transform:n}),f(t)},d=function(t){return function(){tt.getOpt(t).each((function(t){op.set(t,[Q])}))}},m=function(t,n){s(t),c(t,nT.transformApply(),{transform:n,swap:d(t)}),f(t)},g=function(){return e("Back",(function(t){return c(t,nT.back(),{swap:d(t)})}),!1,!1)},h=function(){return ph({dom:{tag:"div",classes:["tox-spacer"]},behaviours:gc([Gd.config({})])})},v=function(){return e("Apply",(function(t){return c(t,nT.apply(),{swap:d(t)})}),!0,!0)},y=[g(),h(),e("Apply",(function(n){m(n,(function(n){var e=t.getRect();return h_(n,e.x,e.y,e.w,e.h)})),t.hideCrop()}),!1,!0)],x=Xw.sketch({dom:u,components:y.map((function(t){return t.asSpec()})),containerBehaviours:gc([rp("image-tools-crop-buttons-events",[Mi(iT.disable(),(function(t,n){r(y,t)})),Mi(iT.enable(),(function(t,n){i(y,t)}))])])}),w=ph(tT({name:"size",label:F.none(),constrain:!0,disabled:!1},n)),S=[g(),h(),w,h(),e("Apply",(function(t){w.getOpt(t).each((function(n){var e=Sl.getValue(n),o=function(t,n){return function(e){return v_(e,t,n)}}(parseInt(e.width,10),parseInt(e.height,10));m(t,o)}))}),!1,!0)],k=Xw.sketch({dom:u,components:S.map((function(t){return t.asSpec()})),containerBehaviours:gc([rp("image-tools-resize-buttons-events",[Mi(iT.disable(),(function(t,n){r(S,t)})),Mi(iT.enable(),(function(t,n){i(S,t)}))])])}),C=function(t,n){return function(e){return t(e,n)}},O=C(p_,"h"),_=C(p_,"v"),T=C(b_,-90),E=C(b_,90),D=function(t,n){!function(t,n){s(t),c(t,nT.tempTransform(),{transform:n}),f(t)}(t,n)},A=[g(),h(),o("flip-horizontally","Flip horizontally",(function(t){D(t,O)}),!1),o("flip-vertically","Flip vertically",(function(t){D(t,_)}),!1),o("rotate-left","Rotate counterclockwise",(function(t){D(t,T)}),!1),o("rotate-right","Rotate clockwise",(function(t){D(t,E)}),!1),h(),v()],B=Xw.sketch({dom:u,components:A.map((function(t){return t.asSpec()})),containerBehaviours:gc([rp("image-tools-fliprotate-buttons-events",[Mi(iT.disable(),(function(t,n){r(A,t)})),Mi(iT.enable(),(function(t,n){i(A,t)}))])])}),M=function(t,e,o,r,i){var u=qC.parts.label({dom:{tag:"label",classes:["tox-label"],innerHtml:n.translate(t)}}),a=qC.parts.spectrum({dom:{tag:"div",classes:["tox-slider__rail"],attributes:{role:"presentation"}}}),c=qC.parts.thumb({dom:{tag:"div",classes:["tox-slider__handle"],attributes:{role:"presentation"}}});return ph(qC.sketch({dom:{tag:"div",classes:["tox-slider"],attributes:{role:"presentation"}},model:{mode:"x",minX:o,maxX:i,getInitialValue:b({x:r})},components:[u,a,c],sliderBehaviours:gc([sp.config({})]),onChoose:e}))},I=function(t,n,e,o,r){return M(t,(function(t,e,o){var r=C(n,o.x/100);l(t,r)}),e,o,r)},R=function(t,n,e,o,a){var c=function(t,n,e,o,r){return[g(),I(t,n,e,o,r),v()]}(t,n,e,o,a);return Xw.sketch({dom:u,components:c.map((function(t){return t.asSpec()})),containerBehaviours:gc([rp("image-tools-filter-panel-buttons-events",[Mi(iT.disable(),(function(t,n){r(c,t)})),Mi(iT.enable(),(function(t,n){i(c,t)}))])])})},N=[g(),h(),v()],P=Xw.sketch({dom:u,components:N.map((function(t){return t.asSpec()}))}),V=R("Brightness",m_,-100,0,100),H=R("Contrast",g_,-100,0,100),L=R("Gamma",d_,-100,0,100),z=function(t,n,e){return function(o){return function(t,n,e,o){return n_(t,n,e,o)}(o,t,n,e)}},U=function(t){return M(t,(function(t,n,e){var o=j.getOpt(t),r=G.getOpt(t),i=W.getOpt(t);o.each((function(n){r.each((function(e){i.each((function(o){var r=Sl.getValue(n).x/100,i=Sl.getValue(o).x/100,u=Sl.getValue(e).x/100,a=z(r,i,u);l(t,a)}))}))}))}),0,100,200)},j=U("R"),W=U("G"),G=U("B"),X=[g(),j,W,G,v()],q=Xw.sketch({dom:u,components:X.map((function(t){return t.asSpec()}))}),Y=function(t,n,e){return function(o){c(o,nT.swap(),{transform:n,swap:function(){tt.getOpt(o).each((function(n){op.set(n,[t]),e(n)}))}})}},K=F.some(l_),J=F.some(f_),$=[o("crop","Crop",Y(x,F.none(),(function(n){t.showCrop()})),!1),o("resize","Resize",Y(k,F.none(),(function(n){w.getOpt(n).each((function(n){var e=t.getMeasurements(),o=e.width,r=e.height;Sl.setValue(n,{width:o,height:r})}))})),!1),o("orientation","Orientation",Y(B,F.none(),a),!1),o("brightness","Brightness",Y(V,F.none(),a),!1),o("sharpen","Sharpen",Y(P,K,a),!1),o("contrast","Contrast",Y(H,F.none(),a),!1),o("color-levels","Color levels",Y(q,F.none(),a),!1),o("gamma","Gamma",Y(L,F.none(),a),!1),o("invert","Invert",Y(P,J,a),!1)],Q=Xw.sketch({dom:u,components:$.map((function(t){return t.asSpec()}))}),Z=Xw.sketch({dom:{tag:"div"},components:[Q],containerBehaviours:gc([op.config({})])}),tt=ph(Z);return{memContainer:tt,getApplyButton:function(t){return tt.getOpt(t).map((function(t){var n=t.components()[0];return n.components()[n.components().length-1]}))}}},aT=tinymce.util.Tools.resolve("tinymce.geom.Rect"),cT=tinymce.util.Tools.resolve("tinymce.util.Observable"),sT=tinymce.util.Tools.resolve("tinymce.util.VK"),fT=function(t){if(function(t){return l(t.changedTouches)}(t))for(var n="screenX screenY pageX pageY clientX clientY".split(" "),e=0;e<n.length;e++)t[n[e]]=t.changedTouches[0][n[e]]};function lT(t,n){var e,o,r,i,u,a,c,s=[],f=[],d=null!==(e=n.document)&&void 0!==e?e:document,m=null!==(o=n.root)&&void 0!==o?o:d,g=Ft.fromDom(d),p=Ft.fromDom(m.getElementById(null!==(r=n.handle)&&void 0!==r?r:t)),h=function(t){var e=t.raw,o=function(t){var n=Math.max,e=t.documentElement,o=t.body,r=n(e.scrollWidth,o.scrollWidth),i=n(e.clientWidth,o.clientWidth),u=n(e.offsetWidth,o.offsetWidth),a=n(e.scrollHeight,o.scrollHeight),c=n(e.clientHeight,o.clientHeight);return{width:r<u?i:r,height:a<n(e.offsetHeight,o.offsetHeight)?c:a}}(d);fT(e),t.prevent(),u=e.button,a=e.screenX,c=e.screenY;var r=Jn(p,"cursor");i=Ft.fromTag("div",d),Yn(i,{position:"absolute",top:"0",left:"0",width:o.width+"px",height:o.height+"px","z-index":"2147483647",opacity:"0.0001",cursor:r}),we(Pn(g),i),f.push(Kc(g,"mousemove",v),Kc(g,"touchmove",v),Kc(g,"mouseup",b),Kc(g,"touchend",b)),n.start(e)},v=function(t){var e=t.raw;if(fT(e),e.button!==u)return b(t);e.deltaX=e.screenX-a,e.deltaY=e.screenY-c,t.prevent(),n.drag(e)},b=function(t){fT(t.raw),j(f,(function(t){return t.unbind()})),f=[],Ce(i),n.stop&&n.stop(t.raw)};return s.push(Kc(p,"mousedown",h),Kc(p,"touchstart",h)),{destroy:function(){j(f.concat(s),(function(t){return t.unbind()})),f=[],s=[],l(i)&&Ce(i)}}}var dT=0,mT=function(t,n,e,o,r){var i,u=[],a="tox-",c=a+"crid-"+dT++,s=Ft.fromDom(o),f=[{name:"move",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:0,deltaH:0,label:"Crop Mask"},{name:"nw",xMul:0,yMul:0,deltaX:1,deltaY:1,deltaW:-1,deltaH:-1,label:"Top Left Crop Handle"},{name:"ne",xMul:1,yMul:0,deltaX:0,deltaY:1,deltaW:1,deltaH:-1,label:"Top Right Crop Handle"},{name:"sw",xMul:0,yMul:1,deltaX:1,deltaY:0,deltaW:-1,deltaH:1,label:"Bottom Left Crop Handle"},{name:"se",xMul:1,yMul:1,deltaX:0,deltaY:0,deltaW:1,deltaH:1,label:"Bottom Right Crop Handle"}],l=["top","right","bottom","left"],d=function(t,n){return{x:n.x-t.x,y:n.y-t.y,w:n.w,h:n.h}},m=function(n,o,r,i){var u=o.x+r*n.deltaX,a=o.y+i*n.deltaY,c=Math.max(20,o.w+r*n.deltaW),s=Math.max(20,o.h+i*n.deltaH),f=t=aT.clamp({x:u,y:a,w:c,h:s},e,"move"===n.name);f=d(e,f),v.fire("updateRect",{rect:f}),h(f)},g=function(t){var e=function(t,n){oa(s,"#"+c+"-"+t).each((function(t){Yn(t,{left:n.x+"px",top:n.y+"px",width:Math.max(0,n.w)+"px",height:Math.max(0,n.h)+"px"})}))};j(f,(function(n){oa(s,"#"+c+"-"+n.name).each((function(e){Yn(e,{left:t.w*n.xMul+t.x+"px",top:t.h*n.yMul+t.y+"px"})}))})),e("top",{x:n.x,y:n.y,w:n.w,h:t.y-n.y}),e("right",{x:t.x+t.w,y:t.y,w:n.w-t.x-t.w+n.x,h:t.h}),e("bottom",{x:n.x,y:t.y+t.h,w:n.w,h:n.h-t.y-t.h+n.y}),e("left",{x:n.x,y:t.y,w:t.x-n.x,h:t.h}),e("move",t)},p=function(n){g(t=n)},h=function(t){p(function(t,n){return{x:n.x+t.x,y:n.y+t.y,w:n.w,h:n.h}}(e,t))};!function(){var n=Ft.fromTag("div");Ln(n,{id:c,class:a+"croprect-container",role:"grid","aria-dropeffect":"execute"}),we(s,n),j(l,(function(t){oa(s,"#"+c).each((function(n){var e=Ft.fromTag("div");Ln(e,{id:c+"-"+t,class:a+"croprect-block","data-mce-bogus":"all"}),qn(e,"display","none"),we(n,e)}))})),j(f,(function(t){oa(s,"#"+c).each((function(n){var e=Ft.fromTag("div");Ln(e,{id:c+"-"+t.name,"aria-label":t.label,"aria-grabbed":"false","data-mce-bogus":"all",role:"gridcell",tabindex:"-1",title:t.label}),Ru(e,[a+"croprect-handle",a+"croprect-handle-"+t.name]),qn(e,"display","none"),we(n,e)}))})),i=U(f,(function(n){var e;return lT(c,{document:o.ownerDocument,root:An(s).dom,handle:c+"-"+n.name,start:function(){e=t},drag:function(t){m(n,e,t.deltaX,t.deltaY)}})})),g(t);var e=function(t){Hn(t.target,"aria-grabbed","focus"===t.raw.type?"true":"false")};u.push(Kc(s,"focusin",e),Kc(s,"focusout",e),Kc(s,"keydown",(function(n){var e;j(f,(function(t){if(zn(n.target,"id")===c+"-"+t.name)return e=t,!1}));var o=function(t,n,o,r,i){t.stopPropagation(),t.preventDefault(),m(e,o,r,i)};switch(n.raw.keyCode){case sT.LEFT:o(n,0,t,-10,0);break;case sT.RIGHT:o(n,0,t,10,0);break;case sT.UP:o(n,0,t,0,-10);break;case sT.DOWN:o(n,0,t,0,10);break;case sT.ENTER:case sT.SPACEBAR:n.prevent(),r()}})))}();var v=T(T({},cT),{toggleVisibility:function(t){var n=D(D([],U(f,(function(t){return"#"+c+"-"+t.name})),!0),U(l,(function(t){return"#"+c+"-"+t})),!0).join(","),e=Zs(s,n);j(e,t?function(t){return ne(t,"display")}:function(t){return qn(t,"display","none")})},setClampRect:function(n){e=n,g(t)},setRect:p,getInnerRect:function(){return d(e,t)},setInnerRect:h,setViewPortRect:function(e){n=e,g(t)},destroy:function(){j(i,(function(t){return t.destroy()})),i=[],j(u,(function(t){return t.unbind()})),u=[]}});return v},gT=function(t){var n=ph({dom:{tag:"div",classes:["tox-image-tools__image-bg"],attributes:{role:"presentation"}}}),e=pr(1),o=function(){var t=Gc();return T(T({},t),{run:function(n){return t.get().each(n)}})}(),r=pr({x:0,y:0,w:1,h:1}),i=pr({x:0,y:0,w:1,h:1}),u=function(t,i){f.getOpt(t).each((function(t){var u=e.get(),a=me(t.element),c=ie(t.element),s=i.dom.naturalWidth*u,f=i.dom.naturalHeight*u,l=Math.max(0,a/2-s/2),d=Math.max(0,c/2-f/2),m={left:l.toString()+"px",top:d.toString()+"px",width:s.toString()+"px",height:f.toString()+"px",position:"absolute"};Yn(i,m),n.getOpt(t).each((function(t){Yn(t.element,m)})),o.run((function(t){var n=r.get();t.setRect({x:n.x*u+l,y:n.y*u+d,w:n.w*u,h:n.h*u}),t.setClampRect({x:l,y:d,w:s,h:f}),t.setViewPortRect({x:0,y:0,w:a,h:c})}))}))},a=function(t,n){f.getOpt(t).each((function(t){var o=me(t.element),r=ie(t.element),i=n.dom.naturalWidth,u=n.dom.naturalHeight,a=Math.min(o/i,r/u);a>=1?e.set(1):e.set(a)}))},c=function(t,n){var e=Ft.fromTag("img");return Hn(e,"src",n),function(t){return new Uv((function(n){var e=function(){t.removeEventListener("load",e),n(t)};t.complete?n(t):t.addEventListener("load",e)}))}(e.dom).then((function(){t.getSystem().isConnected()&&f.getOpt(t).map((function(t){var n=Xu({element:e});op.replaceAt(t,1,F.some(n));var o=i.get(),c={x:0,y:0,w:e.dom.naturalWidth,h:e.dom.naturalHeight};i.set(c);var s=aT.inflate(c,-20,-20);r.set(s),o.w===c.w&&o.h===c.h||a(t,e),u(t,e)}))}))},s=Xw.sketch({dom:{tag:"div",classes:["tox-image-tools__image"]},components:[n.asSpec(),{dom:{tag:"img",attributes:{src:t}}},{dom:{tag:"div"},behaviours:gc([rp("image-panel-crop-events",[Li((function(t){f.getOpt(t).each((function(t){var n=t.element.dom,i=mT({x:10,y:10,w:100,h:100},{x:0,y:0,w:200,h:200},{x:0,y:0,w:200,h:200},n,p);i.toggleVisibility(!1),i.on("updateRect",(function(t){var n=t.rect,o=e.get(),i={x:Math.round(n.x/o),y:Math.round(n.y/o),w:Math.round(n.w/o),h:Math.round(n.h/o)};r.set(i)})),o.set(i)}))})),zi((function(){o.clear()}))])])}],containerBehaviours:gc([op.config({}),rp("image-panel-events",[Li((function(n){c(n,t)}))])])}),f=ph(s);return{memContainer:f,updateSrc:c,zoom:function(t,n){var o=e.get(),r=n>0?Math.min(2,o+.1):Math.max(.1,o-.1);e.set(r),f.getOpt(t).each((function(t){var n=t.components()[1].element;u(t,n)}))},showCrop:function(){o.run((function(t){t.toggleVisibility(!0)}))},hideCrop:function(){o.run((function(t){t.toggleVisibility(!1)}))},getRect:function(){return r.get()},getMeasurements:function(){var t=i.get();return{width:t.w,height:t.h}}}},pT=function(t,n,e,o,r){return L_({name:t,icon:F.some(n),disabled:e,tooltip:F.some(t),primary:!1,borderless:!1},o,r)},hT=function(t,n){n?Gd.enable(t):Gd.disable(t)};var vT,bT=function(t){var n=pr(t),e=qc(),o=function(){var t=[],n=-1,e=function(){return n>0},o=function(){return-1!==n&&n<t.length-1};return{data:t,add:function(e){var o=t.splice(++n);return t.push(e),{state:e,removed:o}},undo:function(){if(e())return t[--n]},redo:function(){if(o())return t[++n]},canUndo:e,canRedo:o}}();o.add(t);var r=function(t){n.set(t)},i=function(t){return{blob:t,url:URL.createObjectURL(t)}},u=function(t){URL.revokeObjectURL(t.url)},a=function(){e.on(u),e.clear()},c=function(t){var n=i(t);return r(n),function(t){gO.each(t,u)}(o.add(n).removed),n.url};return{getBlobState:function(){return n.get()},setBlobState:r,addBlobState:c,getTempState:function(){return e.get().getOrThunk(n.get)},updateTempState:function(t){var n=i(t);return a(),e.set(n),n.url},addTempState:function(t){var n=i(t);return e.set(n),n.url},applyTempState:function(t){return e.get().fold(p,(function(n){c(n.blob),t()}))},destroyTempState:a,undo:function(){var t=o.undo();return r(t),t.url},redo:function(){var t=o.redo();return r(t),t.url},getHistoryStates:function(){return{undoEnabled:o.canUndo(),redoEnabled:o.canRedo()}}}},yT=function(t,n){var e=bT(t.currentState),o=function(t){var n=e.getHistoryStates();d.updateButtonUndoStates(t,n.undoEnabled,n.redoEnabled),Ci(t,iT.formActionEvent,{name:iT.saveState(),value:n.undoEnabled})},r=function(t){return t.toBlob()},i=function(t){Ci(t,iT.formActionEvent,{name:iT.disable(),value:{}})},u=function(t){m.getApplyButton(t).each((function(t){Gd.enable(t)})),Ci(t,iT.formActionEvent,{name:iT.enable(),value:{}})},a=function(t,n){return i(t),l.updateSrc(t,n)},c=function(t,n,e,c,s){i(t),function(t){return jO(t)}(n).then(e).then(r).then(c).then((function(n){return a(t,n)})).then((function(){o(t),s(),u(t)})).catch((function(n){console.log(n),t.getSystem().isConnected()&&u(t)}))},s=function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(t){return e.updateTempState(t)}),o)},f=function(t){var n=e.getBlobState().url;return e.destroyTempState(),o(t),n},l=gT(t.currentState.url),d=function(t){var n=ph(pT("Undo","undo",!0,(function(t){Ci(t,nT.undo(),{direction:1})}),t)),e=ph(pT("Redo","redo",!0,(function(t){Ci(t,nT.redo(),{direction:1})}),t));return{container:Xw.sketch({dom:{tag:"div",classes:["tox-image-tools__toolbar","tox-image-tools__sidebar"]},components:[n.asSpec(),e.asSpec(),pT("Zoom in","zoom-in",!1,(function(t){Ci(t,nT.zoom(),{direction:1})}),t),pT("Zoom out","zoom-out",!1,(function(t){Ci(t,nT.zoom(),{direction:-1})}),t)]}),updateButtonUndoStates:function(t,o,r){n.getOpt(t).each((function(t){hT(t,o)})),e.getOpt(t).each((function(t){hT(t,r)}))}}}(n),m=uT(l,n);return{dom:{tag:"div",attributes:{role:"presentation"}},components:[m.memContainer.asSpec(),l.memContainer.asSpec(),d.container],behaviours:gc([Sl.config({store:{mode:"manual",getValue:function(){return e.getBlobState()}}}),rp("image-tools-events",[Mi(nT.undo(),(function(t,n){var r=e.undo();a(t,r).then((function(n){u(t),o(t)}))})),Mi(nT.redo(),(function(t,n){var r=e.redo();a(t,r).then((function(n){u(t),o(t)}))})),Mi(nT.zoom(),(function(t,n){var e=n.event.direction;l.zoom(t,e)})),Mi(nT.back(),(function(t,n){!function(t){var n=f(t);a(t,n).then((function(n){u(t)}))}(t),(0,n.event.swap)(),l.hideCrop()})),Mi(nT.apply(),(function(t,n){e.applyTempState((function(){f(t),(0,n.event.swap)()}))})),Mi(nT.transform(),(function(t,n){return s(t,n.event.transform,p)})),Mi(nT.tempTransform(),(function(t,n){return function(t,n){var o=e.getTempState().blob;c(t,o,n,(function(t){return e.addTempState(t)}),p)}(t,n.event.transform)})),Mi(nT.transformApply(),(function(t,n){return function(t,n,o){var r=e.getBlobState().blob;c(t,r,n,(function(n){var o=e.addBlobState(n);return f(t),o}),o)}(t,n.event.transform,n.event.swap)})),Mi(nT.swap(),(function(t,n){!function(t){d.updateButtonUndoStates(t,!1,!1)}(t);var e=n.event.transform,o=n.event.swap;e.fold((function(){o()}),(function(n){s(t,n,o)}))}))]),cO()])}},xT=function(t){return!yt(t,"items")},wT="data-value",ST=function(t,n,e,o){return U(e,(function(e){return xT(e)?{type:"togglemenuitem",text:e.text,value:e.value,active:e.value===o,onAction:function(){Sl.setValue(t,e.value),Ci(t,iS,{name:n}),sp.focus(t)}}:{type:"nestedmenuitem",text:e.text,getSubmenuItems:function(){return ST(t,n,e.items,o)}}}))},kT=function(t,n){return ct(t,(function(t){return xT(t)?Ct(t.value===n,t):kT(t.items,n)}))},CT=_d({name:"HtmlSelect",configFields:[jo("options"),kl("selectBehaviours",[sp,Sl]),ur("selectClasses",[]),ur("selectAttributes",{}),Qo("data")],factory:function(t,n){var e=U(t.options,(function(t){return{dom:{tag:"option",value:t.value,innerHtml:t.text}}})),o=t.data.map((function(t){return yr("initialValue",t)})).getOr({});return{uid:t.uid,dom:{tag:"select",classes:t.selectClasses,attributes:t.selectAttributes},components:e,behaviours:Ol(t.selectBehaviours,[sp.config({}),Sl.config({store:T({mode:"manual",getValue:function(t){return Pu(t.element)},setValue:function(n,e){Y(t.options,(function(t){return t.value===e})).isSome()&&Vu(n.element,e)}},o)})])}}}),OT=function(t,n){var e=t.label.map((function(t){return rS(t,n)})),o=[Gd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Wy(),$g.config({mode:"execution",useEnter:!0!==t.multiline,useControlEnter:!0===t.multiline,execute:function(t){return ki(t,sS),F.some(!0)}}),rp("textfield-change",[Mi(jr(),(function(n,e){Ci(n,iS,{name:t.name})})),Mi(ti(),(function(n,e){Ci(n,iS,{name:t.name})}))]),Zw.config({})],r=t.validation.map((function(t){return VS.config({getRoot:function(t){return wn(t.element)},invalidClass:"tox-invalid",validator:{validate:function(n){var e=Sl.getValue(n),o=t.validator(e);return ES(!0===o?He.value(e):He.error(o))},validateOnLoad:t.validateOnLoad}})})).toArray(),i=t.placeholder.fold(b({}),(function(t){return{placeholder:n.translate(t)}})),u=t.inputMode.fold(b({}),(function(t){return{inputmode:t}})),a=T(T({},i),u),c=Jw.parts.field({tag:!0===t.multiline?"textarea":"input",inputAttributes:a,inputClasses:[t.classname],inputBehaviours:gc(J([o,r])),selectOnFocus:!1,factory:bS}),s=(t.flex?["tox-form__group--stretched"]:[]).concat(t.maximized?["tox-form-group--maximize"]:[]),f=[Gd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Jw.getField(t).each(Gd.disable)},onEnabled:function(t){Jw.getField(t).each(Gd.enable)}}),Wy()];return nS(e,c,s,f)},_T=Object.freeze({__proto__:null,events:function(t,n){var e=t.stream.streams.setup(t,n);return Di([Mi(t.event,e),zi((function(){return n.cancel()}))].concat(t.cancelEvent.map((function(t){return[Mi(t,(function(){return n.cancel()}))]})).getOr([])))}}),TT=function(t){var n=pr(null);return pu({readState:function(){return{timer:null!==n.get()?"set":"unset"}},setTimer:function(t){n.set(t)},cancel:function(){var t=n.get();null!==t&&t.cancel()}})},ET=Object.freeze({__proto__:null,throttle:TT,init:function(t){return t.stream.streams.state(t)}}),DT=[Wo("stream",Ho("mode",{throttle:[jo("delay"),ur("stopEvent",!0),Oa("streams",{setup:function(t,n){var e=t.stream,o=Bv(t.onStream,e.delay);return n.setTimer(o),function(t,n){o.throttle(t,n),e.stopEvent&&n.stop()}},state:TT})]})),ur("event","input"),Qo("cancelEvent"),ka("onStream")],AT=hc({fields:DT,name:"streaming",active:_T,state:ET}),BT=function(t,n,e){var o=Sl.getValue(e);Sl.setValue(n,o),FT(n)},MT=function(t,n){var e=t.element,o=Pu(e),r=e.dom;"number"!==zn(e,"type")&&n(r,o)},FT=function(t){MT(t,(function(t,n){return t.setSelectionRange(n.length,n.length)}))},IT=function(t,n,e){if(t.selectsOver){var o=Sl.getValue(n),r=t.getDisplayText(o),i=Sl.getValue(e);return 0===t.getDisplayText(i).indexOf(r)?F.some((function(){BT(0,n,e),function(t,n){MT(t,(function(t,e){return t.setSelectionRange(n,e.length)}))}(n,r.length)})):F.none()}return F.none()},RT=b("alloy.typeahead.itemexecute"),NT=b([Qo("lazySink"),jo("fetch"),ur("minChars",5),ur("responseTime",1e3),wa("onOpen"),ur("getHotspot",F.some),ur("getAnchorOverrides",b({})),ur("layouts",F.none()),ur("eventOrder",{}),gr("model",{},[ur("getDisplayText",(function(t){return void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.value})),ur("selectsOver",!0),ur("populateFromBrowse",!0)]),wa("onSetValue"),Sa("onExecute"),wa("onItemExecute"),ur("inputClasses",[]),ur("inputAttributes",{}),ur("inputStyles",{}),ur("matchWidth",!0),ur("useMinWidth",!1),ur("dismissOnBlur",!0),ya(["openClass"]),Qo("initialData"),kl("typeaheadBehaviours",[sp,Sl,AT,$g,wp,US]),zo("previewing",(function(){return pr(!0)}))].concat(gS()).concat(nk())),PT=b([Zl({schema:[ba()],name:"menu",overrides:function(t){return{fakeFocus:!0,onHighlight:function(n,e){t.previewing.get()?n.getSystem().getByUid(t.uid).each((function(o){IT(t.model,o,e).fold((function(){return em.dehighlight(n,e)}),(function(t){return t()}))})):n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&BT(t.model,n,e)})),t.previewing.set(!1)},onExecute:function(n,e){return n.getSystem().getByUid(t.uid).toOptional().map((function(t){return Ci(t,RT(),{item:e}),!0}))},onHover:function(n,e){t.previewing.set(!1),n.getSystem().getByUid(t.uid).each((function(n){t.model.populateFromBrowse&&BT(t.model,n,e)}))}}}})]),VT=Td({name:"Typeahead",configFields:NT(),partFields:PT(),factory:function(t,n,e,o){var r=function(n,e,r){t.previewing.set(!1);var i=US.getCoupled(n,"sandbox");if(el.isOpen(i))Bd.getCurrent(i).each((function(t){em.getHighlighted(t).fold((function(){r(t)}),(function(){Ei(i,t.element,"keydown",e)}))}));else{qS(t,u(n),n,i,o,(function(t){Bd.getCurrent(t).each(r)}),wS.HighlightFirst).get(p)}},i=pS(t),u=function(t){return function(n){return n.map((function(n){var e=vt(n.menus),o=$(e,(function(t){return G(t.items,(function(t){return"item"===t.type}))}));return Sl.getState(t).update(U(o,(function(t){return t.data}))),n}))}},a=[sp.config({}),Sl.config({onSetValue:t.onSetValue,store:T({mode:"dataset",getDataKey:function(t){return Pu(t.element)},getFallbackEntry:function(t){return{value:t,meta:{}}},setValue:function(n,e){Vu(n.element,t.model.getDisplayText(e))}},t.initialData.map((function(t){return yr("initialValue",t)})).getOr({}))}),AT.config({stream:{mode:"throttle",delay:t.responseTime,stopEvent:!1},onStream:function(n,e){var r=US.getCoupled(n,"sandbox");if(sp.isFocused(n)&&Pu(n.element).length>=t.minChars){var i=Bd.getCurrent(r).bind((function(t){return em.getHighlighted(t).map(Sl.getValue)}));t.previewing.set(!0);qS(t,u(n),n,r,o,(function(n){Bd.getCurrent(r).each((function(n){i.fold((function(){t.model.selectsOver&&em.highlightFirst(n)}),(function(t){em.highlightBy(n,(function(n){return Sl.getValue(n).value===t.value})),em.getHighlighted(n).orThunk((function(){return em.highlightFirst(n),F.none()}))}))}))}),wS.HighlightFirst).get(p)}},cancelEvent:ai()}),$g.config({mode:"special",onDown:function(t,n){return r(t,n,em.highlightFirst),F.some(!0)},onEscape:function(t){var n=US.getCoupled(t,"sandbox");return el.isOpen(n)?(el.close(n),F.some(!0)):F.none()},onUp:function(t,n){return r(t,n,em.highlightLast),F.some(!0)},onEnter:function(n){var e=US.getCoupled(n,"sandbox"),o=el.isOpen(e);if(o&&!t.previewing.get())return Bd.getCurrent(e).bind((function(t){return em.getHighlighted(t)})).map((function(t){return Ci(n,RT(),{item:t}),!0}));var r=Sl.getValue(n);return ki(n,ai()),t.onExecute(e,n,r),o&&el.close(e),F.some(!0)}}),wp.config({toggleClass:t.markers.openClass,aria:{mode:"expanded"}}),US.config({others:{sandbox:function(n){return ZS(t,n,{onOpen:function(){return wp.on(n)},onClose:function(){return wp.off(n)}})}}}),rp("typeaheadevents",[ji((function(n){var e=p;KS(t,u(n),n,o,e,wS.HighlightFirst).get(p)})),Mi(RT(),(function(n,e){var o=US.getCoupled(n,"sandbox");BT(t.model,n,e.event.item),ki(n,ai()),t.onItemExecute(n,o,e.event.item,Sl.getValue(n)),el.close(o),FT(n)}))].concat(t.dismissOnBlur?[Mi(Zr(),(function(t){var n=US.getCoupled(t,"sandbox");_c(n.element).isNone()&&el.close(n)}))]:[]))];return{uid:t.uid,dom:vS(eo(t,{inputAttributes:{role:"combobox","aria-autocomplete":"list","aria-haspopup":"true"}})),behaviours:T(T({},i),Ol(t.typeaheadBehaviours,a)),eventOrder:t.eventOrder}}}),HT=function(t){return T(T({},t),{toCached:function(){return HT(t.toCached())},bindFuture:function(n){return HT(t.bind((function(t){return t.fold((function(t){return ES(He.error(t))}),(function(t){return n(t)}))})))},bindResult:function(n){return HT(t.map((function(t){return t.bind(n)})))},mapResult:function(n){return HT(t.map((function(t){return t.map(n)})))},mapError:function(n){return HT(t.map((function(t){return t.mapError(n)})))},foldResult:function(n,e){return t.map((function(t){return t.fold(n,e)}))},withTimeout:function(n,e){return HT(TS((function(o){var r=!1,i=setTimeout((function(){r=!0,o(He.error(e()))}),n);t.get((function(t){r||(clearTimeout(i),o(t))}))})))}})},LT=function(t){return HT(TS(t))},zT=LT,UT={type:"separator"},jT=function(t){return{type:"menuitem",value:t.url,text:t.title,meta:{attach:t.attach},onAction:p}},WT=function(t,n){return{type:"menuitem",value:n,text:t,meta:{attach:void 0},onAction:p}},GT=function(t,n){return function(t){return U(t,jT)}(function(t,n){return G(n,(function(n){return n.type===t}))}(t,n))},XT=function(t){return GT("header",t.targets)},qT=function(t){return GT("anchor",t.targets)},YT=function(t){return F.from(t.anchorTop).map((function(t){return WT("<top>",t)})).toArray()},KT=function(t){return F.from(t.anchorBottom).map((function(t){return WT("<bottom>",t)})).toArray()},JT=function(t,n){var e=t.toLowerCase();return G(n,(function(t){var n=void 0!==t.meta&&void 0!==t.meta.text?t.meta.text:t.text;return _t(n.toLowerCase(),e)||_t(t.value.toLowerCase(),e)}))},$T=function(t,n,e){var o=Sl.getValue(n),r=void 0!==o.meta.text?o.meta.text:o.value;return e.getLinkInformation().fold((function(){return[]}),(function(n){var o=JT(r,function(t){return U(t,(function(t){return WT(t,t)}))}(e.getHistory(t)));return"file"===t?function(t){return q(t,(function(t,n){return 0===t.length||0===n.length?t.concat(n):t.concat(UT,n)}),[])}([o,JT(r,XT(n)),JT(r,J([YT(n),qT(n),KT(n)]))]):o}))},QT=Qi("aria-invalid"),ZT=function(t){return function(n,e,o){return bt(e,"name").fold((function(){return t(e,o)}),(function(r){return n.field(r,t(e,o))}))}},tE={bar:ZT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-bar","tox-form__controls-h-stack"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),collection:ZT((function(t,n){return function(t,n){var e,o=t.label.map((function(t){return rS(t,n)})),r=function(t){return function(n,e){ra(e.event.target,"[data-collection-item-value]").each((function(o){t(n,e,o,zn(o,"data-collection-item-value"))}))}},i=function(e,o){var r=U(o,(function(e){var o=hv.translate(e.text),r=1===t.columns?'<div class="tox-collection__item-label">'+o+"</div>":"",i='<div class="tox-collection__item-icon">'+e.icon+"</div>",u={_:" "," - ":" ","-":" "},a=o.replace(/\_| \- |\-/g,(function(t){return u[t]}));return'<div class="tox-collection__item'+(n.isDisabled()?" tox-collection__item--state-disabled":"")+'" tabindex="-1" data-collection-item-value="'+tS.encodeAllRaw(e.value)+'" title="'+a+'" aria-label="'+a+'">'+i+r+"</div>"})),i="auto"!==t.columns&&t.columns>1?z(r,t.columns):[r],u=U(i,(function(t){return'<div class="tox-collection__group">'+t.join("")+"</div>"}));Gi(e.element,u.join(""))},u=r((function(e,o,r,i){o.stop(),n.isDisabled()||Ci(e,cS,{name:t.name,value:i})})),a=[Mi(Vr(),r((function(t,n,e){kc(e)}))),Mi(Gr(),u),Mi(ri(),u),Mi(Hr(),r((function(t,n,e){oa(t.element,"."+kb).each((function(t){Fu(t,kb)})),Bu(e,kb)}))),Mi(Lr(),r((function(t){oa(t.element,"."+kb).each((function(t){Fu(t,kb)}))}))),ji(r((function(n,e,o,r){Ci(n,cS,{name:t.name,value:r})})))],c=function(t,n){return U(Zs(t.element,".tox-collection__item"),n)},s=Jw.parts.field({dom:{tag:"div",classes:["tox-collection"].concat(1!==t.columns?["tox-collection--grid"]:["tox-collection--list"])},components:[],factory:{sketch:y},behaviours:gc([Gd.config({disabled:n.isDisabled,onDisabled:function(t){c(t,(function(t){Bu(t,"tox-collection__item--state-disabled"),Hn(t,"aria-disabled",!0)}))},onEnabled:function(t){c(t,(function(t){Fu(t,"tox-collection__item--state-disabled"),Wn(t,"aria-disabled")}))}}),Wy(),op.config({}),Sl.config({store:{mode:"memory",initialValue:[]},onSetValue:function(n,e){i(n,e),"auto"===t.columns&&ey(n,5,"tox-collection__item").each((function(t){var e=t.numRows,o=t.numColumns;$g.setGridSize(n,e,o)})),ki(n,mS)}}),Zw.config({}),$g.config(dw(t.columns,"normal")),rp("collection-events",a)]),eventOrder:(e={},e[ei()]=["disabling","alloy.base.behaviour","collection-events"],e)});return nS(o,s,["tox-form__group--collection"],[])}(t,n.shared.providers)})),alertbanner:ZT((function(t,n){return function(t,n){return Xw.sketch({dom:{tag:"div",attributes:{role:"alert"},classes:["tox-notification","tox-notification--in","tox-notification--"+t.level]},components:[{dom:{tag:"div",classes:["tox-notification__icon"]},components:[mh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--naked","tox-button--icon"],innerHtml:Sv(t.icon,n.icons),attributes:{title:n.translate(t.iconTooltip)}},action:function(n){Ci(n,cS,{name:"alert-banner",value:t.url})},buttonBehaviours:gc([kv()])})]},{dom:{tag:"div",classes:["tox-notification__body"],innerHtml:n.translate(t.text)}}]})}(t,n.shared.providers)})),input:ZT((function(t,n){return function(t,n){return OT({name:t.name,multiline:!1,label:t.label,inputMode:t.inputMode,placeholder:t.placeholder,flex:!1,disabled:t.disabled,classname:"tox-textfield",validation:F.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),textarea:ZT((function(t,n){return function(t,n){return OT({name:t.name,multiline:!0,label:t.label,inputMode:F.none(),placeholder:t.placeholder,flex:!0,disabled:t.disabled,classname:"tox-textarea",validation:F.none(),maximized:t.maximized},n)}(t,n.shared.providers)})),label:ZT((function(t,n){return function(t,n){var e={dom:{tag:"label",innerHtml:n.providers.translate(t.label),classes:["tox-label"]}},o=U(t.items,n.interpreter);return{dom:{tag:"div",classes:["tox-form__group"]},components:[e].concat(o),behaviours:gc([cO(),op.config({}),xO(F.none()),$g.config({mode:"acyclic"})])}}(t,n.shared)})),iframe:function(t){return function(n,e,o){var r=eo(e,{source:"dynamic"});return ZT(t)(n,r,o)}}((function(t,n){return BO(t,n.shared.providers)})),button:ZT((function(t,n){return G_(t,n.shared.providers)})),checkbox:ZT((function(t,n){return function(t,n){var e=Sl.config({store:{mode:"manual",getValue:function(t){return t.element.dom.checked},setValue:function(t,n){t.element.dom.checked=n}}}),o=function(t){return t.element.dom.click(),F.some(!0)},r=Jw.parts.field({factory:{sketch:y},dom:{tag:"input",classes:["tox-checkbox__input"],attributes:{type:"checkbox"}},behaviours:gc([cO(),Gd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Zw.config({}),sp.config({}),e,$g.config({mode:"special",onEnter:o,onSpace:o,stopSpaceKeyup:!0}),rp("checkbox-events",[Mi(Wr(),(function(n,e){Ci(n,iS,{name:t.name})}))])])}),i=Jw.parts.label({dom:{tag:"span",classes:["tox-checkbox__label"],innerHtml:n.translate(t.label)},behaviours:gc([uk.config({})])}),u=function(t){return Ov("checked"===t?"selected":"unselected",{tag:"span",classes:["tox-icon","tox-checkbox-icon__"+t]},n.icons)},a=ph({dom:{tag:"div",classes:["tox-checkbox__icons"]},components:[u("checked"),u("unchecked")]});return Jw.sketch({dom:{tag:"label",classes:["tox-checkbox"]},components:[r,a.asSpec(),i],fieldBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()},disableClass:"tox-checkbox--disabled",onDisabled:function(t){Jw.getField(t).each(Gd.disable)},onEnabled:function(t){Jw.getField(t).each(Gd.enable)}}),Wy()])})}(t,n.shared.providers)})),colorinput:ZT((function(t,n){return fk(t,n.shared,n.colorinput)})),colorpicker:ZT((function(t){var n=function(t){return"tox-"+t},e=aO(dO,n),o=ph(e.sketch({dom:{tag:"div",classes:[n("color-picker-container")],attributes:{role:"presentation"}},onValidHex:function(t){Ci(t,cS,{name:"hex-valid",value:!0})},onInvalidHex:function(t){Ci(t,cS,{name:"hex-valid",value:!1})}}));return{dom:{tag:"div"},components:[o.asSpec()],behaviours:gc([Sl.config({store:{mode:"manual",getValue:function(t){var n=o.get(t);return Bd.getCurrent(n).bind((function(t){return Sl.getValue(t).hex})).map((function(t){return"#"+t})).getOr("")},setValue:function(t,n){var e=/^#([a-fA-F0-9]{3}(?:[a-fA-F0-9]{3})?)/.exec(n),r=o.get(t);Bd.getCurrent(r).fold((function(){console.log("Can not find form")}),(function(t){Sl.setValue(t,{hex:F.from(e[1]).getOr("")}),tO.getField(t,"hex").each((function(t){ki(t,jr())}))}))}}}),cO()])}})),dropzone:ZT((function(t,n){return SO(t,n.shared.providers)})),grid:ZT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:["tox-form__grid","tox-form__grid--"+t.columns+"col"]},components:U(t.items,n.interpreter)}}(t,n.shared)})),listbox:ZT((function(t,n){return function(t,n){var e=n.shared.providers,o=it(t.items).filter(xT),r=t.label.map((function(t){return rS(t,e)})),i={dom:{tag:"div",classes:["tox-listboxfield"]},components:[Jw.parts.field({dom:{},factory:{sketch:function(e){return E_({uid:e.uid,text:o.map((function(t){return t.text})),icon:F.none(),tooltip:t.label,role:F.none(),fetch:function(e,o){var r=ST(e,t.name,t.items,Sl.getValue(e));o(I_(r,gb.CLOSE_ON_EXECUTE,n,!1))},onSetup:b(p),getApi:b({}),columns:1,presets:"normal",classes:[],dropdownBehaviours:[Zw.config({}),Sl.config({store:{mode:"manual",initialValue:o.map((function(t){return t.value})).getOr(""),getValue:function(t){return zn(t.element,wT)},setValue:function(n,e){kT(t.items,e).each((function(t){Hn(n.element,wT,t.value),Ci(n,__,{text:t.text})}))}}})]},"tox-listbox",n.shared)}}})]};return Jw.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([r.toArray(),[i]]),fieldBehaviours:gc([Gd.config({disabled:b(t.disabled),onDisabled:function(t){Jw.getField(t).each(Gd.disable)},onEnabled:function(t){Jw.getField(t).each(Gd.enable)}})])})}(t,n)})),selectbox:ZT((function(t,n){return function(t,n){var e=U(t.items,(function(t){return{text:n.translate(t.text),value:t.value}})),o=t.label.map((function(t){return rS(t,n)})),r=Jw.parts.field({dom:{},selectAttributes:{size:t.size},options:e,factory:CT,selectBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()}}),Zw.config({}),rp("selectbox-change",[Mi(Wr(),(function(n,e){Ci(n,iS,{name:t.name})}))])])}),i=t.size>1?F.none():F.some(Ov("chevron-down",{tag:"div",classes:["tox-selectfield__icon-js"]},n.icons)),u={dom:{tag:"div",classes:["tox-selectfield"]},components:J([[r],i.toArray()])};return Jw.sketch({dom:{tag:"div",classes:["tox-form__group"]},components:J([o.toArray(),[u]]),fieldBehaviours:gc([Gd.config({disabled:function(){return t.disabled||n.isDisabled()},onDisabled:function(t){Jw.getField(t).each(Gd.disable)},onEnabled:function(t){Jw.getField(t).each(Gd.enable)}}),Wy()])})}(t,n.shared.providers)})),sizeinput:ZT((function(t,n){return tT(t,n.shared.providers)})),urlinput:ZT((function(t,n){return function(t,n,e){var o,r=n.shared.providers,i=function(n){var o=Sl.getValue(n);e.addToHistory(o.value,t.filetype)},u=Jw.parts.field({factory:VT,dismissOnBlur:!0,inputClasses:["tox-textfield"],sandboxClasses:["tox-dialog__popups"],inputAttributes:{"aria-errormessage":QT,type:"url"},minChars:0,responseTime:0,fetch:function(o){var r=$T(t.filetype,o,e),i=I_(r,gb.BUBBLE_TO_SANDBOX,n,!1);return ES(i)},getHotspot:function(t){return d.getOpt(t)},onSetValue:function(t,n){t.hasConfigured(VS)&&VS.run(t).get(p)},typeaheadBehaviours:gc(J([e.getValidationHandler().map((function(n){return VS.config({getRoot:function(t){return wn(t.element)},invalidClass:"tox-control-wrap--status-invalid",notify:{onInvalid:function(t,n){c.getOpt(t).each((function(t){Hn(t.element,"title",r.translate(n))}))}},validator:{validate:function(e){var o=Sl.getValue(e);return zT((function(e){n({type:t.filetype,url:o.value},(function(t){if("invalid"===t.status){var n=He.error(t.message);e(n)}else{var o=He.value(t.message);e(o)}}))}))},validateOnLoad:!1}})})).toArray(),[Gd.config({disabled:function(){return t.disabled||r.isDisabled()}}),Zw.config({}),rp("urlinput-events",J(["file"===t.filetype?[Mi(jr(),(function(n){Ci(n,iS,{name:t.name})}))]:[],[Mi(Wr(),(function(n){Ci(n,iS,{name:t.name}),i(n)})),Mi(ti(),(function(n){Ci(n,iS,{name:t.name}),i(n)}))]]))]])),eventOrder:(o={},o[jr()]=["streaming","urlinput-events","invalidating"],o),model:{getDisplayText:function(t){return t.value},selectsOver:!1,populateFromBrowse:!1},markers:{openClass:"tox-textfield--popup-open"},lazySink:n.shared.getSink,parts:{menu:Mb(0,0,"normal")},onExecute:function(t,n,e){Ci(n,sS,{})},onItemExecute:function(n,e,o,r){i(n),Ci(n,iS,{name:t.name})}}),a=t.label.map((function(t){return rS(t,r)})),c=ph(function(t,n,e,o){return void 0===e&&(e=t),void 0===o&&(o=t),Ov(e,{tag:"div",classes:["tox-icon","tox-control-wrap__status-icon-"+t],attributes:T({title:r.translate(o),"aria-live":"polite"},n.fold((function(){return{}}),(function(t){return{id:t}})))},r.icons)}("invalid",F.some(QT),"warning")),s=ph({dom:{tag:"div",classes:["tox-control-wrap__status-icon-wrap"]},components:[c.asSpec()]}),f=e.getUrlPicker(t.filetype),l=Qi("browser.url.event"),d=ph({dom:{tag:"div",classes:["tox-control-wrap"]},components:[u,s.asSpec()],behaviours:gc([Gd.config({disabled:function(){return t.disabled||r.isDisabled()}})])}),m=ph(U_({name:t.name,icon:F.some("browse"),text:t.label.getOr(""),disabled:t.disabled,primary:!1,borderless:!0},(function(t){return ki(t,l)}),r,[],["tox-browse-url"]));return Jw.sketch({dom:oS([]),components:a.toArray().concat([{dom:{tag:"div",classes:["tox-form__controls-h-stack"]},components:J([[d.asSpec()],f.map((function(){return m.asSpec()})).toArray()])}]),fieldBehaviours:gc([Gd.config({disabled:function(){return t.disabled||r.isDisabled()},onDisabled:function(t){Jw.getField(t).each(Gd.disable),m.getOpt(t).each(Gd.disable)},onEnabled:function(t){Jw.getField(t).each(Gd.enable),m.getOpt(t).each(Gd.enable)}}),Wy(),rp("url-input-events",[Mi(l,(function(n){Bd.getCurrent(n).each((function(e){var o=Sl.getValue(e),r=T({fieldname:t.name},o);f.each((function(o){o(r).get((function(o){Sl.setValue(e,o),Ci(n,iS,{name:t.name})}))}))}))}))])])})}(t,n,n.urlinput)})),customeditor:ZT((function(t){var n=qc(),e=ph({dom:{tag:t.tag}}),o=qc();return{dom:{tag:"div",classes:["tox-custom-editor"]},behaviours:gc([rp("custom-editor-events",[Li((function(r){e.getOpt(r).each((function(e){(!function(t){return yt(t,"init")}(t)?mO.load(t.scriptId,t.scriptUrl).then((function(n){return n(e.element.dom,t.settings)})):t.init(e.element.dom)).then((function(t){o.on((function(n){t.setValue(n)})),o.clear(),n.set(t)}))}))}))]),Sl.config({store:{mode:"manual",getValue:function(){return n.get().fold((function(){return o.get().getOr("")}),(function(t){return t.getValue()}))},setValue:function(t,e){n.get().fold((function(){o.set(e)}),(function(t){return t.setValue(e)}))}}}),cO()]),components:[e.asSpec()]}})),htmlpanel:ZT((function(t){return"presentation"===t.presets?Xw.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html}}):Xw.sketch({dom:{tag:"div",classes:["tox-form__group"],innerHtml:t.html,attributes:{role:"document"}},containerBehaviours:gc([Zw.config({}),sp.config({})])})})),imagetools:ZT((function(t,n){return yT(t,n.shared.providers)})),table:ZT((function(t,n){return function(t,n){var e=function(t){return{dom:{tag:"th",innerHtml:n.translate(t)}}},o=function(t){return{dom:{tag:"td",innerHtml:n.translate(t)}}},r=function(t){return{dom:{tag:"tr"},components:U(t,o)}};return{dom:{tag:"table",classes:["tox-dialog__table"]},components:[function(t){return{dom:{tag:"thead"},components:[{dom:{tag:"tr"},components:U(t,e)}]}}(t.header),function(t){return{dom:{tag:"tbody"},components:U(t,r)}}(t.cells)],behaviours:gc([Zw.config({}),sp.config({})])}}(t,n.shared.providers)})),panel:ZT((function(t,n){return function(t,n){return{dom:{tag:"div",classes:t.classes},components:U(t.items,n.shared.interpreter)}}(t,n)}))},nE={field:function(t,n){return n}},eE=function(t,n,e){var o=eo(e,{shared:{interpreter:function(n){return oE(t,n,o)}}});return oE(t,n,o)},oE=function(t,n,e){return bt(tE,n.type).fold((function(){return console.error('Unknown factory type "'+n.type+'", defaulting to container: ',n),n}),(function(o){return o(t,n,e)}))},rE={valignCentre:[],alignCentre:[],alignLeft:[],alignRight:[],right:[],left:[],bottom:[],top:[]},iE=function(t,n,e){var o={maxHeightFunction:ss()};return function(){return e()?{type:"node",root:Bn(t()),node:F.from(t()),bubble:ms(12,12,rE),layouts:{onRtl:function(){return[oh]},onLtr:function(){return[eh]}},overrides:o}:{type:"hotspot",hotspot:n(),bubble:ms(-12,12,rE),layouts:{onRtl:function(){return[Ya]},onLtr:function(){return[Ka]}},overrides:o}}},uE=function(t,n,e){return function(){return e()?{type:"node",root:Bn(t()),node:F.from(t()),layouts:{onRtl:function(){return[rh]},onLtr:function(){return[rh]}}}:{type:"hotspot",hotspot:n(),layouts:{onRtl:function(){return[Za]},onLtr:function(){return[Za]}}}}},aE=function(t,n){return function(){return{type:"selection",root:n(),getSelection:function(){var n=t.selection.getRng();return F.some(Hs.range(Ft.fromDom(n.startContainer),n.startOffset,Ft.fromDom(n.endContainer),n.endOffset))}}}},cE=function(t){return function(n){return{type:"node",root:t(),node:n}}},sE=function(t,n,e){var o=My(t),r=function(){return Ft.fromDom(t.getBody())},i=function(){return Ft.fromDom(t.getContentAreaContainer())},u=function(){return o||!e()};return{inlineDialog:iE(i,n,u),banner:uE(i,n,u),cursor:aE(t,r),node:cE(r)}},fE=function(t){return function(n,e){cw(t)(n,e)}},lE=function(t){return function(){return Jx(t)}},dE=function(t){return function(){return $x(t)}},mE=function(t){return function(){return tw(t)}},gE=function(t){return{colorPicker:fE(t),hasCustomColors:lE(t),getColors:dE(t),getColorCols:mE(t)}},pE=function(t){return function(){return function(t){return t.getParam("draggable_modal",!1,"boolean")}(t)}},hE=function(t){return{isDraggableModal:pE(t)}},vE=[{title:"Headings",items:[{title:"Heading 1",format:"h1"},{title:"Heading 2",format:"h2"},{title:"Heading 3",format:"h3"},{title:"Heading 4",format:"h4"},{title:"Heading 5",format:"h5"},{title:"Heading 6",format:"h6"}]},{title:"Inline",items:[{title:"Bold",format:"bold"},{title:"Italic",format:"italic"},{title:"Underline",format:"underline"},{title:"Strikethrough",format:"strikethrough"},{title:"Superscript",format:"superscript"},{title:"Subscript",format:"subscript"},{title:"Code",format:"code"}]},{title:"Blocks",items:[{title:"Paragraph",format:"p"},{title:"Blockquote",format:"blockquote"},{title:"Div",format:"div"},{title:"Pre",format:"pre"}]},{title:"Align",items:[{title:"Left",format:"alignleft"},{title:"Center",format:"aligncenter"},{title:"Right",format:"alignright"},{title:"Justify",format:"alignjustify"}]}],bE=function(t){return q(t,(function(t,n){if(function(t){return yt(t,"items")}(n)){var e=bE(n.items);return{customFormats:t.customFormats.concat(e.customFormats),formats:t.formats.concat([{title:n.title,items:e.formats}])}}if(function(t){return yt(t,"inline")}(n)||function(t){return yt(t,"block")}(n)||function(t){return yt(t,"selector")}(n)){var o="custom-"+(r(n.name)?n.name:n.title.toLowerCase());return{customFormats:t.customFormats.concat([{name:o,format:n}]),formats:t.formats.concat([{title:n.title,format:o,icon:n.icon}])}}return T(T({},t),{formats:t.formats.concat(n)})}),{customFormats:[],formats:[]})},yE=function(t){return function(t){return F.from(t.getParam("style_formats")).filter(u)}(t).map((function(n){var e=function(t,n){var e=bE(n),o=function(n){j(n,(function(n){t.formatter.has(n.name)||t.formatter.register(n.name,n.format)}))};return t.formatter?o(e.customFormats):t.on("init",(function(){o(e.customFormats)})),e.formats}(t,n);return function(t){return t.getParam("style_formats_merge",!1,"boolean")}(t)?vE.concat(e):e})).getOr(vE)},xE=function(t,n,e){var o={type:"formatter",isSelected:n(t.format),getStylePreview:e(t.format)};return eo(t,o)},wE=function(t,n,e,o){var i=function(t){return xE(t,e,o)},u=function(n){var i=r(n.name)?n.name:Qi(n.title),u="custom-"+i,a={type:"formatter",format:u,isSelected:e(u),getStylePreview:o(u)},c=eo(n,a);return t.formatter.register(i,c),c},a=function(t){return U(t,(function(t){var n=st(t);if(xt(t,"items")){var e=a(t.items);return eo(function(t){return eo(t,{type:"submenu"})}(t),{getStyleItems:b(e)})}return xt(t,"format")?i(t):1===n.length&&V(n,"title")?eo(t,{type:"separator"}):u(t)}))};return a(n)},SE=function(t){var n=function(n){return function(){return t.formatter.match(n)}},e=function(n){return function(){var e=t.formatter.get(n);return void 0!==e?F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):F.none()}},o=function(t){var n=t.items;return void 0!==n&&n.length>0?$(n,o):[t.format]},r=pr([]),i=pr([]),u=pr([]),a=pr([]),c=pr(!1);t.on("PreInit",(function(u){var a=yE(t),c=wE(t,a,n,e);r.set(c),i.set($(c,o))})),t.on("addStyleModifications",(function(r){var i=wE(t,r.items,n,e);u.set(i),c.set(r.replace),a.set($(i,o))}));return{getData:function(){var t=c.get()?[]:r.get(),n=u.get();return t.concat(n)},getFlattenedKeys:function(){var t=c.get()?[]:i.get(),n=a.get();return t.concat(n)}}},kE=gO.trim,CE=function(t){return function(n){if(function(t){return l(t)&&1===t.nodeType}(n)){if(n.contentEditable===t)return!0;if(n.getAttribute("data-mce-contenteditable")===t)return!0}return!1}},OE=CE("true"),_E=CE("false"),TE=function(t,n,e,o,r){return{type:t,title:n,url:e,level:o,attach:r}},EE=function(t){return t.innerText||t.textContent},DE=function(t){return function(t){return t&&"A"===t.nodeName&&void 0!==(t.id||t.name)}(t)&&BE(t)},AE=function(t){return t&&/^(H[1-6])$/.test(t.nodeName)},BE=function(t){return function(t){for(;t=t.parentNode;){var n=t.contentEditable;if(n&&"inherit"!==n)return OE(t)}return!1}(t)&&!_E(t)},ME=function(t){return AE(t)&&BE(t)},FE=function(t){var n=function(t){return t.id?t.id:Qi("h")}(t);return TE("header",EE(t),"#"+n,function(t){return AE(t)?parseInt(t.nodeName.substr(1),10):0}(t),(function(){t.id=n}))},IE=function(t){var n=t.id||t.name,e=EE(t);return TE("anchor",e||"#"+n,"#"+n,0,p)},RE=function(t){return function(t,n){return U(Zs(Ft.fromDom(n),t),(function(t){return t.dom}))}("h1,h2,h3,h4,h5,h6,a:not([href])",t)},NE=function(t){return kE(t.title).length>0},PE=function(t){var n=RE(t);return G(function(t){return U(G(t,ME),FE)}(n).concat(function(t){return U(G(t,DE),IE)}(n)),NE)},VE="tinymce-url-history",HE=function(t){return r(t)&&/^https?/.test(t)},LE=function(t){return i(t)&&ht(t,(function(t){return!function(t){return u(t)&&t.length<=5&&Q(t,HE)}(t)})).isNone()},zE=function(){var t,n=Wx.getItem(VE);if(null===n)return{};try{t=JSON.parse(n)}catch(t){if(t instanceof SyntaxError)return console.log("Local storage "+VE+" was not valid JSON",t),{};throw t}return LE(t)?t:(console.log("Local storage "+VE+" was not valid format",t),{})},UE=function(t){var n=zE();return bt(n,t).getOr([])},jE=function(t,n){if(HE(t)){var e=zE(),o=bt(e,n).getOr([]),r=G(o,(function(n){return n!==t}));e[n]=[t].concat(r).slice(0,5),function(t){if(!LE(t))throw new Error("Bad format for history:\n"+JSON.stringify(t));Wx.setItem(VE,JSON.stringify(t))}(e)}},WE=function(t){return!!t},GE=function(t){return dt(gO.makeMap(t,/[, ]/),WE)},XE=function(t){return F.from(function(t){return t.getParam("file_picker_callback")}(t)).filter(d)},qE=function(t,n){var e=function(t){var n=F.some(function(t){return t.getParam("file_picker_types")}(t)).filter(WE),e=F.some(function(t){return t.getParam("file_browser_callback_types")}(t)).filter(WE),o=n.or(e).map(GE);return XE(t).fold(C,(function(t){return o.fold(O,(function(t){return st(t).length>0&&t}))}))}(t);return c(e)?e?XE(t):F.none():e[n]?XE(t):F.none()},YE=function(t){return F.from(t).filter(r).getOrUndefined()},KE=function(t){return{getHistory:UE,addToHistory:jE,getLinkInformation:function(){return function(t){return function(t){return!1===t.getParam("typeahead_urls")}(t)?F.none():F.some({targets:PE(t.getBody()),anchorTop:YE(Vy(t)),anchorBottom:YE(Hy(t))})}(t)},getValidationHandler:function(){return function(t){return F.from(function(t){var n=t.getParam("file_picker_validator_handler",void 0,"function");return void 0===n?t.getParam("filepicker_validator_handler",void 0,"function"):n}(t))}(t)},getUrlPicker:function(n){return function(t,n){return qE(t,n).map((function(e){return function(o){return TS((function(u){var a=T({filetype:n,fieldname:o.fieldname},F.from(o.meta).getOr({}));e.call(t,(function(t,n){if(!r(t))throw new Error("Expected value to be string");if(void 0!==n&&!i(n))throw new Error("Expected meta to be a object");u({value:t,meta:n})}),o.value,a)}))}}))}(t,n)}}},JE=function(t,n,e){var o=pr(!1),r=function(t){var n=pr(Ay(t)?"bottom":"top");return{isPositionedAtTop:function(){return"top"===n.get()},getDockingMode:n.get,setDockingMode:n.set}}(n),i={shared:{providers:{icons:function(){return n.ui.registry.getAll().icons},menuItems:function(){return n.ui.registry.getAll().menuItems},translate:hv.translate,isDisabled:function(){return n.mode.isReadOnly()||n.ui.isDisabled()},getSetting:n.getParam.bind(n)},interpreter:function(t){return function(t,n){return oE(nE,t,n)}(t,i)},anchors:sE(n,e,r.isPositionedAtTop),header:r,getSink:function(){return He.value(t)}},urlinput:KE(n),styleselect:SE(n),colorinput:gE(n),dialog:hE(n),isContextMenuOpen:function(){return o.get()},setContextMenuState:function(t){return o.set(t)}};return i},$E=function(t,n,e){var o=function(t,o){j([n,e],(function(n){n.broadcastEvent(t,o)}))},r=function(t,o){j([n,e],(function(n){n.broadcastOn([t],o)}))},i=function(t){return r(ol(),{target:t.target})},u=Sc(),a=Kc(u,"touchstart",i),c=Kc(u,"touchmove",(function(t){return o(si(),t)})),s=Kc(u,"touchend",(function(t){return o(fi(),t)})),f=Kc(u,"mousedown",i),l=Kc(u,"mouseup",(function(t){0===t.raw.button&&r(il(),{target:t.target})})),d=function(t){return r(ol(),{target:Ft.fromDom(t.target)})},m=function(t){0===t.button&&r(il(),{target:Ft.fromDom(t.target)})},g=function(){j(t.editorManager.get(),(function(n){t!==n&&n.fire("DismissPopups",{relatedTarget:t})}))},p=function(t){return o(li(),$c(t))},h=function(t){r(rl(),{}),o(di(),$c(t))},v=function(){return r(rl(),{})},b=function(n){n.state&&r(ol(),{target:Ft.fromDom(t.getContainer())})},y=function(t){r(ol(),{target:Ft.fromDom(t.relatedTarget.getContainer())})};t.on("PostRender",(function(){t.on("click",d),t.on("tap",d),t.on("mouseup",m),t.on("mousedown",g),t.on("ScrollWindow",p),t.on("ResizeWindow",h),t.on("ResizeEditor",v),t.on("AfterProgressState",b),t.on("DismissPopups",y)})),t.on("remove",(function(){t.off("click",d),t.off("tap",d),t.off("mouseup",m),t.off("mousedown",g),t.off("ScrollWindow",p),t.off("ResizeWindow",h),t.off("ResizeEditor",v),t.off("AfterProgressState",b),t.off("DismissPopups",y),f.unbind(),a.unbind(),c.unbind(),s.unbind(),l.unbind()})),t.on("detach",(function(){Gf(n),Gf(e),n.destroy(),e.destroy()}))},QE=xd,ZE=od,tD=b([ur("shell",!1),jo("makeItem"),ur("setupItem",p),_l("listBehaviours",[op])]),nD=td({name:"items",overrides:function(){return{behaviours:gc([op.config({})])}}}),eD=b([nD]),oD=b("CustomList"),rD=Td({name:oD(),configFields:tD(),partFields:eD(),factory:function(t,n,e,o){var r=t.shell?{behaviours:[op.config({})],components:[]}:{behaviours:[],components:n},i=function(n){return t.shell?F.some(n):dd(n,t,"items")};return{uid:t.uid,dom:t.dom,components:r.components,behaviours:Ol(t.listBehaviours,r.behaviours),apis:{setItems:function(n,e){i(n).fold((function(){throw console.error("Custom List was defined to not be a shell, but no item container was specified in components"),new Error("Custom List was defined to not be a shell, but no item container was specified in components")}),(function(o){var r=op.contents(o),i=e.length,u=i-r.length,a=u>0?L(u,(function(){return t.makeItem()})):[],c=r.slice(i);j(c,(function(t){return op.remove(o,t)})),j(a,(function(t){return op.append(o,t)}));var s=op.contents(o);j(s,(function(o,r){t.setupItem(n,o,e[r],r)}))}))}}}},apis:{setItems:function(t,n,e){t.setItems(n,e)}}}),iD=b([jo("dom"),ur("shell",!0),kl("toolbarBehaviours",[op])]),uD=b([td({name:"groups",overrides:function(){return{behaviours:gc([op.config({})])}}})]),aD=Td({name:"Toolbar",configFields:iD(),partFields:uD(),factory:function(t,n,e,o){var r=function(n){return t.shell?F.some(n):dd(n,t,"groups")},i=t.shell?{behaviours:[op.config({})],components:[]}:{behaviours:[],components:n};return{uid:t.uid,dom:t.dom,components:i.components,behaviours:Ol(t.toolbarBehaviours,i.behaviours),apis:{setGroups:function(t,n){r(t).fold((function(){throw console.error("Toolbar was defined to not be a shell, but no groups container was specified in components"),new Error("Toolbar was defined to not be a shell, but no groups container was specified in components")}),(function(t){op.set(t,n)}))}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)}}}),cD=p,sD=C,fD=b([]),lD=Object.freeze({__proto__:null,setup:cD,isDocked:sD,getBehaviours:fD}),dD=function(t){return(wt(Qn(t,"position"),"fixed")?F.none():Sn(t)).orThunk((function(){var n=Ft.fromTag("span");return wn(t).bind((function(t){we(t,n);var e=Sn(n);return Ce(n),e}))}))},mD=function(t){return dD(t).map(fe).getOrThunk((function(){return ce(0,0)}))},gD=hr([{static:[]},{absolute:["positionCss"]},{fixed:["positionCss"]}]),pD=function(t,n){var e=t.element;Bu(e,n.transitionClass),Fu(e,n.fadeOutClass),Bu(e,n.fadeInClass),n.onShow(t)},hD=function(t,n){var e=t.element;Bu(e,n.transitionClass),Fu(e,n.fadeInClass),Bu(e,n.fadeOutClass),n.onHide(t)},vD=function(t,n,e){return Q(t,(function(t){switch(t){case"bottom":return function(t,n){return t.bottom<=n.bottom}(n,e);case"top":return function(t,n){return t.y>=n.y}(n,e)}}))},bD=function(t,n){return n.getInitialPos().map((function(n){return Fe(n.bounds.x,n.bounds.y,me(t),ie(t))}))},yD=function(t,n,e){return e.getInitialPos().bind((function(o){switch(e.clearInitialPos(),o.position){case"static":return F.some(gD.static());case"absolute":var r=dD(t).map(Ie).getOrThunk((function(){return Ie(Nn())}));return F.some(gD.absolute(Ec("absolute",bt(o.style,"left").map((function(t){return n.x-r.x})),bt(o.style,"top").map((function(t){return n.y-r.y})),bt(o.style,"right").map((function(t){return r.right-n.right})),bt(o.style,"bottom").map((function(t){return r.bottom-n.bottom})))));default:return F.none()}}))},xD=function(t,n,e){var o=Ie(t);if(vD(e.getModes(),o,n))return F.none();!function(t,n,e){e.setInitialPos({style:Zn(t),position:Jn(t,"position")||"static",bounds:n})}(t,o,e);var r=Ne(),i=o.x-r.x,u=n.y-r.y,a=r.bottom-n.bottom,c=o.y<=n.y;return F.some(gD.fixed(Ec("fixed",F.some(i),c?F.some(u):F.none(),F.none(),c?F.none():F.some(a))))},wD=function(t,n,e){var o=t.element;return wt(Qn(o,"position"),"fixed")?function(t,n,e){return bD(t,e).filter((function(t){return vD(e.getModes(),t,n)})).bind((function(n){return yD(t,n,e)}))}(o,n,e):xD(o,n,e)},SD=function(t,n,e){e.setDocked(!1),j(["left","right","top","bottom","position"],(function(n){return ne(t.element,n)})),n.onUndocked(t)},kD=function(t,n,e,o){var r="fixed"===o.position;e.setDocked(r),Dc(t.element,o),(r?n.onDocked:n.onUndocked)(t)},CD=function(t,n,e,o,r){void 0===r&&(r=!1),n.contextual.each((function(n){n.lazyContext(t).each((function(i){var u=function(t,n){return t.y<n.bottom&&t.bottom>n.y}(i,o);if(u!==e.isVisible())if(e.setVisible(u),r&&!u)Ru(t.element,[n.fadeOutClass]),n.onHide(t);else{(u?pD:hD)(t,n)}}))}))},OD=function(t,n,e){var o=t.element;e.setDocked(!1),function(t,n){var e=t.element;return bD(e,n).bind((function(t){return yD(e,t,n)}))}(t,e).each((function(o){o.fold((function(){return SD(t,n,e)}),(function(o){return kD(t,n,e,o)}),p)})),e.setVisible(!0),n.contextual.each((function(n){Nu(o,[n.fadeInClass,n.fadeOutClass,n.transitionClass]),n.onShow(t)})),_D(t,n,e)},_D=function(t,n,e){t.getSystem().isConnected()&&function(t,n,e){var o=n.lazyViewport(t);e.isDocked()&&CD(t,n,e,o),wD(t,o,e).each((function(r){r.fold((function(){return SD(t,n,e)}),(function(o){return kD(t,n,e,o)}),(function(r){CD(t,n,e,o,!0),kD(t,n,e,r)}))}))}(t,n,e)},TD=function(t,n,e){e.isDocked()&&OD(t,n,e)},ED=Object.freeze({__proto__:null,refresh:_D,reset:TD,isDocked:function(t,n,e){return e.isDocked()},getModes:function(t,n,e){return e.getModes()},setModes:function(t,n,e,o){return e.setModes(o)}}),DD=Object.freeze({__proto__:null,events:function(t,n){return Di([Hi(qr(),(function(e,o){t.contextual.each((function(t){Iu(e.element,t.transitionClass)&&(Nu(e.element,[t.transitionClass,t.fadeInClass]),(n.isVisible()?t.onShown:t.onHidden)(e));o.stop()}))})),Mi(li(),(function(e,o){_D(e,t,n)})),Mi(di(),(function(e,o){TD(e,t,n)}))])}}),AD=[rr("contextual",[Xo("fadeInClass"),Xo("fadeOutClass"),Xo("transitionClass"),Yo("lazyContext"),wa("onShow"),wa("onShown"),wa("onHide"),wa("onHidden")]),dr("lazyViewport",Ne),mr("modes",["top","bottom"],_o),wa("onDocked"),wa("onUndocked")],BD=Object.freeze({__proto__:null,init:function(t){var n=pr(!1),e=pr(!0),o=qc(),r=pr(t.modes);return pu({isDocked:n.get,setDocked:n.set,getInitialPos:o.get,setInitialPos:o.set,clearInitialPos:o.clear,isVisible:e.get,setVisible:e.set,getModes:r.get,setModes:r.set,readState:function(){return"docked:  "+n.get()+", visible: "+e.get()+", modes: "+r.get().join(",")}})}}),MD=hc({fields:AD,name:"docking",active:DD,apis:ED,state:BD}),FD=b(Qi("toolbar-height-change")),ID={fadeInClass:"tox-editor-dock-fadein",fadeOutClass:"tox-editor-dock-fadeout",transitionClass:"tox-editor-dock-transition"},RD="tox-tinymce--toolbar-sticky-on",ND="tox-tinymce--toolbar-sticky-off",PD=function(t,n){return V(MD.getModes(t),n)},VD=function(t){var n=t.element;wn(n).each((function(e){var o="padding-"+MD.getModes(t)[0];if(MD.isDocked(t)){var r=me(e);qn(n,"width",r+"px"),qn(e,o,function(t){return ue(t)+(parseInt(Jn(t,"margin-top"),10)||0)+(parseInt(Jn(t,"margin-bottom"),10)||0)}(n)+"px")}else ne(n,"width"),ne(e,o)}))},HD=function(t,n){n?(Fu(t,ID.fadeOutClass),Ru(t,[ID.transitionClass,ID.fadeInClass])):(Fu(t,ID.fadeInClass),Ru(t,[ID.fadeOutClass,ID.transitionClass]))},LD=function(t,n){var e=Ft.fromDom(t.getContainer());n?(Bu(e,RD),Fu(e,ND)):(Bu(e,ND),Fu(e,RD))},zD=function(t,n){var e=qc(),o=n.getSink,r=function(t){o().each((function(n){return t(n.element)}))},i=function(n){t.inline||VD(n),LD(t,MD.isDocked(n)),n.getSystem().broadcastOn([rl()],{}),o().each((function(t){return t.getSystem().broadcastOn([rl()],{})}))},u=t.inline?[]:function(){var t;return[xc.config({channels:(t={},t[FD()]={onReceive:VD},t)})]}();return D([sp.config({}),MD.config({contextual:T({lazyContext:function(n){var e=ue(n.element),o=t.inline?t.getContentAreaContainer():t.getContainer(),r=Ie(Ft.fromDom(o)),i=r.height-e,u=r.y+(PD(n,"top")?0:e);return F.some(Fe(r.x,u,r.width,i))},onShow:function(){r((function(t){return HD(t,!0)}))},onShown:function(t){r((function(t){return Nu(t,[ID.transitionClass,ID.fadeInClass])})),e.get().each((function(n){(function(t,n){var e=vn(n);Oc(e).filter((function(t){return!gn(n,t)})).filter((function(n){return gn(n,Ft.fromDom(e.dom.body))||hn(t,n)})).each((function(){return kc(n)}))})(t.element,n),e.clear()}))},onHide:function(t){(function(t,n){return _c(t).orThunk((function(){return n().toOptional().bind((function(t){return _c(t.element)}))}))})(t.element,o).fold(e.clear,e.set),r((function(t){return HD(t,!1)}))},onHidden:function(){r((function(t){return Nu(t,[ID.transitionClass])}))}},ID),lazyViewport:function(n){var e=Ne(),o=function(t){return t.getParam("toolbar_sticky_offset",0,"number")}(t),r=e.y+(PD(n,"top")?o:0),i=e.height-(PD(n,"bottom")?o:0);return Fe(e.x,r,e.width,i)},modes:[n.header.getDockingMode()],onDocked:i,onUndocked:i})],u,!0)},UD=Object.freeze({__proto__:null,setup:function(t,n,e){t.inline||(n.header.isPositionedAtTop()||t.on("ResizeEditor",(function(){e().each(MD.reset)})),t.on("ResizeWindow ResizeEditor",(function(){e().each(VD)})),t.on("SkinLoaded",(function(){e().each((function(t){MD.isDocked(t)?MD.reset(t):MD.refresh(t)}))})),t.on("FullscreenStateChanged",(function(){e().each(MD.reset)}))),t.on("AfterScrollIntoView",(function(t){e().each((function(n){MD.refresh(n);var e=n.element;Wm(e)&&function(t,n){var e=vn(n),o=e.dom.defaultView.innerHeight,r=_e(e),i=Ft.fromDom(t.elm),u=Re(i),a=ie(i),c=u.y,s=c+a,f=fe(n),l=ie(n),d=f.top,m=d+l,g=Math.abs(d-r.top)<2,p=Math.abs(m-(r.top+o))<2;if(g&&c<m)Te(r.left,c-l,e);else if(p&&s>d){var h=c-o+a+l;Te(r.left,h,e)}}(t,e)}))})),t.on("PostRender",(function(){LD(t,!1)}))},isDocked:function(t){return t().map(MD.isDocked).getOr(!1)},getBehaviours:zD}),jD=yo([Xo("type"),Wo("items",wo([So([Xo("name"),$o("items",_o)]),_o]))].concat(Qv)),WD=[nr("text"),nr("tooltip"),nr("icon"),Yo("fetch"),dr("onSetup",(function(){return p}))],GD=yo(D([Xo("type")],WD,!0)),XD=function(t){return Ro("menubutton",GD,t)},qD=yo([Xo("type"),nr("tooltip"),nr("icon"),nr("text"),er("select"),Yo("fetch"),dr("onSetup",(function(){return p})),fr("presets","normal",["normal","color","listpreview"]),ur("columns",1),Yo("onAction"),Yo("onItemAction")]),YD=_d({factory:function(t,n){var e={focus:$g.focusIn,setMenus:function(t,e){var o=U(e,(function(t){var e={type:"menubutton",text:t.text,fetch:function(n){n(t.getItems())}},o=XD(e).mapError((function(t){return Vo(t)})).getOrDie();return N_(o,"tox-mbtn",n.backstage,F.some("menuitem"))}));op.set(t,o)}};return{uid:t.uid,dom:t.dom,components:[],behaviours:gc([op.config({}),rp("menubar-events",[Li((function(n){t.onSetup(n)})),Mi(Vr(),(function(t,n){oa(t.element,".tox-mbtn--active").each((function(e){ra(n.event.target,".tox-mbtn").each((function(n){gn(e,n)||t.getSystem().getByDom(e).each((function(e){t.getSystem().getByDom(n).each((function(t){rk.expand(t),rk.close(e),sp.focus(t)}))}))}))}))})),Mi(vi(),(function(t,n){n.event.prevFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(e){n.event.newFocus.bind((function(n){return t.getSystem().getByDom(n).toOptional()})).each((function(t){rk.isOpen(e)&&(rk.expand(t),rk.close(e))}))}))}))]),$g.config({mode:"flow",selector:".tox-mbtn",onEscape:function(n){return t.onEscape(n),F.some(!0)}}),Zw.config({})]),apis:e,domModification:{attributes:{role:"menubar"}}}},name:"silver.Menubar",configFields:[jo("dom"),jo("uid"),jo("onEscape"),jo("backstage"),ur("onSetup",p)],apis:{focus:function(t,n){t.focus(n)},setMenus:function(t,n,e){t.setMenus(n,e)}}}),KD=function(t,n){return n.getAnimationRoot.fold((function(){return t.element}),(function(n){return n(t)}))},JD=function(t){return t.dimension.property},$D=function(t,n){return t.dimension.getDimension(n)},QD=function(t,n){var e=KD(t,n);Nu(e,[n.shrinkingClass,n.growingClass])},ZD=function(t,n){Fu(t.element,n.openClass),Bu(t.element,n.closedClass),qn(t.element,JD(n),"0px"),ee(t.element)},tA=function(t,n){Fu(t.element,n.closedClass),Bu(t.element,n.openClass),ne(t.element,JD(n))},nA=function(t,n,e,o){e.setCollapsed(),qn(t.element,JD(n),$D(n,t.element)),ee(t.element),QD(t,n),ZD(t,n),n.onStartShrink(t),n.onShrunk(t)},eA=function(t,n,e,o){var r=o.getOrThunk((function(){return $D(n,t.element)}));e.setCollapsed(),qn(t.element,JD(n),r),ee(t.element);var i=KD(t,n);Fu(i,n.growingClass),Bu(i,n.shrinkingClass),ZD(t,n),n.onStartShrink(t)},oA=function(t,n,e){var o=$D(n,t.element);("0px"===o?nA:eA)(t,n,e,F.some(o))},rA=function(t,n,e){var o=KD(t,n),r=Iu(o,n.shrinkingClass),i=$D(n,t.element);tA(t,n);var u=$D(n,t.element);(r?function(){qn(t.element,JD(n),i),ee(t.element)}:function(){ZD(t,n)})(),Fu(o,n.shrinkingClass),Bu(o,n.growingClass),tA(t,n),qn(t.element,JD(n),u),e.setExpanded(),n.onStartGrow(t)},iA=function(t,n,e){var o=KD(t,n);return!0===Iu(o,n.growingClass)},uA=function(t,n,e){var o=KD(t,n);return!0===Iu(o,n.shrinkingClass)},aA=Object.freeze({__proto__:null,refresh:function(t,n,e){if(e.isExpanded()){ne(t.element,JD(n));var o=$D(n,t.element);qn(t.element,JD(n),o)}},grow:function(t,n,e){e.isExpanded()||rA(t,n,e)},shrink:function(t,n,e){e.isExpanded()&&oA(t,n,e)},immediateShrink:function(t,n,e){e.isExpanded()&&nA(t,n,e)},hasGrown:function(t,n,e){return e.isExpanded()},hasShrunk:function(t,n,e){return e.isCollapsed()},isGrowing:iA,isShrinking:uA,isTransitioning:function(t,n,e){return iA(t,n)||uA(t,n)},toggleGrow:function(t,n,e){(e.isExpanded()?oA:rA)(t,n,e)},disableTransitions:QD}),cA=Object.freeze({__proto__:null,exhibit:function(t,n,e){var o=n.expanded;return vu(o?{classes:[n.openClass],styles:{}}:{classes:[n.closedClass],styles:yr(n.dimension.property,"0px")})},events:function(t,n){return Di([Hi(qr(),(function(e,o){o.event.raw.propertyName===t.dimension.property&&(QD(e,t),n.isExpanded()&&ne(e.element,t.dimension.property),(n.isExpanded()?t.onGrown:t.onShrunk)(e))}))])}}),sA=[jo("closedClass"),jo("openClass"),jo("shrinkingClass"),jo("growingClass"),Qo("getAnimationRoot"),wa("onShrunk"),wa("onStartShrink"),wa("onGrown"),wa("onStartGrow"),ur("expanded",!1),Wo("dimension",Ho("property",{width:[Oa("property","width"),Oa("getDimension",(function(t){return me(t)+"px"}))],height:[Oa("property","height"),Oa("getDimension",(function(t){return ie(t)+"px"}))]}))],fA=Object.freeze({__proto__:null,init:function(t){var n=pr(t.expanded);return pu({isExpanded:function(){return!0===n.get()},isCollapsed:function(){return!1===n.get()},setCollapsed:w(n.set,!1),setExpanded:w(n.set,!0),readState:function(){return"expanded: "+n.get()}})}}),lA=hc({fields:sA,name:"sliding",active:cA,apis:aA,state:fA}),dA="container",mA=[kl("slotBehaviours",[])],gA=function(t){return"<alloy.field."+t+">"},pA=function(t,n){var e=function(n){return hd(t)},o=function(n,e){return function(o,r){return dd(o,t,r).map((function(t){return n(t,r)})).getOr(e)}},r=function(t,n){return"true"!==zn(t.element,"aria-hidden")},i=o(r,!1),u=o((function(t,n){if(r(t)){var e=t.element;qn(e,"display","none"),Hn(e,"aria-hidden","true"),Ci(t,bi(),{name:n,visible:!1})}})),a=function(t){return function(n,e){j(e,(function(e){return t(n,e)}))}}(u),c=o((function(t,n){if(!r(t)){var e=t.element;ne(e,"display"),Wn(e,"aria-hidden"),Ci(t,bi(),{name:n,visible:!0})}})),s={getSlotNames:e,getSlot:function(n,e){return dd(n,t,e)},isShowing:i,hideSlot:u,hideAllSlots:function(t){return a(t,e())},showSlot:c};return{uid:t.uid,dom:t.dom,components:n,behaviours:Cl(t.slotBehaviours),apis:s}},hA=dt({getSlotNames:function(t,n){return t.getSlotNames(n)},getSlot:function(t,n,e){return t.getSlot(n,e)},isShowing:function(t,n,e){return t.isShowing(n,e)},hideSlot:function(t,n,e){return t.hideSlot(n,e)},hideAllSlots:function(t,n){return t.hideAllSlots(n)},showSlot:function(t,n,e){return t.showSlot(n,e)}},(function(t){return mu(t)})),vA=T(T({},hA),{sketch:function(t){var n=function(){var t=[];return{slot:function(n,e){return t.push(n),ad(dA,gA(n),e)},record:b(t)}}(),e=t(n),o=n.record(),r=U(o,(function(t){return Ql({name:t,pname:gA(t)})}));return Sd(dA,mA,r,pA,e)}}),bA=yo([nr("icon"),nr("tooltip"),dr("onShow",p),dr("onHide",p),dr("onSetup",(function(){return p}))]),yA=function(t){var n=t.ui.registry.getAll().sidebars;j(st(n),(function(e){var o=n[e],r=function(){return wt(F.from(t.queryCommandValue("ToggleSidebar")),e)};t.ui.registry.addToggleButton(e,{icon:o.icon,tooltip:o.tooltip,onAction:function(n){t.execCommand("ToggleSidebar",!1,e),n.setActive(r())},onSetup:function(n){var e=function(){return n.setActive(r())};return t.on("ToggleSidebar",e),function(){t.off("ToggleSidebar",e)}}})}))},xA=function(t){return{element:function(){return t.element.dom}}},wA=function(t,n){var e=U(st(n),(function(t){var e=n[t],o=No(function(t){return Ro("sidebar",bA,t)}(e));return{name:t,getApi:xA,onSetup:o.onSetup,onShow:o.onShow,onHide:o.onHide}}));return U(e,(function(n){var o=pr(p);return t.slot(n.name,{dom:{tag:"div",classes:["tox-sidebar__pane"]},behaviours:ry([Jy(n,o),$y(n,o),Mi(bi(),(function(t,n){var o=n.event;Y(e,(function(t){return t.name===o.name})).each((function(n){(o.visible?n.onShow:n.onHide)(n.getApi(t))}))}))])})}))},SA=function(t){return vA.sketch((function(n){return{dom:{tag:"div",classes:["tox-sidebar__pane-container"]},components:wA(n,t),slotBehaviours:ry([Li((function(t){return vA.hideAllSlots(t)}))])}}))},kA=function(t){return Bd.getCurrent(t).bind((function(t){return lA.isGrowing(t)||lA.hasGrown(t)?Bd.getCurrent(t).bind((function(t){return Y(vA.getSlotNames(t),(function(n){return vA.isShowing(t,n)}))})):F.none()}))},CA=Qi("FixSizeEvent"),OA=Qi("AutoSizeEvent"),_A=Object.freeze({__proto__:null,block:function(t,n,e,o){Hn(t.element,"aria-busy",!0);var r=n.getRoot(t).getOr(t),i=gc([$g.config({mode:"special",onTab:function(){return F.some(!0)},onShiftTab:function(){return F.some(!0)}}),sp.config({})]),u=o(r,i),a=r.getSystem().build(u);op.append(r,Ku(a)),a.hasConfigured($g)&&n.focus&&$g.focusIn(a),e.isBlocked()||n.onBlock(t),e.blockWith((function(){return op.remove(r,a)}))},unblock:function(t,n,e){Wn(t.element,"aria-busy"),e.isBlocked()&&n.onUnblock(t),e.clear()}}),TA=[dr("getRoot",F.none),lr("focus",!0),wa("onBlock"),wa("onUnblock")],EA=Object.freeze({__proto__:null,init:function(){var t=Gc();return pu({readState:t.isSet,blockWith:function(n){t.set({destroy:n})},clear:t.clear,isBlocked:t.isSet})}}),DA=hc({fields:TA,name:"blocking",apis:_A,state:EA}),AA=function(t){return Bd.getCurrent(t).each((function(t){return kc(t.element)}))},BA=function(t,n,e,o){var r=n.element;if(function(t,n){var e="tabindex",o="data-mce-"+e;F.from(t.iframeElement).map(Ft.fromDom).each((function(t){n?(Un(t,e).each((function(n){return Hn(t,o,n)})),Hn(t,e,-1)):(Wn(t,e),Un(t,o).each((function(n){Hn(t,e,n),Wn(t,o)})))}))}(t,e),e)DA.block(n,function(t){return function(n,e){return{dom:{tag:"div",attributes:{"aria-label":t.translate("Loading..."),tabindex:"0"},classes:["tox-throbber__busy-spinner"]},components:[{dom:gh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}}}(o)),ne(r,"display"),Wn(r,"aria-hidden"),t.hasFocus()&&AA(n);else{var i=Bd.getCurrent(n).exists((function(t){return Cc(t.element)}));DA.unblock(n),qn(r,"display","none"),Hn(r,"aria-hidden","true"),i&&t.focus()}},MA=function(t,n,e){var o=pr(!1),r=qc(),i=function(e){o.get()&&!function(t){return!!function(t){return"focusin"===t.type}(t)&&(t.composed?it(t.composedPath()):F.from(t.target)).map(Ft.fromDom).filter(Pt).exists((function(t){return Iu(t,"mce-pastebin")}))}(e)&&(e.preventDefault(),AA(n()),t.editorManager.setActive(t))};t.inline||t.on("PreInit",(function(){t.dom.bind(t.getWin(),"focusin",i),t.on("BeforeExecCommand",(function(t){"mcefocus"===t.command.toLowerCase()&&!0!==t.value&&i(t)}))}));var u=function(r){r!==o.get()&&(o.set(r),BA(t,n(),r,e.providers),t.fire("AfterProgressState",{state:r}))};t.on("ProgressState",(function(n){if(r.on(dh.clearTimeout),m(n.time)){var e=dh.setEditorTimeout(t,(function(){return u(n.state)}),n.time);r.set(e)}else u(n.state),r.clear()}))},FA=function(t,n,e){return{within:t,extra:n,withinWidth:e}},IA=function(t,n,e){var o=function(t,n){return q(t,(function(t,e){return n(e,t.len).fold(b(t),(function(n){return{len:n.finish,list:t.list.concat([n])}}))}),{len:0,list:[]}).list}(t,(function(t,n){var o=e(t);return F.some({element:t,start:n,finish:n+o,width:o})})),r=G(o,(function(t){return t.finish<=n})),i=X(r,(function(t,n){return t+n.width}),0);return{within:r,extra:o.slice(r.length),withinWidth:i}},RA=function(t){return U(t,(function(t){return t.element}))},NA=function(t,n,e,o){var r=function(t,n,e){var o=IA(n,t,e);return 0===o.extra.length?F.some(o):F.none()}(t,n,e).getOrThunk((function(){return IA(n,t-e(o),e)})),i=r.within,u=r.extra,a=r.withinWidth;return 1===u.length&&u[0].width<=e(o)?function(t,n,e){var o=RA(t.concat(n));return FA(o,[],e)}(i,u,a):u.length>=1?function(t,n,e,o){var r=RA(t).concat([e]);return FA(r,RA(n),o)}(i,u,o,a):function(t,n,e){return FA(RA(t),[],e)}(i,0,a)},PA=function(t,n){var e=U(n,(function(t){return Ku(t)}));aD.setGroups(t,e)},VA=function(t,n,e){var o=n.builtGroups.get();if(0!==o.length){var r=md(t,n,"primary"),i=US.getCoupled(t,"overflowGroup");qn(r.element,"visibility","hidden");var u=o.concat([i]),a=function(t){return ct(t,(function(t){return _c(t.element).bind((function(n){return t.getSystem().getByDom(n).toOptional()}))}))}(u);e([]),PA(r,u);var c=me(r.element),s=NA(c,n.builtGroups.get(),(function(t){return me(t.element)}),i);0===s.extra.length?(op.remove(r,i),e([])):(PA(r,s.within),e(s.extra)),ne(r.element,"visibility"),ee(r.element),a.each(sp.focus)}},HA=b([kl("splitToolbarBehaviours",[US]),zo("builtGroups",(function(){return pr([])}))]),LA=b([ya(["overflowToggledClass"]),er("getOverflowBounds"),jo("lazySink"),zo("overflowGroups",(function(){return pr([])}))].concat(HA())),zA=b([Ql({factory:aD,schema:iD(),name:"primary"}),Zl({schema:iD(),name:"overflow"}),Zl({name:"overflow-button"}),Zl({name:"overflow-group"})]),UA=b((function(t,n){!function(t,n){var e=de.max(t,n,["margin-left","border-left-width","padding-left","padding-right","border-right-width","margin-right"]);qn(t,"max-width",e+"px")}(t,Math.floor(n))})),jA=b([ya(["toggledClass"]),jo("lazySink"),Yo("fetch"),er("getBounds"),rr("fireDismissalEventInstead",[ur("event",pi())]),xs()]),WA=b([Zl({name:"button",overrides:function(t){return{dom:{attributes:{"aria-haspopup":"true"}},buttonBehaviours:gc([wp.config({toggleClass:t.markers.toggledClass,aria:{mode:"expanded"},toggleOnExecute:!1})])}}}),Zl({factory:aD,schema:iD(),name:"toolbar",overrides:function(t){return{toolbarBehaviours:gc([$g.config({mode:"cyclic",onEscape:function(n){return dd(n,t,"button").each(sp.focus),F.none()}})])}}})]),GA=function(t,n){var e=US.getCoupled(t,"toolbarSandbox");el.isOpen(e)?el.close(e):el.open(e,n.toolbar())},XA=function(t,n,e,o){var r=e.getBounds.map((function(t){return t()})),i=e.lazySink(t).getOrDie();Ff.positionWithinBounds(i,n,{anchor:{type:"hotspot",hotspot:t,layouts:o,overrides:{maxWidthFunction:UA()}}},r)},qA=function(t,n,e,o,r){aD.setGroups(n,r),XA(t,n,e,o),wp.on(t)},YA=Td({name:"FloatingToolbarButton",factory:function(t,n,e,o){return T(T({},mh.sketch(T(T({},o.button()),{action:function(t){GA(t,o)},buttonBehaviours:Tl({dump:o.button().buttonBehaviours},[US.config({others:{toolbarSandbox:function(n){return function(t,n,e){var o=ia();return{dom:{tag:"div",attributes:{id:o.id}},behaviours:gc([$g.config({mode:"special",onEscape:function(t){return el.close(t),F.some(!0)}}),el.config({onOpen:function(r,i){e.fetch().get((function(r){qA(t,i,e,n.layouts,r),o.link(t.element),$g.focusIn(i)}))},onClose:function(){wp.off(t),sp.focus(t),o.unlink(t.element)},isPartOf:function(n,e,o){return aa(e,o)||aa(t,o)},getAttachPoint:function(){return e.lazySink(t).getOrDie()}}),xc.config({channels:T(T({},al(T({isExtraPart:C},e.fireDismissalEventInstead.map((function(t){return{fireEventInstead:{event:t.event}}})).getOr({})))),sl({doReposition:function(){el.getState(US.getCoupled(t,"toolbarSandbox")).each((function(o){XA(t,o,e,n.layouts)}))}}))})])}}(n,e,t)}}})])}))),{apis:{setGroups:function(n,o){el.getState(US.getCoupled(n,"toolbarSandbox")).each((function(r){qA(n,r,t,e.layouts,o)}))},reposition:function(n){el.getState(US.getCoupled(n,"toolbarSandbox")).each((function(o){XA(n,o,t,e.layouts)}))},toggle:function(t){GA(t,o)},getToolbar:function(t){return el.getState(US.getCoupled(t,"toolbarSandbox"))},isOpen:function(t){return el.isOpen(US.getCoupled(t,"toolbarSandbox"))}}})},configFields:jA(),partFields:WA(),apis:{setGroups:function(t,n,e){t.setGroups(n,e)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},getToolbar:function(t,n){return t.getToolbar(n)},isOpen:function(t,n){return t.isOpen(n)}}}),KA=b([jo("items"),ya(["itemSelector"]),kl("tgroupBehaviours",[$g])]),JA=b([nd({name:"items",unit:"item"})]),$A=Td({name:"ToolbarGroup",configFields:KA(),partFields:JA(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.tgroupBehaviours,[$g.config({mode:"flow",selector:t.markers.itemSelector})]),domModification:{attributes:{role:"toolbar"}}}}}),QA=function(t){return U(t,(function(t){return Ku(t)}))},ZA=function(t,n,e){VA(t,e,(function(o){e.overflowGroups.set(o),n.getOpt(t).each((function(t){YA.setGroups(t,QA(o))}))}))},tB=Td({name:"SplitFloatingToolbar",configFields:LA(),partFields:zA(),factory:function(t,n,e,o){var r=ph(YA.sketch({fetch:function(){return TS((function(n){n(QA(t.overflowGroups.get()))}))},layouts:{onLtr:function(){return[Ka,Ya]},onRtl:function(){return[Ya,Ka]},onBottomLtr:function(){return[$a,Ja]},onBottomRtl:function(){return[Ja,$a]}},getBounds:e.getOverflowBounds,lazySink:t.lazySink,fireDismissalEventInstead:{},markers:{toggledClass:t.markers.overflowToggledClass},parts:{button:o["overflow-button"](),toolbar:o.overflow()}}));return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.splitToolbarBehaviours,[US.config({others:{overflowGroup:function(){return $A.sketch(T(T({},o["overflow-group"]()),{items:[r.asSpec()]}))}}})]),apis:{setGroups:function(n,e){t.builtGroups.set(U(e,n.getSystem().build)),ZA(n,r,t)},refresh:function(n){return ZA(n,r,t)},toggle:function(t){r.getOpt(t).each((function(t){YA.toggle(t)}))},isOpen:function(t){return r.getOpt(t).map(YA.isOpen).getOr(!1)},reposition:function(t){r.getOpt(t).each((function(t){YA.reposition(t)}))},getOverflow:function(t){return r.getOpt(t).bind(YA.getToolbar)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},reposition:function(t,n){t.reposition(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)},getOverflow:function(t,n){return t.getOverflow(n)}}}),nB=b([ya(["closedClass","openClass","shrinkingClass","growingClass","overflowToggledClass"]),wa("onOpened"),wa("onClosed")].concat(HA())),eB=b([Ql({factory:aD,schema:iD(),name:"primary"}),Ql({factory:aD,schema:iD(),name:"overflow",overrides:function(t){return{toolbarBehaviours:gc([lA.config({dimension:{property:"height"},closedClass:t.markers.closedClass,openClass:t.markers.openClass,shrinkingClass:t.markers.shrinkingClass,growingClass:t.markers.growingClass,onShrunk:function(n){dd(n,t,"overflow-button").each((function(t){wp.off(t),sp.focus(t)})),t.onClosed(n)},onGrown:function(n){$g.focusIn(n),t.onOpened(n)},onStartGrow:function(n){dd(n,t,"overflow-button").each(wp.on)}}),$g.config({mode:"acyclic",onEscape:function(n){return dd(n,t,"overflow-button").each(sp.focus),F.some(!0)}})])}}}),Zl({name:"overflow-button",overrides:function(t){return{buttonBehaviours:gc([wp.config({toggleClass:t.markers.overflowToggledClass,aria:{mode:"pressed"},toggleOnExecute:!1})])}}}),Zl({name:"overflow-group"})]),oB=function(t,n){dd(t,n,"overflow-button").bind((function(){return dd(t,n,"overflow")})).each((function(e){rB(t,n),lA.toggleGrow(e)}))},rB=function(t,n){dd(t,n,"overflow").each((function(e){VA(t,n,(function(t){var n=U(t,(function(t){return Ku(t)}));aD.setGroups(e,n)})),dd(t,n,"overflow-button").each((function(t){lA.hasGrown(e)&&wp.on(t)})),lA.refresh(e)}))},iB=Td({name:"SplitSlidingToolbar",configFields:nB(),partFields:eB(),factory:function(t,n,e,o){var r="alloy.toolbar.toggle";return{uid:t.uid,dom:t.dom,components:n,behaviours:Ol(t.splitToolbarBehaviours,[US.config({others:{overflowGroup:function(t){return $A.sketch(T(T({},o["overflow-group"]()),{items:[mh.sketch(T(T({},o["overflow-button"]()),{action:function(n){ki(t,r)}}))]}))}}}),rp("toolbar-toggle-events",[Mi(r,(function(n){oB(n,t)}))])]),apis:{setGroups:function(n,e){(function(n,e){var o=U(e,n.getSystem().build);t.builtGroups.set(o)})(n,e),rB(n,t)},refresh:function(n){return rB(n,t)},toggle:function(n){return oB(n,t)},isOpen:function(n){return function(t,n){return dd(t,n,"overflow").map(lA.hasGrown).getOr(!1)}(n,t)}},domModification:{attributes:{role:"group"}}}},apis:{setGroups:function(t,n,e){t.setGroups(n,e)},refresh:function(t,n){t.refresh(n)},toggle:function(t,n){t.toggle(n)},isOpen:function(t,n){return t.isOpen(n)}}}),uB=function(t){var n=t.title.fold((function(){return{}}),(function(t){return{attributes:{title:t}}}));return{dom:T({tag:"div",classes:["tox-toolbar__group"]},n),components:[$A.parts.items({})],items:t.items,markers:{itemSelector:"*:not(.tox-split-button) > .tox-tbtn:not([disabled]), .tox-split-button:not([disabled]), .tox-toolbar-nav-js:not([disabled])"},tgroupBehaviours:gc([Zw.config({}),sp.config({})])}},aB=function(t){return $A.sketch(uB(t))},cB=function(t,n){var e=Li((function(n){var e=U(t.initGroups,aB);aD.setGroups(n,e)}));return gc([Yy(t.providers.isDisabled),Wy(),$g.config({mode:n,onEscape:t.onEscape,selector:".tox-toolbar__group"}),rp("toolbar-events",[e])])},sB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return{uid:t.uid,dom:{tag:"div",classes:["tox-toolbar-overlord"]},parts:{"overflow-group":uB({title:F.none(),items:[]}),"overflow-button":H_({name:"more",icon:F.some("more-drawer"),disabled:!1,tooltip:F.some("More..."),primary:!1,borderless:!1},F.none(),t.providers)},splitToolbarBehaviours:cB(t,n)}},fB=function(t){var n=sB(t),e=tB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}});return tB.sketch(T(T({},n),{lazySink:t.getSink,getOverflowBounds:function(){var n=t.moreDrawerData.lazyHeader().element,e=Re(n),o=yn(n),r=Re(o),i=Math.max(o.dom.scrollHeight,r.height);return Fe(e.x+4,r.y,e.width-8,i)},parts:T(T({},n.parts),{overflow:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:t.attributes}}}),components:[e],markers:{overflowToggledClass:"tox-tbtn--enabled"}}))},lB=function(t){var n=iB.parts.primary({dom:{tag:"div",classes:["tox-toolbar__primary"]}}),e=iB.parts.overflow({dom:{tag:"div",classes:["tox-toolbar__overflow"]}}),o=sB(t);return iB.sketch(T(T({},o),{components:[n,e],markers:{openClass:"tox-toolbar__overflow--open",closedClass:"tox-toolbar__overflow--closed",growingClass:"tox-toolbar__overflow--growing",shrinkingClass:"tox-toolbar__overflow--shrinking",overflowToggledClass:"tox-tbtn--enabled"},onOpened:function(t){t.getSystem().broadcastOn([FD()],{type:"opened"})},onClosed:function(t){t.getSystem().broadcastOn([FD()],{type:"closed"})}}))},dB=function(t){var n=t.cyclicKeying?"cyclic":"acyclic";return aD.sketch({uid:t.uid,dom:{tag:"div",classes:["tox-toolbar"].concat(t.type===mb.scrolling?["tox-toolbar--scrolling"]:[])},components:[aD.parts.groups({})],toolbarBehaviours:cB(t,n)})},mB=ZE.optional({factory:YD,name:"menubar",schema:[jo("backstage")]}),gB=ZE.optional({factory:{sketch:function(t){return rD.sketch({uid:t.uid,dom:t.dom,listBehaviours:gc([$g.config({mode:"acyclic",selector:".tox-toolbar"})]),makeItem:function(){return dB({type:t.type,uid:Qi("multiple-toolbar-item"),cyclicKeying:!1,initGroups:[],providers:t.providers,onEscape:function(){return t.onEscape(),F.some(!0)}})},setupItem:function(t,n,e,o){aD.setGroups(n,e)},shell:!0})}},name:"multiple-toolbar",schema:[jo("dom"),jo("onEscape")]}),pB=ZE.optional({factory:{sketch:function(t){return function(t){return t.type===mb.sliding?lB:t.type===mb.floating?fB:dB}(t)({type:t.type,uid:t.uid,onEscape:function(){return t.onEscape(),F.some(!0)},cyclicKeying:!1,initGroups:[],getSink:t.getSink,providers:t.providers,moreDrawerData:{lazyToolbar:t.lazyToolbar,lazyMoreButton:t.lazyMoreButton,lazyHeader:t.lazyHeader},attributes:t.attributes})}},name:"toolbar",schema:[jo("dom"),jo("onEscape"),jo("getSink")]}),hB=ZE.optional({factory:{sketch:function(t){var n=t.editor,e=t.sticky?zD:fD;return{uid:t.uid,dom:t.dom,components:t.components,behaviours:gc(e(n,t.sharedBackstage))}}},name:"header",schema:[jo("dom")]}),vB=ZE.optional({name:"socket",schema:[jo("dom")]}),bB=ZE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",classes:["tox-sidebar"],attributes:{role:"complementary"}},components:[{dom:{tag:"div",classes:["tox-sidebar__slider"]},components:[],behaviours:gc([Zw.config({}),sp.config({}),lA.config({dimension:{property:"width"},closedClass:"tox-sidebar--sliding-closed",openClass:"tox-sidebar--sliding-open",shrinkingClass:"tox-sidebar--sliding-shrinking",growingClass:"tox-sidebar--sliding-growing",onShrunk:function(t){Bd.getCurrent(t).each(vA.hideAllSlots),ki(t,OA)},onGrown:function(t){ki(t,OA)},onStartGrow:function(t){Ci(t,CA,{width:Qn(t.element,"width").getOr("")})},onStartShrink:function(t){Ci(t,CA,{width:me(t.element)+"px"})}}),op.config({}),Bd.config({find:function(t){var n=op.contents(t);return it(n)}})])}],behaviours:gc([fO(0),rp("sidebar-sliding-events",[Mi(CA,(function(t,n){qn(t.element,"width",n.event.width)})),Mi(OA,(function(t,n){ne(t.element,"width")}))])])}}},name:"sidebar",schema:[jo("dom")]}),yB=ZE.optional({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"div",attributes:{"aria-hidden":"true"},classes:["tox-throbber"],styles:{display:"none"}},behaviours:gc([op.config({}),DA.config({focus:!1}),Bd.config({find:function(t){return it(t.components())}})]),components:[]}}},name:"throbber",schema:[jo("dom")]}),xB=Td({name:"OuterContainer",factory:function(t,n,e){var o={getSocket:function(n){return QE.getPart(n,t,"socket")},setSidebar:function(n,e){QE.getPart(n,t,"sidebar").each((function(t){return function(t,n){Bd.getCurrent(t).each((function(t){return op.set(t,[SA(n)])}))}(t,e)}))},toggleSidebar:function(n,e){QE.getPart(n,t,"sidebar").each((function(t){return function(t,n){Bd.getCurrent(t).each((function(t){Bd.getCurrent(t).each((function(e){lA.hasGrown(t)?vA.isShowing(e,n)?lA.shrink(t):(vA.hideAllSlots(e),vA.showSlot(e,n)):(vA.hideAllSlots(e),vA.showSlot(e,n),lA.grow(t))}))}))}(t,e)}))},whichSidebar:function(n){return QE.getPart(n,t,"sidebar").bind(kA).getOrNull()},getHeader:function(n){return QE.getPart(n,t,"header")},getToolbar:function(n){return QE.getPart(n,t,"toolbar")},setToolbar:function(n,e){QE.getPart(n,t,"toolbar").each((function(t){t.getApis().setGroups(t,e)}))},setToolbars:function(n,e){QE.getPart(n,t,"multiple-toolbar").each((function(t){rD.setItems(t,e)}))},refreshToolbar:function(n){QE.getPart(n,t,"toolbar").each((function(t){return t.getApis().refresh(t)}))},toggleToolbarDrawer:function(n){QE.getPart(n,t,"toolbar").each((function(t){!function(t,n){null!=t?F.some(n(t)):F.none()}(t.getApis().toggle,(function(n){return n(t)}))}))},isToolbarDrawerToggled:function(n){return QE.getPart(n,t,"toolbar").bind((function(t){return F.from(t.getApis().isOpen).map((function(n){return n(t)}))})).getOr(!1)},getThrobber:function(n){return QE.getPart(n,t,"throbber")},focusToolbar:function(n){QE.getPart(n,t,"toolbar").orThunk((function(){return QE.getPart(n,t,"multiple-toolbar")})).each((function(t){$g.focusIn(t)}))},setMenubar:function(n,e){QE.getPart(n,t,"menubar").each((function(t){YD.setMenus(t,e)}))},focusMenubar:function(n){QE.getPart(n,t,"menubar").each((function(t){YD.focus(t)}))}};return{uid:t.uid,dom:t.dom,components:n,apis:o,behaviours:t.behaviours}},configFields:[jo("dom"),jo("behaviours")],partFields:[hB,mB,pB,gB,vB,bB,yB],apis:{getSocket:function(t,n){return t.getSocket(n)},setSidebar:function(t,n,e){t.setSidebar(n,e)},toggleSidebar:function(t,n,e){t.toggleSidebar(n,e)},whichSidebar:function(t,n){return t.whichSidebar(n)},getHeader:function(t,n){return t.getHeader(n)},getToolbar:function(t,n){return t.getToolbar(n)},setToolbar:function(t,n,e){var o=U(e,(function(t){return aB(t)}));t.setToolbar(n,o)},setToolbars:function(t,n,e){var o=U(e,(function(t){return U(t,aB)}));t.setToolbars(n,o)},refreshToolbar:function(t,n){return t.refreshToolbar(n)},toggleToolbarDrawer:function(t,n){t.toggleToolbarDrawer(n)},isToolbarDrawerToggled:function(t,n){return t.isToolbarDrawerToggled(n)},getThrobber:function(t,n){return t.getThrobber(n)},setMenubar:function(t,n,e){t.setMenubar(n,e)},focusMenubar:function(t,n){t.focusMenubar(n)},focusToolbar:function(t,n){t.focusToolbar(n)}}}),wB={file:{title:"File",items:"newdocument restoredraft | preview | export print | deleteallconversations"},edit:{title:"Edit",items:"undo redo | cut copy paste pastetext | selectall | searchreplace"},view:{title:"View",items:"code | visualaid visualchars visualblocks | spellchecker | preview fullscreen | showcomments"},insert:{title:"Insert",items:"image link media addcomment pageembed template codesample inserttable | charmap emoticons hr | pagebreak nonbreaking anchor toc | insertdatetime"},format:{title:"Format",items:"bold italic underline strikethrough superscript subscript codeformat | formats blockformats fontformats fontsizes align lineheight | forecolor backcolor | language | removeformat"},tools:{title:"Tools",items:"spellchecker spellcheckerlanguage | a11ycheck code wordcount"},table:{title:"Table",items:"inserttable | cell row column | advtablesort | tableprops deletetable"},help:{title:"Help",items:"help"}},SB=function(t){return"string"==typeof t?t.split(" "):t},kB=function(t,n){var e=T(T({},wB),n.menus),o=st(n.menus).length>0,r=void 0===n.menubar||!0===n.menubar?SB("file edit view insert format tools table help"):SB(!1===n.menubar?"":n.menubar),i=G(r,(function(t){var e=yt(wB,t);return o?e||bt(n.menus,t).exists((function(t){return yt(t,"items")})):e})),u=U(i,(function(o){var r=e[o];return function(t,n,e){var o=function(t){return t.getParam("removed_menuitems","")}(e).split(/[ ,]/);return{text:t.title,getItems:function(){return $(t.items,(function(t){var e=t.toLowerCase();return 0===e.trim().length||H(o,(function(t){return t===e}))?[]:"separator"===e||"|"===e?[{type:"separator"}]:n.menuItems[e]?[n.menuItems[e]]:[]}))}}}({title:r.title,items:SB(r.items)},n,t)}));return G(u,(function(t){return t.getItems().length>0&&H(t.getItems(),(function(t){return"separator"!==t.type}))}))},CB=function(t){var n=function(){t._skinLoaded=!0,function(t){t.fire("SkinLoaded")}(t)};return function(){t.initialized?n():t.on("init",n)}},OB=function(t,n,e){return new Uv((function(o,r){e.load(n,o,r),t.on("remove",(function(){return e.unload(n)}))}))},_B=function(t,n){return OB(t,n+"/skin.min.css",t.ui.styleSheetLoader)},TB=function(t,n){return function(t){return Mn(t).isSome()}(Ft.fromDom(t.getElement()))?OB(t,n+"/skin.shadowdom.min.css",gy.DOM.styleSheetLoader):Uv.resolve()},EB=function(t,n){var e=function(t){var n=t.getParam("skin"),e=t.getParam("skin_url");if(!1!==n){var o=n||"oxide";e=e?t.documentBaseURI.toAbsolute(e):py.baseURL+"/skins/ui/"+o}return e}(n);e&&n.contentCSS.push(e+(t?"/content.inline":"/content")+".min.css"),!1===function(t){return!1===t.getParam("skin")}(n)&&r(e)?Uv.all([_B(n,e),TB(n,e)]).then(CB(n),function(t,n){return function(){return function(t,n){return t.fire("SkinLoadError",n)}(t,{message:n})}}(n,"Skin could not be loaded")):CB(n)()},DB=w(EB,!1),AB=w(EB,!0),BB=function(t,n){return function(e){var o=Xc(),r=function(){e.setActive(t.formatter.match(n));var r=t.formatter.formatChanged(n,e.setActive);o.set(r)};return t.initialized?r():t.once("init",r),function(){t.off("init",r),o.clear()}}},MB=function(t,n,e){return function(o){var r=function(){return e(o)},i=function(){e(o),t.on(n,r)};return t.initialized?i():t.once("init",i),function(){t.off("init",i),t.off(n,r)}}},FB=function(t){return function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("mceToggleFormat",!1,n.format)}))}}},IB=function(t,n){return function(){return t.execCommand(n)}},RB=function(t,n,e){var o=function(t,o,i,u){var a=n.shared.providers.translate(t.title);if("separator"===t.type)return F.some({type:"separator",text:a});if("submenu"===t.type){var c=$(t.getStyleItems(),(function(t){return r(t,o,u)}));return 0===o&&c.length<=0?F.none():F.some({type:"nestedmenuitem",text:a,disabled:c.length<=0,getSubmenuItems:function(){return $(t.getStyleItems(),(function(t){return r(t,o,u)}))}})}return F.some(T({type:"togglemenuitem",text:a,icon:t.icon,active:t.isSelected(u),disabled:i,onAction:e.onAction(t)},t.getStylePreview().fold((function(){return{}}),(function(t){return{meta:{style:t}}}))))},r=function(t,n,r){var i="formatter"===t.type&&e.isInvalid(t);return 0===n?i?[]:o(t,n,!1,r).toArray():o(t,n,i,r).toArray()},i=function(t){var n=e.getCurrentValue(),o=e.shouldHide?0:1;return $(t,(function(t){return r(t,o,n)}))};return{validateItems:i,getFetch:function(t,n){return function(e,o){var r=n(),u=i(r);o(I_(u,gb.CLOSE_ON_EXECUTE,t,!1))}}}},NB=function(t,n,e){var o=e.dataset,r="basic"===o.type?function(){return U(o.data,(function(t){return xE(t,e.isSelectedFor,e.getPreviewFor)}))}:o.getData;return{items:RB(0,n,e),getStyleItems:r}},PB=function(t,n,e){var o=NB(0,n,e),r=o.items,i=o.getStyleItems,u=MB(t,"NodeChange",(function(t){var n=t.getComponent();e.updateText(n)}));return E_({text:e.icon.isSome()?F.none():e.text,icon:e.icon,tooltip:F.from(e.tooltip),role:F.none(),fetch:r.getFetch(n,i),onSetup:u,getApi:function(t){return{getComponent:b(t)}},columns:1,presets:"normal",classes:e.icon.isSome()?[]:["bespoke"],dropdownBehaviours:[]},"tox-tbtn",n.shared)};!function(t){t[t.SemiColon=0]="SemiColon",t[t.Space=1]="Space"}(vT||(vT={}));var VB,HB=function(t,n,e,o){return{type:"basic",data:function(t){return U(t,(function(t){var n=t,e=t,o=t.split("=");return o.length>1&&(n=o[0],e=o[1]),{title:n,format:e}}))}(function(t,n){return n===vT.SemiColon?t.replace(/;$/,"").split(";"):t.split(" ")}(t.getParam(n,e,"string"),o))}},LB=[{title:"Left",icon:"align-left",format:"alignleft",command:"JustifyLeft"},{title:"Center",icon:"align-center",format:"aligncenter",command:"JustifyCenter"},{title:"Right",icon:"align-right",format:"alignright",command:"JustifyRight"},{title:"Justify",icon:"align-justify",format:"alignjustify",command:"JustifyFull"}],zB=function(t){var n=function(){return Y(LB,(function(n){return t.formatter.match(n.format)}))},e=function(t){return{type:"basic",data:t}}(LB);return{tooltip:"Align",text:F.none(),icon:F.some("align-left"),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(t){return F.none},onAction:function(n){return function(){return Y(LB,(function(t){return t.format===n.format})).each((function(n){return t.execCommand(n.command)}))}},updateText:function(t){var e=n().fold(b("left"),(function(t){return t.title.toLowerCase()}));Ci(t,T_,{icon:"align-"+e})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},UB=["-apple-system","Segoe UI","Roboto","Helvetica Neue","sans-serif"],jB=function(t){var n=t.split(/\s*,\s*/);return U(n,(function(t){return t.replace(/^['"]+|['"]+$/g,"")}))},WB=function(t){var n="System Font",e=function(){var e=function(t){return t?jB(t)[0]:""},r=t.queryCommandValue("FontName"),i=o.data,u=r?r.toLowerCase():"";return{matchOpt:Y(i,(function(t){var n=t.format;return n.toLowerCase()===u||e(n).toLowerCase()===e(u).toLowerCase()})).orThunk((function(){return Ct(function(t){return 0===t.indexOf("-apple-system")&&function(){var n=jB(t.toLowerCase());return Q(UB,(function(t){return n.indexOf(t.toLowerCase())>-1}))}()}(u),{title:n,format:u})})),font:r}},o=HB(t,"font_formats","Andale Mono=andale mono,monospace;Arial=arial,helvetica,sans-serif;Arial Black=arial black,sans-serif;Book Antiqua=book antiqua,palatino,serif;Comic Sans MS=comic sans ms,sans-serif;Courier New=courier new,courier,monospace;Georgia=georgia,palatino,serif;Helvetica=helvetica,arial,sans-serif;Impact=impact,sans-serif;Symbol=symbol;Tahoma=tahoma,arial,helvetica,sans-serif;Terminal=terminal,monaco,monospace;Times New Roman=times new roman,times,serif;Trebuchet MS=trebuchet ms,geneva,sans-serif;Verdana=verdana,geneva,sans-serif;Webdings=webdings;Wingdings=wingdings,zapf dingbats",vT.SemiColon);return{tooltip:"Fonts",text:F.some(n),icon:F.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getCurrentValue:function(){return e().matchOpt},getPreviewFor:function(t){return function(){return F.some({tag:"div",styles:-1===t.indexOf("dings")?{"font-family":t}:{}})}},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontName",!1,n.format)}))}},updateText:function(t){var n=e(),o=n.matchOpt,r=n.font,i=o.fold(b(r),(function(t){return t.title}));Ci(t,__,{text:i})},dataset:o,shouldHide:!1,isInvalid:C}},GB={"8pt":"1","10pt":"2","12pt":"3","14pt":"4","18pt":"5","24pt":"6","36pt":"7"},XB={"xx-small":"7pt","x-small":"8pt",small:"10pt",medium:"12pt",large:"14pt","x-large":"18pt","xx-large":"24pt"},qB=function(t,n){return/[0-9.]+px$/.test(t)?function(t,n){var e=Math.pow(10,n);return Math.round(t*e)/e}(72*parseInt(t,10)/96,n||0)+"pt":bt(XB,t).getOr(t)},YB=function(t){var n=function(){var n=F.none(),e=o.data,r=t.queryCommandValue("FontSize");if(r)for(var i=function(t){var o=qB(r,t),i=function(t){return bt(GB,t).getOr("")}(o);n=Y(e,(function(t){return t.format===r||t.format===o||t.format===i}))},u=3;n.isNone()&&u>=0;u--)i(u);return{matchOpt:n,size:r}},e=b(F.none),o=HB(t,"fontsize_formats","8pt 10pt 12pt 14pt 18pt 24pt 36pt",vT.Space);return{tooltip:"Font sizes",text:F.some("12pt"),icon:F.none(),isSelectedFor:function(t){return function(n){return n.exists((function(n){return n.format===t}))}},getPreviewFor:e,getCurrentValue:function(){return n().matchOpt},onAction:function(n){return function(){t.undoManager.transact((function(){t.focus(),t.execCommand("FontSize",!1,n.format)}))}},updateText:function(t){var e=n(),o=e.matchOpt,r=e.size,i=o.fold(b(r),(function(t){return t.title}));Ci(t,__,{text:i})},dataset:o,shouldHide:!1,isInvalid:C}},KB=function(t,n){var e=n(),o=U(e,(function(t){return t.format}));return F.from(t.formatter.closest(o)).bind((function(t){return Y(e,(function(n){return n.format===t}))})).orThunk((function(){return Ct(t.formatter.match("p"),{title:"Paragraph",format:"p"})}))},JB=function(t){var n="Paragraph",e=HB(t,"block_formats","Paragraph=p;Heading 1=h1;Heading 2=h2;Heading 3=h3;Heading 4=h4;Heading 5=h5;Heading 6=h6;Preformatted=pre",vT.SemiColon);return{tooltip:"Blocks",text:F.some(n),icon:F.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))})}},onAction:FB(t),updateText:function(o){var r=KB(t,(function(){return e.data})).fold(b(n),(function(t){return t.title}));Ci(o,__,{text:r})},dataset:e,shouldHide:!1,isInvalid:function(n){return!t.formatter.canApply(n.format)}}},$B=function(t,n){var e="Paragraph";return{tooltip:"Formats",text:F.some(e),icon:F.none(),isSelectedFor:function(n){return function(){return t.formatter.match(n)}},getCurrentValue:F.none,getPreviewFor:function(n){return function(){var e=t.formatter.get(n);return void 0!==e?F.some({tag:e.length>0&&(e[0].inline||e[0].block)||"div",styles:t.dom.parseStyle(t.formatter.getCssText(n))}):F.none()}},onAction:FB(t),updateText:function(n){var o=function(t){var n=t.items;return void 0!==n&&n.length>0?$(n,o):[{title:t.title,format:t.format}]},r=$(yE(t),o),i=KB(t,b(r)).fold(b(e),(function(t){return t.title}));Ci(n,__,{text:i})},shouldHide:t.getParam("style_formats_autohide",!1,"boolean"),isInvalid:function(n){return!t.formatter.canApply(n.format)},dataset:n}},QB=Object.freeze({__proto__:null,events:function(t,n){var e=function(e,o){t.updateState.each((function(t){var r=t(e,o);n.set(r)})),t.renderComponents.each((function(t){var r=t(o,n.get()),i=U(r,e.getSystem().build);Pf(e,i)}))};return Di([Mi(ni(),(function(n,o){var r=o;if(!r.universal){var i=t.channel;V(r.channels,i)&&e(n,r.data)}})),Li((function(n,o){t.initialData.each((function(t){e(n,t)}))}))])}}),ZB=Object.freeze({__proto__:null,getState:function(t,n,e){return e}}),tM=[jo("channel"),Qo("renderComponents"),Qo("updateState"),Qo("initialData")],nM=Object.freeze({__proto__:null,init:function(){var t=pr(F.none());return{readState:function(){return t.get().getOr("none")},get:t.get,set:t.set,clear:function(){return t.set(F.none())}}}}),eM=hc({fields:tM,name:"reflecting",active:QB,apis:ZB,state:nM}),oM=b([jo("toggleClass"),jo("fetch"),ka("onExecute"),ur("getHotspot",F.some),ur("getAnchorOverrides",b({})),xs(),ka("onItemExecute"),Qo("lazySink"),jo("dom"),wa("onOpen"),kl("splitDropdownBehaviours",[US,$g,sp]),ur("matchWidth",!1),ur("useMinWidth",!1),ur("eventOrder",{}),Qo("role")].concat(nk())),rM=Ql({factory:mh,schema:[jo("dom")],name:"arrow",defaults:function(){return{buttonBehaviours:gc([sp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each(Oi)},buttonBehaviours:gc([wp.config({toggleOnExecute:!1,toggleClass:t.toggleClass})])}}}),iM=Ql({factory:mh,schema:[jo("dom")],name:"button",defaults:function(){return{buttonBehaviours:gc([sp.revoke()])}},overrides:function(t){return{dom:{tag:"span",attributes:{role:"presentation"}},action:function(n){n.getSystem().getByUid(t.uid).each((function(e){t.onExecute(e,n)}))}}}}),uM=b([rM,iM,td({factory:{sketch:function(t){return{uid:t.uid,dom:{tag:"span",styles:{display:"none"},attributes:{"aria-hidden":"true"},innerHtml:t.text}}}},schema:[jo("text")],name:"aria-descriptor"}),Zl({schema:[ba()],name:"menu",defaults:function(t){return{onExecute:function(n,e){n.getSystem().getByUid(t.uid).each((function(o){t.onItemExecute(o,n,e)}))}}}}),WS()]),aM=Td({name:"SplitDropdown",configFields:oM(),partFields:uM(),factory:function(t,n,e,o){var r,i=function(t){Bd.getCurrent(t).each((function(t){em.highlightFirst(t),$g.focusIn(t)}))},u=function(n){KS(t,y,n,o,i,wS.HighlightFirst).get(p)},a=function(n){var e=md(n,t,"button");return Oi(e),F.some(!0)},c=T(T({},Di([Li((function(n,e){dd(n,t,"aria-descriptor").each((function(t){var e=Qi("aria");Hn(t.element,"id",e),Hn(n.element,"aria-describedby",e)}))}))])),kp(F.some(u))),s={repositionMenus:function(t){wp.isOn(t)&&tk(t)}};return{uid:t.uid,dom:t.dom,components:n,apis:s,eventOrder:T(T({},t.eventOrder),(r={},r[ei()]=["disabling","toggling","alloy.base.behaviour"],r)),events:c,behaviours:Ol(t.splitDropdownBehaviours,[US.config({others:{sandbox:function(n){var e=md(n,t,"arrow");return ZS(t,n,{onOpen:function(){wp.on(e),wp.on(n)},onClose:function(){wp.off(e),wp.off(n)}})}}}),$g.config({mode:"special",onSpace:a,onEnter:a,onDown:function(t){return u(t),F.some(!0)}}),sp.config({}),wp.config({toggleOnExecute:!1,aria:{mode:"expanded"}})]),domModification:{attributes:{role:t.role.getOr("button"),"aria-haspopup":!0}}}},apis:{repositionMenus:function(t,n){return t.repositionMenus(n)}}}),cM=function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},sM=function(t){return{setActive:function(n){wp.set(t,n)},isActive:function(){return wp.isOn(t)},isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)}}},fM=function(t,n){return t.map((function(t){return{"aria-label":n.translate(t),title:n.translate(t)}})).getOr({})},lM=Qi("focus-button"),dM=function(t,n,e,o,r,i){var u;return{dom:{tag:"button",classes:["tox-tbtn"].concat(n.isSome()?["tox-tbtn--select"]:[]),attributes:fM(e,i)},components:tx([t.map((function(t){return x_(t,i.icons)})),n.map((function(t){return S_(t,"tox-tbtn",i)}))]),eventOrder:(u={},u[Ir()]=["focusing","alloy.base.behaviour","common-button-display-events"],u),buttonBehaviours:gc([Yy(i.isDisabled),Wy(),rp("common-button-display-events",[Mi(Ir(),(function(t,n){n.event.prevent(),ki(t,lM)}))])].concat(o.map((function(e){return eM.config({channel:e,initialData:{icon:t,text:n},renderComponents:function(t,n){return tx([t.icon.map((function(t){return x_(t,i.icons)})),t.text.map((function(t){return S_(t,"tox-tbtn",i)}))])}})})).toArray()).concat(r.getOr([])))}},mM=function(t,n,e){var o=pr(p),r=dM(t.icon,t.text,t.tooltip,F.none(),F.none(),e);return mh.sketch({dom:r.dom,components:r.components,eventOrder:O_,buttonBehaviours:gc([rp("toolbar-button-events",[C_({onAction:t.onAction,getApi:n.getApi}),Jy(n,o),$y(n,o)]),Yy((function(){return t.disabled||e.isDisabled()})),Wy()].concat(n.toolbarButtonBehaviours))})},gM=function(t,n,e){return mM(t,{toolbarButtonBehaviours:[].concat(e.length>0?[rp("toolbarButtonWith",e)]:[]),getApi:cM,onSetup:t.onSetup},n)},pM=function(t,n,e){return eo(mM(t,{toolbarButtonBehaviours:[op.config({}),wp.config({toggleClass:"tox-tbtn--enabled",aria:{mode:"pressed"},toggleOnExecute:!1})].concat(e.length>0?[rp("toolbarToggleButtonWith",e)]:[]),getApi:sM,onSetup:t.onSetup},n))},hM=function(t,n,e){return function(o){return TS((function(t){return n.fetch(t)})).map((function(r){return F.from(Aw(eo(sw(Qi("menu-value"),r,(function(e){n.onItemAction(t(o),e)}),n.columns,n.presets,gb.CLOSE_ON_EXECUTE,n.select.getOr(C),e),{movement:lw(n.columns,n.presets),menuBehaviours:ry("auto"!==n.columns?[]:[Li((function(t,e){ey(t,4,_b(n.presets)).each((function(n){var e=n.numRows,o=n.numColumns;$g.setGridSize(t,e,o)}))}))])})))}))}},vM=[{name:"history",items:["undo","redo"]},{name:"styles",items:["styleselect"]},{name:"formatting",items:["bold","italic"]},{name:"alignment",items:["alignleft","aligncenter","alignright","alignjustify"]},{name:"indentation",items:["outdent","indent"]},{name:"permanent pen",items:["permanentpen"]},{name:"comments",items:["addcomment"]}],bM=function(t,n){return function(e,o,r){var i=t(e).mapError((function(t){return Vo(t)})).getOrDie();return n(i,o,r)}},yM={button:bM(tb,(function(t,n){return function(t,n){return gM(t,n,[])}(t,n.backstage.shared.providers)})),togglebutton:bM(ob,(function(t,n){return function(t,n){return pM(t,n,[])}(t,n.backstage.shared.providers)})),menubutton:bM(XD,(function(t,n){return N_(t,"tox-tbtn",n.backstage,F.none())})),splitbutton:bM((function(t){return Ro("SplitButton",qD,t)}),(function(t,n){return function(t,n){var e,o=Qi("channel-update-split-dropdown-display"),r=function(t){return{isDisabled:function(){return Gd.isDisabled(t)},setDisabled:function(n){return Gd.set(t,n)},setIconFill:function(n,e){oa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Hn(t,"fill",e)}))},setIconStroke:function(n,e){oa(t.element,'svg path[id="'+n+'"], rect[id="'+n+'"]').each((function(t){Hn(t,"stroke",e)}))},setActive:function(n){Hn(t.element,"aria-pressed",n),oa(t.element,"span").each((function(e){t.getSystem().getByDom(e).each((function(t){return wp.set(t,n)}))}))},isActive:function(){return oa(t.element,"span").exists((function(n){return t.getSystem().getByDom(n).exists(wp.isOn)}))}}},i=pr(p),u={getApi:r,onSetup:t.onSetup};return aM.sketch({dom:{tag:"div",classes:["tox-split-button"],attributes:T({"aria-pressed":!1},fM(t.tooltip,n.providers))},onExecute:function(n){t.onAction(r(n))},onItemExecute:function(t,n,e){},splitDropdownBehaviours:gc([qy(n.providers.isDisabled),Wy(),rp("split-dropdown-events",[Mi(lM,sp.focus),Jy(u,i),$y(u,i)]),uk.config({})]),eventOrder:(e={},e[mi()]=["alloy.base.behaviour","split-dropdown-events"],e),toggleClass:"tox-tbtn--enabled",lazySink:n.getSink,fetch:hM(r,t,n.providers),parts:{menu:Mb(0,t.columns,t.presets)},components:[aM.parts.button(dM(t.icon,t.text,F.none(),F.some(o),F.some([wp.config({toggleClass:"tox-tbtn--enabled",toggleOnExecute:!1})]),n.providers)),aM.parts.arrow({dom:{tag:"button",classes:["tox-tbtn","tox-split-button__chevron"],innerHtml:Sv("chevron-down",n.providers.icons)},buttonBehaviours:gc([qy(n.providers.isDisabled),Wy(),kv()])}),aM.parts["aria-descriptor"]({text:n.providers.translate("To open the popup, press Shift+Enter")})]})}(t,n.backstage.shared)})),grouptoolbarbutton:bM((function(t){return Ro("GroupToolbarButton",jD,t)}),(function(t,n,e){var o,r=e.ui.registry.getAll().buttons,i=((o={})[bs]=n.backstage.shared.header.isPositionedAtTop()?Nc.TopToBottom:Nc.BottomToTop,o);switch(Ty(e)){case mb.floating:return function(t,n,e,o){var r=n.shared;return YA.sketch({lazySink:r.getSink,fetch:function(){return TS((function(n){n(U(e(t.items),aB))}))},markers:{toggledClass:"tox-tbtn--enabled"},parts:{button:dM(t.icon,t.text,t.tooltip,F.none(),F.none(),r.providers),toolbar:{dom:{tag:"div",classes:["tox-toolbar__overflow"],attributes:o}}}})}(t,n.backstage,(function(t){return kM(e,{buttons:r,toolbar:t,allowToolbarGroups:!1},n,F.none())}),i);default:throw new Error("Toolbar groups are only supported when using floating toolbar mode")}})),styleSelectButton:function(t,n){return function(t,n){var e=T({type:"advanced"},n.styleselect);return PB(t,n,$B(t,e))}(t,n.backstage)},fontsizeSelectButton:function(t,n){return function(t,n){return PB(t,n,YB(t))}(t,n.backstage)},fontSelectButton:function(t,n){return function(t,n){return PB(t,n,WB(t))}(t,n.backstage)},formatButton:function(t,n){return function(t,n){return PB(t,n,JB(t))}(t,n.backstage)},alignMenuButton:function(t,n){return function(t,n){return PB(t,n,zB(t))}(t,n.backstage)}},xM={styleselect:yM.styleSelectButton,fontsizeselect:yM.fontsizeSelectButton,fontselect:yM.fontSelectButton,formatselect:yM.formatButton,align:yM.alignMenuButton},wM=function(t){var n=t.toolbar,e=t.buttons;return!1===n?[]:void 0===n||!0===n?function(t){var n=U(vM,(function(n){var e=G(n.items,(function(n){return yt(t,n)||yt(xM,n)}));return{name:n.name,items:e}}));return G(n,(function(t){return t.items.length>0}))}(e):r(n)?function(t){var n=t.split("|");return U(n,(function(t){return{items:t.trim().split(" ")}}))}(n):function(t){return g(t,(function(t){return yt(t,"name")&&yt(t,"items")}))}(n)?n:(console.error("Toolbar type should be string, string[], boolean or ToolbarGroup[]"),[])},SM=function(t,n,e,o,r,i){return bt(n,e.toLowerCase()).orThunk((function(){return i.bind((function(t){return ct(t,(function(t){return bt(n,t+e.toLowerCase())}))}))})).fold((function(){return bt(xM,e.toLowerCase()).map((function(n){return n(t,r)})).orThunk((function(){return F.none()}))}),(function(n){return"grouptoolbarbutton"!==n.type||o?function(t,n,e){return bt(yM,t.type).fold((function(){return console.error("skipping button defined by",t),F.none()}),(function(o){return F.some(o(t,n,e))}))}(n,r,t):(console.warn("Ignoring the '"+e+"' toolbar button. Group toolbar buttons are only supported when using floating toolbar mode and cannot be nested."),F.none())}))},kM=function(t,n,e,o){var r=wM(n),i=U(r,(function(r){var i=$(r.items,(function(r){return 0===r.trim().length?[]:SM(t,n.buttons,r,n.allowToolbarGroups,e,o).toArray()}));return{title:F.from(t.translate(r.name)),items:i}}));return G(i,(function(t){return t.items.length>0}))},CM=function(t,n,e,o){var i=n.outerContainer,u=e.toolbar,a=e.buttons;if(g(u,r)){var c=u.map((function(n){var r={toolbar:n,buttons:a,allowToolbarGroups:e.allowToolbarGroups};return kM(t,r,{backstage:o},F.none())}));xB.setToolbars(i,c)}else xB.setToolbar(i,kM(t,e,{backstage:o},F.none()))},OM=ln(),_M=OM.os.isiOS()&&OM.os.version.major<=12,TM=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=pr(0),u=n.outerContainer;DB(t);var a=Ft.fromDom(r.targetNode),c=Bn(An(a));(function(t,n){Wf(t,n,ye)})(a,n.mothership),jf(c,n.uiMothership),t.on("PostRender",(function(){CM(t,n,e,o),i.set(t.getWin().innerWidth),xB.setMenubar(u,kB(t,e)),xB.setSidebar(u,e.sidebar),function(t,n){var e=t.dom,o=t.getWin(),r=t.getDoc().documentElement,i=pr(ce(o.innerWidth,o.innerHeight)),u=pr(ce(r.offsetWidth,r.offsetHeight)),a=function(){var n=i.get();n.left===o.innerWidth&&n.top===o.innerHeight||(i.set(ce(o.innerWidth,o.innerHeight)),Hx(t))},c=function(){var n=t.getDoc().documentElement,e=u.get();e.left===n.offsetWidth&&e.top===n.offsetHeight||(u.set(ce(n.offsetWidth,n.offsetHeight)),Hx(t))},s=function(n){return function(t,n){return t.fire("ScrollContent",n)}(t,n)};e.bind(o,"resize",a),e.bind(o,"scroll",s);var f=Jc(Ft.fromDom(t.getBody()),"load",c),l=n.uiMothership.element;t.on("hide",(function(){qn(l,"display","none")})),t.on("show",(function(){ne(l,"display")})),t.on("NodeChange",c),t.on("remove",(function(){f.unbind(),e.unbind(o,"resize",a),e.unbind(o,"scroll",s),o=null}))}(t,n)}));var s=xB.getSocket(u).getOrDie("Could not find expected socket element");if(_M){Yn(s.element,{overflow:"scroll","-webkit-overflow-scrolling":"touch"});var f=Av((function(){t.fire("ScrollContent")}),20),l=Kc(s.element,"scroll",f.throttle);t.on("remove",l.unbind)}jy(t,n),t.addCommand("ToggleSidebar",(function(n,e){xB.toggleSidebar(u,e),t.fire("ToggleSidebar")})),t.addQueryValueHandler("ToggleSidebar",(function(){return xB.whichSidebar(u)}));var d=Ty(t),m=function(){xB.refreshToolbar(n.outerContainer)};d!==mb.sliding&&d!==mb.floating||t.on("ResizeWindow ResizeEditor ResizeContent",(function(){var n=t.getWin().innerWidth;n!==i.get()&&(m(),i.set(n))}));var g={enable:function(){Uy(n,!1)},disable:function(){Uy(n,!0)},isDisabled:function(){return Gd.isDisabled(u)}};return{iframeContainer:s.element.dom,editorContainer:u.element.dom,api:g}}}),EM=function(t){return/^[0-9\.]+(|px)$/i.test(""+t)?F.some(parseInt(""+t,10)):F.none()},DM=function(t){return m(t)?t+"px":t},AM=function(t,n,e){var o=n.filter((function(n){return t<n})),r=e.filter((function(n){return t>n}));return o.or(r).getOr(t)},BM=function(t){return function(t){var n=hy(t),e=yy(t),o=wy(t);return EM(n).map((function(t){return AM(t,e,o)}))}(t).getOr(hy(t))},MM=function(t){var n=vy(t),e=by(t),o=xy(t);return EM(n).map((function(t){return AM(t,e,o)}))},FM=function(t,n,e,o,r){var i=e.uiMothership,u=e.outerContainer,a=gy.DOM,c=My(t),s=Ry(t),f=xy(t).or(MM(t)),l=o.shared.header,d=l.isPositionedAtTop,m=Ty(t),g=m===mb.sliding||m===mb.floating,p=pr(!1),h=function(){return p.get()&&!t.removed},v=function(t){return g?t.fold(b(0),(function(t){return t.components().length>1?ie(t.components()[1].element):0})):0},y=function(e){switch(Dy(t)){case _y.auto:var o=xB.getToolbar(u),r=v(o),i=ie(e.element)-r,a=Ie(n);if(a.y>i)return"top";var c=yn(n),s=Math.max(c.dom.scrollHeight,ie(c));return a.bottom<s-i||Ne().bottom<a.bottom-i?"bottom":"top";case _y.bottom:return"bottom";case _y.top:default:return"top"}},x=function(){var t=f.getOrThunk((function(){var t=EM(Jn(Nn(),"margin-left")).getOr(0);return me(Nn())-fe(n).left+t}));qn(r.get().element,"max-width",t+"px")},w=function(){var t=xB.getToolbar(u),e=v(t),o=Ie(n),i=d()?Math.max(o.y-ie(r.get().element)+e,0):o.bottom;Yn(u.element,{position:"absolute",top:Math.round(i)+"px",left:Math.round(o.x)+"px"})},S=function(){i.broadcastOn([rl()],{})},k=function(t){if(void 0===t&&(t=!1),h()){if(c||x(),g&&xB.refreshToolbar(u),c||w(),s){var n=r.get();t?MD.reset(n):MD.refresh(n)}S()}},C=function(t){if(void 0===t&&(t=!0),!c&&s&&h()){var n=l.getDockingMode(),e=y(r.get());e!==n&&(function(t){var n=r.get();MD.setModes(n,[t]),l.setDockingMode(t);var e=d()?Nc.TopToBottom:Nc.BottomToTop;Hn(n.element,bs,e)}(e),t&&k(!0))}};return{isVisible:h,isPositionedAtTop:d,show:function(){p.set(!0),qn(u.element,"display","flex"),a.addClass(t.getBody(),"mce-edit-focus"),ne(i.element,"display"),C(!1),k()},hide:function(){p.set(!1),e.outerContainer&&(qn(u.element,"display","none"),a.removeClass(t.getBody(),"mce-edit-focus")),qn(i.element,"display","none")},update:k,updateMode:C,repositionPopups:S}},IM=function(t,n){var e=Ie(t);return{pos:n?e.y:e.bottom,bounds:e}},RM=Object.freeze({__proto__:null,render:function(t,n,e,o,r){var i=n.mothership,u=n.uiMothership,a=n.outerContainer,c=pr(null),s=Ft.fromDom(r.targetNode),f=FM(t,s,n,o,c),l=function(t){return t.getParam("toolbar_persist",!1,"boolean")}(t);AB(t);var d=function(){if(c.get())f.show();else{c.set(xB.getHeader(a).getOrDie());var r=Fy(t);jf(r,i),jf(r,u),CM(t,n,e,o),xB.setMenubar(a,kB(t,e)),f.show(),function(t,n,e,o){var r=pr(IM(n,e.isPositionedAtTop())),i=function(o){var i=IM(n,e.isPositionedAtTop()),u=i.pos,a=i.bounds,c=r.get(),s=c.pos,f=c.bounds,l=a.height!==f.height||a.width!==f.width;r.set({pos:u,bounds:a}),l&&Hx(t,o),e.isVisible()&&(s!==u?e.update(!0):l&&(e.updateMode(),e.repositionPopups()))};o||(t.on("activate",e.show),t.on("deactivate",e.hide)),t.on("SkinLoaded ResizeWindow",(function(){return e.update(!0)})),t.on("NodeChange keydown",(function(t){dh.requestAnimationFrame((function(){return i(t)}))})),t.on("ScrollWindow",(function(){return e.updateMode()}));var u=Xc();u.set(Jc(Ft.fromDom(t.getBody()),"load",i)),t.on("remove",(function(){u.clear()}))}(t,s,f,l),t.nodeChanged()}};t.on("show",d),t.on("hide",f.hide),l||(t.on("focus",d),t.on("blur",f.hide)),t.on("init",(function(){(t.hasFocus()||l)&&d()})),jy(t,n);var m={show:function(){f.show()},hide:function(){f.hide()},enable:function(){Uy(n,!1)},disable:function(){Uy(n,!0)},isDisabled:function(){return Gd.isDisabled(a)}};return{editorContainer:a.element.dom,api:m}}}),NM="contexttoolbar-hide",PM=function(t,n){return Mi(k_,(function(e,o){var r=function(t){return{hide:function(){return ki(t,ui())},getValue:function(){return Sl.getValue(t)}}}(t.get(e));n.onAction(r,o.event.buttonApi)}))},VM=function(t,n,e){var o={backstage:{shared:{providers:e}}};return"contextformtogglebutton"===n.type?function(t,n,e){var o=n.original;o.primary;var r=E(o,["primary"]),i=No(ob(T(T({},r),{type:"togglebutton",onAction:p})));return pM(i,e.backstage.shared.providers,[PM(t,n)])}(t,n,o):function(t,n,e){var o=n.original;o.primary;var r=E(o,["primary"]),i=No(tb(T(T({},r),{type:"button",onAction:p})));return gM(i,e.backstage.shared.providers,[PM(t,n)])}(t,n,o)},HM=function(t,n){var e=t.label.fold((function(){return{}}),(function(t){return{"aria-label":t}})),o=ph(bS.sketch({inputClasses:["tox-toolbar-textfield","tox-toolbar-nav-js"],data:t.initValue(),inputAttributes:e,selectOnFocus:!0,inputBehaviours:gc([$g.config({mode:"special",onEnter:function(t){return r.findPrimary(t).map((function(t){return Oi(t),!0}))},onLeft:function(t,n){return n.cut(),F.none()},onRight:function(t,n){return n.cut(),F.none()}})])})),r=function(t,n,e){var o=U(n,(function(n){return ph(VM(t,n,e))}));return{asSpecs:function(){return U(o,(function(t){return t.asSpec()}))},findPrimary:function(t){return ct(n,(function(n,e){return n.primary?F.from(o[e]).bind((function(n){return n.getOpt(t)})).filter(S(Gd.isDisabled)):F.none()}))}}}(o,t.commands,n);return[{title:F.none(),items:[o.asSpec()]},{title:F.none(),items:r.asSpecs()}]},LM=HM,zM=function(t,n,e){return void 0===e&&(e=.01),n.bottom-t.y>=e&&t.bottom-n.y>=e},UM=function(t){var n=function(t){var n=t.getBoundingClientRect();if(n.height<=0&&n.width<=0){var e=_n(Ft.fromDom(t.startContainer),t.startOffset).element;return(Vt(e)?wn(e):F.some(e)).filter(Pt).map((function(t){return t.dom.getBoundingClientRect()})).getOr(n)}return n}(t.selection.getRng());if(t.inline){var e=_e();return Fe(e.left+n.left,e.top+n.top,n.width,n.height)}var o=Re(Ft.fromDom(t.getBody()));return Fe(o.x+n.left,o.y+n.top,n.width,n.height)},jM=function(t,n,e,o){void 0===o&&(o=0);var r=De(window),i=Ie(Ft.fromDom(t.getContentAreaContainer())),u=Sy(t)||ky(t)||Oy(t),a=function(t,n,e){var o=Math.max(t.x+e,n.x);return{x:o,width:Math.min(t.right-e,n.right)-o}}(i,r,o),c=a.x,s=a.width;if(t.inline&&!u)return Fe(c,r.y,s,r.height);var f=function(t,n,e,o,r,i){var u=Ft.fromDom(t.getContainer()),a=oa(u,".tox-editor-header").getOr(u),c=Ie(a),s=c.y>=n.bottom,f=o&&!s;if(t.inline&&f)return{y:Math.max(c.bottom+i,e.y),bottom:e.bottom};if(t.inline&&!f)return{y:e.y,bottom:Math.min(c.y-i,e.bottom)};var l="line"===r?Ie(u):n;return f?{y:Math.max(c.bottom+i,e.y),bottom:Math.min(l.bottom-i,e.bottom)}:{y:Math.max(l.y+i,e.y),bottom:Math.min(c.y-i,e.bottom)}}(t,i,r,n.header.isPositionedAtTop(),e,o),l=f.y,d=f.bottom;return Fe(c,l,s,d-l)},WM={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"],inset:["tox-pop--inset"]},GM={maxHeightFunction:ss(),maxWidthFunction:UA()},XM=function(t){return"node"===t},qM=function(t,n,e,o,r){var i=UM(t),u=o.lastElement().exists((function(t){return gn(e,t)}));return function(t,n){var e=t.selection.getRng(),o=_n(Ft.fromDom(e.startContainer),e.startOffset);return e.startContainer===e.endContainer&&e.startOffset===e.endOffset-1&&gn(o.element,n)}(t,e)?u?sh:rh:u?function(t,n,e){var o=Qn(t,"position");qn(t,"position",n);var r=e(t);return o.each((function(n){return qn(t,"position",n)})),r}(n,o.getMode(),(function(){return zM(i,Ie(n))&&!o.isReposition()?lh:sh})):("fixed"===o.getMode()?r.y+_e().top:r.y)+(ie(n)+12)<=i.y?rh:ih},YM=function(t,n,e,o){var r=function(n){return function(o,r,i,u,a){var c=qM(t,u,n,e,a),s=T(T({},o),{y:a.y,height:a.height});return T(T({},c(s,r,i,u,a)),{alwaysFit:!0})}},i=function(t){return XM(o)?[r(t)]:[]};return n?{onLtr:function(t){return[Za,Ya,Ka,Ja,$a,Qa].concat(i(t))},onRtl:function(t){return[Za,Ka,Ya,$a,Ja,Qa].concat(i(t))}}:{onLtr:function(t){return[Qa,Za,Ja,Ya,$a,Ka].concat(i(t))},onRtl:function(t){return[Qa,Za,$a,Ka,Ja,Ya].concat(i(t))}}},KM=function(t,n){var e=G(n,(function(n){return n.predicate(t.dom)})),o=W(e,(function(t){return"contexttoolbar"===t.type}));return{contextToolbars:o.pass,contextForms:o.fail}},JM=function(t,n,e){var o=KM(t,n);if(o.contextForms.length>0)return F.some({elem:t,toolbars:[o.contextForms[0]]});var r=KM(t,e);if(r.contextForms.length>0)return F.some({elem:t,toolbars:[r.contextForms[0]]});if(o.contextToolbars.length>0||r.contextToolbars.length>0){var i=function(t){if(t.length<=1)return t;var n=function(n){return H(t,(function(t){return t.position===n}))},e=function(n){return G(t,(function(t){return t.position===n}))},o=n("selection"),r=n("node");if(o||r){if(r&&o){var i=e("node"),u=U(e("selection"),(function(t){return T(T({},t),{position:"node"})}));return i.concat(u)}return e(o?"selection":"node")}return e("line")}(o.contextToolbars.concat(r.contextToolbars));return F.some({elem:t,toolbars:i})}return F.none()},$M=function(t,n,e){return t(n)?F.none():kr(n,(function(t){if(Pt(t)){var n=KM(t,e.inNodeScope),o=n.contextToolbars,r=n.contextForms,i=r.length>0?r:function(t){if(t.length<=1)return t;var n=function(n){return Y(t,(function(t){return t.position===n}))};return n("selection").orThunk((function(){return n("node")})).orThunk((function(){return n("line")})).map((function(t){return t.position})).fold((function(){return[]}),(function(n){return G(t,(function(t){return t.position===n}))}))}(o);return i.length>0?F.some({elem:t,toolbars:i}):F.none()}return F.none()}),t)},QM=function(t,n){var e={},o=[],r=[],i={},u={},a=function(t,a){var c=No(function(t){return Ro("ContextForm",fb,t)}(a));e[t]=c,c.launch.map((function(e){i["form:"+t]=T(T({},a.launch),{type:"contextformtogglebutton"===e.type?"togglebutton":"button",onAction:function(){n(c)}})})),"editor"===c.scope?r.push(c):o.push(c),u[t]=c},c=function(t,n){(function(t){return Ro("ContextToolbar",lb,t)})(n).each((function(e){"editor"===n.scope?r.push(e):o.push(e),u[t]=e}))},s=st(t);return j(s,(function(n){var e=t[n];"contextform"===e.type?a(n,e):"contexttoolbar"===e.type&&c(n,e)})),{forms:e,inNodeScope:o,inEditorScope:r,lookupTable:u,formNavigators:i}},ZM=Qi("forward-slide"),tF=Qi("backward-slide"),nF=Qi("change-slide-event"),eF="tox-pop--resizing",oF="tox-pop--transition",rF=function(t,n,e,o){var r=o.backstage,i=r.shared,u=ln().deviceType.isTouch,a=qc(),c=qc(),s=qc(),f=Yu(function(t){var n=pr([]);return Xp.sketch({dom:{tag:"div",classes:["tox-pop"]},fireDismissalEventInstead:{event:"doNotDismissYet"},onShow:function(t){n.set([]),Xp.getContent(t).each((function(t){ne(t.element,"visibility")})),Fu(t.element,eF),ne(t.element,"width")},inlineBehaviours:gc([rp("context-toolbar-events",[Hi(qr(),(function(t,n){"width"===n.event.raw.propertyName&&(Fu(t.element,eF),ne(t.element,"width"))})),Mi(nF,(function(t,n){var e=t.element;ne(e,"width");var o=me(e);Xp.setContent(t,n.event.contents),Bu(e,eF);var r=me(e);qn(e,"width",o+"px"),Xp.getContent(t).each((function(t){n.event.focus.bind((function(t){return kc(t),_c(e)})).orThunk((function(){return $g.focusIn(t),Oc(An(e))}))})),dh.setTimeout((function(){qn(t.element,"width",r+"px")}),0)})),Mi(ZM,(function(t,e){Xp.getContent(t).each((function(e){n.set(n.get().concat([{bar:e,focus:Oc(An(t.element))}]))})),Ci(t,nF,{contents:e.event.forwardContents,focus:F.none()})})),Mi(tF,(function(t,e){ut(n.get()).each((function(e){n.set(n.get().slice(0,n.get().length-1)),Ci(t,nF,{contents:Ku(e.bar),focus:e.focus})}))}))]),$g.config({mode:"special",onEscape:function(e){return ut(n.get()).fold((function(){return t.onEscape()}),(function(t){return ki(e,tF),F.some(!0)}))}})]),lazySink:function(){return He.value(t.sink)}})}({sink:e,onEscape:function(){return t.focus(),F.some(!0)}})),l=function(){var n=s.get().getOr("node"),e=XM(n)?1:0;return jM(t,i,n,e)},d=function(){return!(t.removed||u()&&r.isContextMenuOpen())},m=function(){if(d()){var n=l(),e=wt(s.get(),"node")?function(t,n){return n.filter(Rn).map(Re).getOrThunk((function(){return UM(t)}))}(t,a.get()):UM(t);return n.height<=0||!zM(e,n)}return!0},g=function(){a.clear(),c.clear(),s.clear(),Xp.hide(f)},h=function(){if(Xp.isOpen(f)){var t=f.element;ne(t,"display"),m()?qn(t,"display","none"):(c.set(0),Xp.reposition(f))}},v=function(n){return{dom:{tag:"div",classes:["tox-pop__dialog"]},components:[n],behaviours:gc([$g.config({mode:"acyclic"}),rp("pop-dialog-wrap-events",[Li((function(n){t.shortcuts.add("ctrl+F9","focus statusbar",(function(){return $g.focusIn(n)}))})),zi((function(n){t.shortcuts.remove("ctrl+F9")}))])])}},b=zt((function(){return QM(n,(function(t){var n=x([t]);Ci(f,ZM,{forwardContents:v(n)})}))})),y=function(n,e){return kM(t,{buttons:n,toolbar:e.items,allowToolbarGroups:!1},o,F.some(["form:"]))},x=function(n){var e=t.ui.registry.getAll().buttons,o=b(),r=T(T({},e),o.formNavigators),u=Ty(t)===mb.scrolling?mb.scrolling:mb.default,a=J(U(n,(function(t){return"contexttoolbar"===t.type?y(r,t):function(t,n){return LM(t,n)}(t,i.providers)})));return dB({type:u,uid:Qi("context-toolbar"),initGroups:a,onEscape:F.none,cyclicKeying:!0,providers:i.providers})},w=function(n,o){var r="node"===n?i.anchors.node(o):i.anchors.cursor(),s=function(t,n,e,o){return"line"===n?{bubble:ms(12,0,WM),layouts:{onLtr:function(){return[tc]},onRtl:function(){return[nc]}},overrides:GM}:{bubble:ms(0,12,WM,1/12),layouts:YM(t,e,o,n),overrides:GM}}(t,n,u(),{lastElement:a.get,isReposition:function(){return wt(c.get(),0)},getMode:function(){return Ff.getMode(e)}});return eo(r,s)},S=function(t,n){if(k.cancel(),d()){var o=x(t),r=t[0].position,i=w(r,n);s.set(r),c.set(1);var u=f.element;ne(u,"display"),function(t){return wt(kt(t,a.get(),gn),!0)}(n)||(Fu(u,oF),Ff.reset(e,f)),Xp.showWithinBounds(f,v(o),{anchor:i,transition:{classes:[oF],mode:"placement"}},(function(){return F.some(l())})),n.fold(a.clear,a.set),m()&&qn(u,"display","none")}},k=Bv((function(){if(t.hasFocus()&&!t.removed)if(Iu(f.element,oF))k.throttle();else{(function(t,n){var e=Ft.fromDom(n.getBody()),o=function(t){return gn(t,e)},r=Ft.fromDom(n.selection.getNode());return function(t){return!o(t)&&!hn(e,t)}(r)?F.none():JM(r,t.inNodeScope,t.inEditorScope).orThunk((function(){return $M(o,r,t)}))})(b(),t).fold(g,(function(t){S(t.toolbars,F.some(t.elem))}))}}),17);t.on("init",(function(){t.on("remove",g),t.on("ScrollContent ScrollWindow ObjectResized ResizeEditor longpress",h),t.on("click keyup focus SetContent",k.throttle),t.on(NM,g),t.on("contexttoolbar-show",(function(n){var e=b();bt(e.lookupTable,n.toolbarKey).each((function(e){S([e],Ct(n.target!==t,n.target)),Xp.getContent(f).each($g.focusIn)}))})),t.on("focusout",(function(n){dh.setEditorTimeout(t,(function(){_c(e.element).isNone()&&_c(f.element).isNone()&&g()}),0)})),t.on("SwitchMode",(function(){t.mode.isReadOnly()&&g()})),t.on("AfterProgressState",(function(n){n.state?g():t.hasFocus()&&k.throttle()})),t.on("NodeChange",(function(t){_c(f.element).fold(k.throttle,p)}))}))},iF={unsupportedLength:["em","ex","cap","ch","ic","rem","lh","rlh","vw","vh","vi","vb","vmin","vmax","cm","mm","Q","in","pc","pt","px"],fixed:["px","pt"],relative:["%"],empty:[""]},uF=function(){var t="[0-9]+",n="[eE][+-]?[0-9]+",e=function(t){return"(?:"+t+")?"},o=["Infinity",t+"\\."+e(t)+e(n),"\\."+t+e(n),t+e(n)].join("|");return new RegExp("^("+("[+-]?(?:"+o+")")+")(.*)$")}(),aF=function(t,n){return F.from(uF.exec(t)).bind((function(t){var e=Number(t[1]),o=t[2];return function(t,n){return H(n,(function(n){return H(iF[n],(function(n){return t===n}))}))}(o,n)?F.some({value:e,unit:o}):F.none()}))},cF=function(t,n){var e=function(){var e=n.getOptions(t),o=n.getCurrent(t).map(n.hash),r=qc();return U(e,(function(e){return{type:"togglemenuitem",text:n.display(e),onSetup:function(i){var u=function(t){t&&(r.on((function(t){return t.setActive(!1)})),r.set(i)),i.setActive(t)};u(wt(o,n.hash(e)));var a=n.watcher(t,e,u);return function(){r.clear(),a()}},onAction:function(){return n.setCurrent(t,e)}}}))};t.ui.registry.addMenuButton(n.name,{tooltip:n.text,icon:n.icon,fetch:function(t){return t(e())},onSetup:n.onToolbarSetup}),t.ui.registry.addNestedMenuItem(n.name,{type:"nestedmenuitem",text:n.text,getSubmenuItems:e,onSetup:n.onMenuSetup})},sF={name:"lineheight",text:"Line height",icon:"line-height",getOptions:function(t){return t.getParam("lineheight_formats","1 1.1 1.2 1.3 1.4 1.5 2","string").split(" ")},hash:function(t){return function(t,n){return aF(t,n).map((function(t){return t.value+t.unit}))}(t,["fixed","relative","empty"]).getOr(t)},display:y,watcher:function(t,n,e){return t.formatter.formatChanged("lineheight",e,!1,{value:n}).unbind},getCurrent:function(t){return F.from(t.queryCommandValue("LineHeight"))},setCurrent:function(t,n){return t.execCommand("LineHeight",!1,n)}},fF=function(t){cF(t,sF),function(t){return F.from(function(t){return t.getParam("content_langs",void 0,"array")}(t)).map((function(n){return{name:"language",text:"Language",icon:"language",getOptions:b(n),hash:function(t){return s(t.customCode)?t.code:t.code+"/"+t.customCode},display:function(t){return t.title},watcher:function(t,n,e){return t.formatter.formatChanged("lang",e,!1,{value:n.code,customValue:n.customCode}).unbind},getCurrent:function(t){var n=Ft.fromDom(t.selection.getNode());return Cr(n,(function(t){return F.some(t).filter(Pt).bind((function(t){return Un(t,"lang").map((function(n){return{code:n,customCode:Un(t,"data-mce-lang").getOrUndefined(),title:""}}))}))}))},setCurrent:function(t,n){return t.execCommand("Lang",!1,n)},onToolbarSetup:function(n){var e=Xc();return n.setActive(t.formatter.match("lang",{},void 0,!0)),e.set(t.formatter.formatChanged("lang",n.setActive,!0)),e.clear}}}))}(t).each((function(n){return cF(t,n)}))},lF=function(t,n){(function(t,n){var e=NB(0,n,zB(t));t.ui.registry.addNestedMenuItem("align",{text:n.shared.providers.translate("Align"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})})(t,n),function(t,n){var e=NB(0,n,WB(t));t.ui.registry.addNestedMenuItem("fontformats",{text:n.shared.providers.translate("Fonts"),getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=T({type:"advanced"},n.styleselect),o=NB(0,n,$B(t,e));t.ui.registry.addNestedMenuItem("formats",{text:"Formats",getSubmenuItems:function(){return o.items.validateItems(o.getStyleItems())}})}(t,n),function(t,n){var e=NB(0,n,JB(t));t.ui.registry.addNestedMenuItem("blockformats",{text:"Blocks",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n),function(t,n){var e=NB(0,n,YB(t));t.ui.registry.addNestedMenuItem("fontsizes",{text:"Font sizes",getSubmenuItems:function(){return e.items.validateItems(e.getStyleItems())}})}(t,n)},dF=function(t){return MB(t,"NodeChange",(function(n){n.setDisabled(!t.queryCommandState("outdent"))}))},mF=function(t){!function(t){t.ui.registry.addButton("outdent",{tooltip:"Decrease indent",icon:"outdent",onSetup:dF(t),onAction:IB(t,"outdent")}),t.ui.registry.addButton("indent",{tooltip:"Increase indent",icon:"indent",onAction:IB(t,"indent")})}(t)},gF=function(t,n){return function(){t.execCommand("mceToggleFormat",!1,n)}},pF=function(t){(function(t){gO.each([{name:"bold",text:"Bold",icon:"bold"},{name:"italic",text:"Italic",icon:"italic"},{name:"underline",text:"Underline",icon:"underline"},{name:"strikethrough",text:"Strikethrough",icon:"strike-through"},{name:"subscript",text:"Subscript",icon:"subscript"},{name:"superscript",text:"Superscript",icon:"superscript"}],(function(n,e){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onSetup:BB(t,n.name),onAction:gF(t,n.name)})}));for(var n=1;n<=6;n++){var e="h"+n;t.ui.registry.addToggleButton(e,{text:e.toUpperCase(),tooltip:"Heading "+n,onSetup:BB(t,e),onAction:gF(t,e)})}})(t),function(t){gO.each([{name:"cut",text:"Cut",action:"Cut",icon:"cut"},{name:"copy",text:"Copy",action:"Copy",icon:"copy"},{name:"paste",text:"Paste",action:"Paste",icon:"paste"},{name:"help",text:"Help",action:"mceHelp",icon:"help"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all"},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document"},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting"},{name:"remove",text:"Remove",action:"Delete",icon:"remove"}],(function(n){t.ui.registry.addButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.action)})}))}(t),function(t){gO.each([{name:"blockquote",text:"Blockquote",action:"mceBlockQuote",icon:"quote"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.action),onSetup:BB(t,n.name)})}))}(t)},hF=function(t){pF(t),function(t){gO.each([{name:"bold",text:"Bold",action:"Bold",icon:"bold",shortcut:"Meta+B"},{name:"italic",text:"Italic",action:"Italic",icon:"italic",shortcut:"Meta+I"},{name:"underline",text:"Underline",action:"Underline",icon:"underline",shortcut:"Meta+U"},{name:"strikethrough",text:"Strikethrough",action:"Strikethrough",icon:"strike-through",shortcut:""},{name:"subscript",text:"Subscript",action:"Subscript",icon:"subscript",shortcut:""},{name:"superscript",text:"Superscript",action:"Superscript",icon:"superscript",shortcut:""},{name:"removeformat",text:"Clear formatting",action:"RemoveFormat",icon:"remove-formatting",shortcut:""},{name:"newdocument",text:"New document",action:"mceNewDocument",icon:"new-document",shortcut:""},{name:"cut",text:"Cut",action:"Cut",icon:"cut",shortcut:"Meta+X"},{name:"copy",text:"Copy",action:"Copy",icon:"copy",shortcut:"Meta+C"},{name:"paste",text:"Paste",action:"Paste",icon:"paste",shortcut:"Meta+V"},{name:"selectall",text:"Select all",action:"SelectAll",icon:"select-all",shortcut:"Meta+A"}],(function(n){t.ui.registry.addMenuItem(n.name,{text:n.text,icon:n.icon,shortcut:n.shortcut,onAction:IB(t,n.action)})})),t.ui.registry.addMenuItem("codeformat",{text:"Code",icon:"sourcecode",onAction:gF(t,"code")})}(t)},vF=function(t,n){return MB(t,"Undo Redo AddUndo TypingUndo ClearUndos SwitchMode",(function(e){e.setDisabled(t.mode.isReadOnly()||!t.undoManager[n]())}))},bF=function(t){(function(t){t.ui.registry.addMenuItem("undo",{text:"Undo",icon:"undo",shortcut:"Meta+Z",onSetup:vF(t,"hasUndo"),onAction:IB(t,"undo")}),t.ui.registry.addMenuItem("redo",{text:"Redo",icon:"redo",shortcut:"Meta+Y",onSetup:vF(t,"hasRedo"),onAction:IB(t,"redo")})})(t),function(t){t.ui.registry.addButton("undo",{tooltip:"Undo",icon:"undo",disabled:!0,onSetup:vF(t,"hasUndo"),onAction:IB(t,"undo")}),t.ui.registry.addButton("redo",{tooltip:"Redo",icon:"redo",disabled:!0,onSetup:vF(t,"hasRedo"),onAction:IB(t,"redo")})}(t)},yF=function(t){return MB(t,"VisualAid",(function(n){n.setActive(t.hasVisual)}))},xF=function(t){(function(t){t.ui.registry.addButton("visualaid",{tooltip:"Visual aids",text:"Visual aids",onAction:IB(t,"mceToggleVisualAid")})})(t),function(t){t.ui.registry.addToggleMenuItem("visualaid",{text:"Visual aids",onSetup:yF(t),onAction:IB(t,"mceToggleVisualAid")})}(t)},wF=function(t,n){(function(t){j([{name:"alignleft",text:"Align left",cmd:"JustifyLeft",icon:"align-left"},{name:"aligncenter",text:"Align center",cmd:"JustifyCenter",icon:"align-center"},{name:"alignright",text:"Align right",cmd:"JustifyRight",icon:"align-right"},{name:"alignjustify",text:"Justify",cmd:"JustifyFull",icon:"align-justify"}],(function(n){t.ui.registry.addToggleButton(n.name,{tooltip:n.text,icon:n.icon,onAction:IB(t,n.cmd),onSetup:BB(t,n.name)})})),t.ui.registry.addButton("alignnone",{tooltip:"No alignment",icon:"align-none",onAction:IB(t,"JustifyNone")})})(t),hF(t),lF(t,n),bF(t),function(t){!function(t){t.addCommand("mceApplyTextcolor",(function(n,e){!function(t,n,e){t.undoManager.transact((function(){t.focus(),t.formatter.apply(n,{value:e}),t.nodeChanged()}))}(t,n,e)})),t.addCommand("mceRemoveTextcolor",(function(n){!function(t,n){t.undoManager.transact((function(){t.focus(),t.formatter.remove(n,{value:null},null,!0),t.nodeChanged()}))}(t,n)}))}(t);var n=pr(Zx),e=pr(Zx);uw(t,"forecolor","forecolor","Text color",n),uw(t,"backcolor","hilitecolor","Background color",e),aw(t,"forecolor","forecolor","Text color"),aw(t,"backcolor","hilitecolor","Background color")}(t),xF(t),mF(t),fF(t)},SF=function(t,n){return{type:"makeshift",x:t,y:n}},kF=function(t){return"longpress"===t.type||0===t.type.indexOf("touch")},CF=function(t,n){var e=gy.DOM.getPos(t);return function(t,n,e){return SF(t.x+n,t.y+e)}(n,e.x,e.y)},OF=function(t,n){return"contextmenu"===n.type||"longpress"===n.type?t.inline?function(t){if(kF(t)){var n=t.touches[0];return SF(n.pageX,n.pageY)}return SF(t.pageX,t.pageY)}(n):CF(t.getContentAreaContainer(),function(t){if(kF(t)){var n=t.touches[0];return SF(n.clientX,n.clientY)}return SF(t.clientX,t.clientY)}(n)):_F(t)},_F=function(t){return{type:"selection",root:Ft.fromDom(t.selection.getNode())}},TF=function(t,n,e){switch(e){case"node":return function(t){return{type:"node",node:F.some(Ft.fromDom(t.selection.getNode())),root:Ft.fromDom(t.getBody())}}(t);case"point":return OF(t,n);case"selection":return _F(t)}},EF=function(t,n,e,o,r,i){var u=e(),a=TF(t,n,i);I_(u,gb.CLOSE_ON_EXECUTE,o,!1).map((function(t){n.preventDefault(),Xp.showMenuAt(r,{anchor:a},{menu:{markers:Db("normal")},data:t})}))},DF={onLtr:function(){return[Za,Ya,Ka,Ja,$a,Qa,rh,ih,oh,nh,eh,th]},onRtl:function(){return[Za,Ka,Ya,$a,Ja,Qa,rh,ih,eh,th,oh,nh]}},AF={valignCentre:[],alignCentre:[],alignLeft:["tox-pop--align-left"],alignRight:["tox-pop--align-right"],right:["tox-pop--right"],left:["tox-pop--left"],bottom:["tox-pop--bottom"],top:["tox-pop--top"]},BF=function(t,n,e,o,r,i,u){var a=function(t,n,e){var o=TF(t,n,e);return T({bubble:ms(0,"point"===e?12:0,AF),layouts:DF,overrides:{maxWidthFunction:UA(),maxHeightFunction:ss()}},o)}(t,n,i);I_(e,gb.CLOSE_ON_EXECUTE,o,!0).map((function(e){n.preventDefault(),Xp.showMenuWithinBounds(r,{anchor:a},{menu:{markers:Db("normal"),highlightImmediately:u},data:e,type:"horizontal"},(function(){return F.some(jM(t,o.shared,"node"===i?"node":"selection"))})),t.fire(NM)}))},MF=function(t,n,e,o,r,i){var u=ln(),a=u.os.isiOS(),c=u.os.isOSX(),s=u.os.isAndroid(),f=u.deviceType.isTouch(),l=function(){var u=e();BF(t,n,u,o,r,i,!(s||a||c&&f))};if((c||a)&&"node"!==i){var d=function(){(function(t){var n=t.selection.getRng(),e=function(){dh.setEditorTimeout(t,(function(){t.selection.setRng(n)}),10),i()};t.once("touchend",e);var o=function(t){t.preventDefault(),t.stopImmediatePropagation()};t.on("mousedown",o,!0);var r=function(){return i()};t.once("longpresscancel",r);var i=function(){t.off("touchend",e),t.off("longpresscancel",r),t.off("mousedown",o)}})(t),l()};!function(t,n){var e=t.selection;if(e.isCollapsed()||n.touches.length<1)return!1;var o=n.touches[0],r=e.getRng();return rf(t.getWin(),Hs.domRange(r)).exists((function(t){return t.left<=o.clientX&&t.right>=o.clientX&&t.top<=o.clientY&&t.bottom>=o.clientY}))}(t,n)?(t.once("selectionchange",d),t.once("touchend",(function(){return t.off("selectionchange",d)}))):d()}else l()},FF=function(t){return"string"==typeof t?t.split(/[ ,]/):t},IF=function(t){return t.getParam("contextmenu_never_use_native",!1,"boolean")},RF=function(t){return function(t,n,e){var o=t.ui.registry.getAll().contextMenus;return F.from(t.getParam(n)).map(FF).getOrThunk((function(){return G(FF(e),(function(t){return yt(o,t)}))}))}(t,"contextmenu","link linkchecker image imagetools table spellchecker configurepermanentpen")},NF=function(t){return r(t)?"|"===t:"separator"===t.type},PF={type:"separator"},VF=function(t){var n=function(t){return{text:t.text,icon:t.icon,disabled:t.disabled,shortcut:t.shortcut}};if(r(t))return t;switch(t.type){case"separator":return PF;case"submenu":return T(T({type:"nestedmenuitem"},n(t)),{getSubmenuItems:function(){var n=t.getSubmenuItems();return r(n)?n:U(n,VF)}});default:return T(T({type:"menuitem"},n(t)),{onAction:h(t.onAction)})}},HF=function(t,n){if(0===n.length)return t;var e=ut(t).filter((function(t){return!NF(t)})).fold((function(){return[]}),(function(t){return[PF]}));return t.concat(e).concat(n).concat([PF])},LF=function(t,n,e){var o=q(n,(function(n,o){return bt(t,o.toLowerCase()).map((function(t){var o=t.update(e);if(r(o))return HF(n,o.split(" "));if(o.length>0){var i=U(o,VF);return HF(n,i)}return n})).getOrThunk((function(){return n.concat([o])}))}),[]);return o.length>0&&NF(o[o.length-1])&&o.pop(),o},zF=function(t,n){return"longpress"!==n.type&&(2!==n.button||n.target===t.getBody()&&""===n.pointerType)},UF=function(t,n){return zF(t,n)?t.selection.getStart(!0):n.target},jF=function(t,n,e){var o=ln().deviceType.isTouch,r=Yu(Xp.sketch({dom:{tag:"div"},lazySink:n,onEscape:function(){return t.focus()},onShow:function(){return e.setContextMenuState(!0)},onHide:function(){return e.setContextMenuState(!1)},fireDismissalEventInstead:{},inlineBehaviours:gc([rp("dismissContextMenu",[Mi(pi(),(function(n,e){el.close(n),t.focus()}))])])})),i=function(t){return Xp.hide(r)},u=function(n){if(IF(t)&&n.preventDefault(),!function(t,n){return n.ctrlKey&&!IF(t)}(t,n)&&!function(t){return!1===t.getParam("contextmenu")}(t)){var i=function(t,n){var e=function(t){return t.getParam("contextmenu_avoid_overlap","","string")}(t),o=zF(t,n)?"selection":"point";if(At(e)){var r=UF(t,n);return Mw(Ft.fromDom(r),e)?"node":o}return o}(t,n);(o()?MF:EF)(t,n,(function(){var e=UF(t,n),o=t.ui.registry.getAll(),r=RF(t);return LF(o.contextMenus,r,e)}),e,r,i)}};t.on("init",(function(){var n="ResizeEditor ScrollContent ScrollWindow longpresscancel"+(o()?"":" ResizeWindow");t.on(n,i),t.on("longpress contextmenu",u)}))},WF=hr([{offset:["x","y"]},{absolute:["x","y"]},{fixed:["x","y"]}]),GF=function(t){return function(n){return n.translate(-t.left,-t.top)}},XF=function(t){return function(n){return n.translate(t.left,t.top)}},qF=function(t){return function(n,e){return q(t,(function(t,n){return n(t)}),ce(n,e))}},YF=function(t,n,e){return t.fold(qF([XF(e),GF(n)]),qF([GF(n)]),qF([]))},KF=function(t,n,e){return t.fold(qF([XF(e)]),qF([]),qF([XF(n)]))},JF=function(t,n,e){return t.fold(qF([]),qF([GF(e)]),qF([XF(n),GF(e)]))},$F=function(t,n,e){var o=t.fold((function(t,n){return{position:F.some("absolute"),left:F.some(t+"px"),top:F.some(n+"px")}}),(function(t,n){return{position:F.some("absolute"),left:F.some(t-e.left+"px"),top:F.some(n-e.top+"px")}}),(function(t,n){return{position:F.some("fixed"),left:F.some(t+"px"),top:F.some(n+"px")}}));return T({right:F.none(),bottom:F.none()},o)},QF=function(t,n,e,o){var r=function(t,r){return function(i,u){var a=t(n,e,o);return r(i.getOr(a.left),u.getOr(a.top))}};return t.fold(r(JF,ZF),r(KF,tI),r(YF,nI))},ZF=WF.offset,tI=WF.absolute,nI=WF.fixed,eI=function(t,n){var e=zn(t,n);return s(e)?NaN:parseInt(e,10)},oI=function(t,n,e,o){return function(t,n){var e=t.element,o=eI(e,n.leftAttr),r=eI(e,n.topAttr);return isNaN(o)||isNaN(r)?F.none():F.some(ce(o,r))}(t,n).fold((function(){return e}),(function(t){return nI(t.left+o.left,t.top+o.top)}))},rI=function(t,n,e,o,r,i){var u=oI(t,n,e,o),a=n.mustSnap?aI(t,n,u,r,i):cI(t,n,u,r,i),c=YF(u,r,i);return function(t,n,e){var o=t.element;Hn(o,n.leftAttr,e.left+"px"),Hn(o,n.topAttr,e.top+"px")}(t,n,c),a.fold((function(){return{coord:nI(c.left,c.top),extra:F.none()}}),(function(t){return{coord:t.output,extra:t.extra}}))},iI=function(t,n){!function(t,n){var e=t.element;Wn(e,n.leftAttr),Wn(e,n.topAttr)}(t,n)},uI=function(t,n,e,o){return ct(t,(function(t){var r=t.sensor;return function(t,n,e,o,r,i){var u=KF(t,r,i),a=KF(n,r,i);return Math.abs(u.left-a.left)<=e&&Math.abs(u.top-a.top)<=o}(n,r,t.range.left,t.range.top,e,o)?F.some({output:QF(t.output,n,e,o),extra:t.extra}):F.none()}))},aI=function(t,n,e,o,r){var i=n.getSnapPoints(t);return uI(i,e,o,r).orThunk((function(){return q(i,(function(t,n){var i=n.sensor,u=function(t,n,e,o,r,i){var u=KF(t,r,i),a=KF(n,r,i),c=Math.abs(u.left-a.left),s=Math.abs(u.top-a.top);return ce(c,s)}(e,i,n.range.left,n.range.top,o,r);return t.deltas.fold((function(){return{deltas:F.some(u),snap:F.some(n)}}),(function(e){return(u.left+u.top)/2<=(e.left+e.top)/2?{deltas:F.some(u),snap:F.some(n)}:t}))}),{deltas:F.none(),snap:F.none()}).snap.map((function(t){return{output:QF(t.output,e,o,r),extra:t.extra}}))}))},cI=function(t,n,e,o,r){var i=n.getSnapPoints(t);return uI(i,e,o,r)},sI=Object.freeze({__proto__:null,snapTo:function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=vn(t.element),u=_e(i),a=mD(r),c=function(t,n,e){return{coord:QF(t.output,t.output,n,e),extra:t.extra}}(o,u,a),s=$F(c.coord,0,a);Kn(r,s)}}}),fI="data-initial-z-index",lI=function(t,n){t.getSystem().addToGui(n),function(t){wn(t.element).filter(Pt).each((function(n){Qn(n,"z-index").each((function(t){Hn(n,fI,t)})),qn(n,"z-index",Jn(t.element,"z-index"))}))}(n)},dI=function(t){(function(t){wn(t.element).filter(Pt).each((function(t){Un(t,fI).fold((function(){return ne(t,"z-index")}),(function(n){return qn(t,"z-index",n)})),Wn(t,fI)}))})(t),t.getSystem().removeFromGui(t)},mI=function(t,n,e){return t.getSystem().build(Xw.sketch({dom:{styles:{left:"0px",top:"0px",width:"100%",height:"100%",position:"fixed","z-index":"1000000000000000"},classes:[n]},events:e}))},gI=rr("snaps",[jo("getSnapPoints"),wa("onSensor"),jo("leftAttr"),jo("topAttr"),ur("lazyViewport",Ne),ur("mustSnap",!1)]),pI=[ur("useFixed",C),jo("blockerClass"),ur("getTarget",y),ur("onDrag",p),ur("repositionTarget",!0),ur("onDrop",p),dr("getBounds",Ne),gI],hI=function(t){return function(t,n,e,o){return t.isSome()&&n.isSome()&&e.isSome()?F.some(o(t.getOrDie(),n.getOrDie(),e.getOrDie())):F.none()}(Qn(t,"left"),Qn(t,"top"),Qn(t,"position"),(function(t,n,e){return("fixed"===e?nI:ZF)(parseInt(t,10),parseInt(n,10))})).getOrThunk((function(){var n=fe(t);return tI(n.left,n.top)}))},vI=function(t,n,e,o,r,i,u){return function(t,n,e,o,r){var i=r.bounds,u=KF(n,e,o),a=Ha(u.left,i.x,i.x+i.width-r.width),c=Ha(u.top,i.y,i.y+i.height-r.height),s=tI(a,c);return n.fold((function(){var t=JF(s,e,o);return ZF(t.left,t.top)}),b(s),(function(){var t=YF(s,e,o);return nI(t.left,t.top)}))}(0,n.fold((function(){var t=function(t,n,e){return t.fold((function(t,o){return ZF(t+n,o+e)}),(function(t,o){return tI(t+n,o+e)}),(function(t,o){return nI(t+n,o+e)}))}(e,i.left,i.top),n=YF(t,o,r);return nI(n.left,n.top)}),(function(n){var u=rI(t,n,e,i,o,r);return u.extra.each((function(e){n.onSensor(t,e)})),u.coord})),o,r,u)},bI=function(t,n){return{bounds:t.getBounds(),height:ue(n.element),width:ge(n.element)}},yI=function(t,n,e,o,r){var i=e.update(o,r),u=e.getStartData().getOrThunk((function(){return bI(n,t)}));i.each((function(e){!function(t,n,e,o){var r=n.getTarget(t.element);if(n.repositionTarget){var i=vn(t.element),u=_e(i),a=mD(r),c=hI(r),s=vI(t,n.snaps,c,u,a,o,e),f=$F(s,0,a);Kn(r,f)}n.onDrag(t,r,o)}(t,n,u,e)}))},xI=function(t,n,e,o){n.each(dI),e.snaps.each((function(n){iI(t,n)}));var r=e.getTarget(t.element);o.reset(),e.onDrop(t,r)},wI=function(t){return function(n,e){var o=function(t){e.setStartData(bI(n,t))};return Di(D([Mi(li(),(function(t){e.getStartData().each((function(){return o(t)}))}))],t(n,e,o),!0))}},SI=Object.freeze({__proto__:null,getData:function(t){return F.from(ce(t.x,t.y))},getDelta:function(t,n){return ce(n.left-t.left,n.top-t.top)}}),kI=function(t,n,e){return[Mi(Ir(),(function(o,r){if(0===r.event.raw.button){r.stop();var i=function(){return xI(o,F.some(c),t,n)},u=Fw(i,200),a={drop:i,delayDrop:u.schedule,forceDrop:i,move:function(e){u.cancel(),yI(o,t,n,SI,e)}},c=mI(o,t.blockerClass,function(t){return Di([Mi(Ir(),t.forceDrop),Mi(Pr(),t.drop),Mi(Rr(),(function(n,e){t.move(e.event)})),Mi(Nr(),t.delayDrop)])}(a));e(o),lI(o,c)}}))]},CI=D(D([],pI,!0),[Oa("dragger",{handlers:wI(kI)})],!1),OI=Object.freeze({__proto__:null,getData:function(t){var n=t.raw.touches;return 1===n.length?function(t){var n=t[0];return F.some(ce(n.clientX,n.clientY))}(n):F.none()},getDelta:function(t,n){return ce(n.left-t.left,n.top-t.top)}}),_I=function(t,n,e){var o=qc(),r=function(e){xI(e,o.get(),t,n),o.clear()};return[Mi(Ar(),(function(i,u){u.stop();var a=function(){return r(i)},c={drop:a,delayDrop:p,forceDrop:a,move:function(e){yI(i,t,n,OI,e)}},s=mI(i,t.blockerClass,function(t){return Di([Mi(Ar(),t.forceDrop),Mi(Mr(),t.drop),Mi(Fr(),t.drop),Mi(Br(),(function(n,e){t.move(e.event)}))])}(c));o.set(s);e(i),lI(i,s)})),Mi(Br(),(function(e,o){o.stop(),yI(e,t,n,OI,o.event)})),Mi(Mr(),(function(t,n){n.stop(),r(t)})),Mi(Fr(),r)]},TI=CI,EI=D(D([],pI,!0),[Oa("dragger",{handlers:wI(_I)})],!1),DI=D(D([],pI,!0),[Oa("dragger",{handlers:wI((function(t,n,e){return D(D([],kI(t,n,e),!0),_I(t,n,e),!0)}))})],!1),AI=bc({branchKey:"mode",branches:Object.freeze({__proto__:null,mouse:TI,touch:EI,mouseOrTouch:DI}),name:"dragging",active:{events:function(t,n){return t.dragger.handlers(t,n)}},extra:{snap:function(t){return{sensor:t.sensor,range:t.range,output:t.output,extra:F.from(t.extra)}}},state:Object.freeze({__proto__:null,init:function(){var t=F.none(),n=F.none(),e=function(n,e){var o=t.map((function(t){return n.getDelta(t,e)}));return t=F.some(e),o},o=b({});return pu({readState:o,reset:function(){t=F.none(),n=F.none()},update:function(t,n){return t.getData(n).bind((function(n){return e(t,n)}))},getStartData:function(){return n},setStartData:function(t){n=F.some(t)}})}}),apis:sI}),BI=function(t,n,e,o,r,i){return t.fold((function(){return AI.snap({sensor:tI(e-20,o-20),range:ce(r,i),output:tI(F.some(e),F.some(o)),extra:{td:n}})}),(function(t){var r=e-20,i=o-20,u=t.element.dom.getBoundingClientRect();return AI.snap({sensor:tI(r,i),range:ce(40,40),output:tI(F.some(e-u.width/2),F.some(o-u.height/2)),extra:{td:n}})}))},MI=function(t,n,e){return{getSnapPoints:t,leftAttr:"data-drag-left",topAttr:"data-drag-top",onSensor:function(t,o){var r=o.td;(function(t,n){return t.exists((function(t){return gn(t,n)}))})(n.get(),r)||(n.set(r),e(r))},mustSnap:!0}},FI=function(t){return ph(mh.sketch({dom:{tag:"div",classes:["tox-selector"]},buttonBehaviours:gc([AI.config({mode:"mouseOrTouch",blockerClass:"blocker",snaps:t}),uk.config({})]),eventOrder:{mousedown:["dragging","alloy.base.behaviour"],touchstart:["dragging","alloy.base.behaviour"]}}))},II=function(t,n){var e=pr([]),o=pr([]),r=pr(!1),i=qc(),u=qc(),a=function(t){var e=Re(t);return BI(l.getOpt(n),t,e.x,e.y,e.width,e.height)},c=function(t){var e=Re(t);return BI(d.getOpt(n),t,e.right,e.bottom,e.width,e.height)},s=MI((function(){return U(e.get(),(function(t){return a(t)}))}),i,(function(n){u.get().each((function(e){t.fire("TableSelectorChange",{start:n,finish:e})}))})),f=MI((function(){return U(o.get(),(function(t){return c(t)}))}),u,(function(n){i.get().each((function(e){t.fire("TableSelectorChange",{start:e,finish:n})}))})),l=FI(s),d=FI(f),m=Yu(l.asSpec()),g=Yu(d.asSpec()),p=function(n,e,o,r){var i=e.dom.getBoundingClientRect();ne(n.element,"display");var u=xn(Ft.fromDom(t.getBody())).dom.innerHeight,a=o(i),c=r(i,u);(a||c)&&qn(n.element,"display","none")},h=function(t,n,e,o){var r=e(n);AI.snapTo(t,r);p(t,n,(function(t){return t[o]<0}),(function(t,n){return t[o]>n}))},v=function(t){return h(m,t,a,"top")},b=function(t){return h(g,t,c,"bottom")};ln().deviceType.isTouch()&&(t.on("TableSelectionChange",(function(t){r.get()||(Vf(n,m),Vf(n,g),r.set(!0)),i.set(t.start),u.set(t.finish),t.otherCells.each((function(n){e.set(n.upOrLeftCells),o.set(n.downOrRightCells),v(t.start),b(t.finish)}))})),t.on("ResizeEditor ResizeWindow ScrollContent",(function(){i.get().each(v),u.get().each(b)})),t.on("TableSelectionClear",(function(){r.get()&&(zf(m),zf(g),r.set(!1)),i.clear(),u.clear()})))},RI=function(t){if(1===t.nodeType){if("BR"===t.nodeName||t.getAttribute("data-mce-bogus"))return!0;if("bookmark"===t.getAttribute("data-mce-type"))return!0}return!1};!function(t){t[t.None=0]="None",t[t.Both=1]="Both",t[t.Vertical=2]="Vertical"}(VB||(VB={}));var NI=function(t,n,e){var o=Ft.fromDom(t.getContainer()),r=function(t,n,e,o,r){var i={};return i.height=AM(o+n.top,yy(t),wy(t)),e===VB.Both&&(i.width=AM(r+n.left,by(t),xy(t))),i}(t,n,e,ie(o),me(o));lt(r,(function(t,n){return qn(o,n,DM(t))})),function(t){t.fire("ResizeEditor")}(t)},PI=function(t,n,e,o){var r=ce(20*e,20*o);return NI(t,r,n),F.some(!0)},VI=function(t,n){var e=function(t){var n=!t.hasPlugin("autoresize"),e=t.getParam("resize",n);return!1===e?VB.None:"both"===e?VB.Both:VB.Vertical}(t);return e===VB.None?F.none():F.some(Ov("resize-handle",{tag:"div",classes:["tox-statusbar__resize-handle"],attributes:{title:n.translate("Resize")},behaviours:[AI.config({mode:"mouse",repositionTarget:!1,onDrag:function(n,o,r){return NI(t,r,e)},blockerClass:"tox-blocker"}),$g.config({mode:"special",onLeft:function(){return PI(t,e,-1,0)},onRight:function(){return PI(t,e,1,0)},onUp:function(){return PI(t,e,0,-1)},onDown:function(){return PI(t,e,0,1)}}),Zw.config({}),sp.config({})]},n.icons))},HI=function(t,n){var e=function(){var e=[];return t.getParam("elementpath",!0,"boolean")&&e.push(function(t,n,e){n.delimiter||(n.delimiter="»");var o=function(o){var r=U(o||[],(function(n,o){return mh.sketch({dom:{tag:"div",classes:["tox-statusbar__path-item"],attributes:{role:"button","data-index":o,"tab-index":-1,"aria-level":o+1},innerHtml:n.name},action:function(e){t.focus(),t.selection.select(n.element),t.nodeChanged()},buttonBehaviours:gc([Xy(e.isDisabled),Wy()])})})),i={dom:{tag:"div",classes:["tox-statusbar__path-divider"],attributes:{"aria-hidden":!0},innerHtml:" "+n.delimiter+" "}};return q(r.slice(1),(function(t,n){var e=t;return e.push(i),e.push(n),e}),[r[0]])},r=function(n){for(var e=[],o=n.length;o-- >0;){var r=n[o];if(1===r.nodeType&&!RI(r)){var i=t.fire("ResolveName",{name:r.nodeName.toLowerCase(),target:r});if(i.isDefaultPrevented()||e.push({name:i.name,element:r}),i.isPropagationStopped())break}}return e};return{dom:{tag:"div",classes:["tox-statusbar__path"],attributes:{role:"navigation"}},behaviours:gc([$g.config({mode:"flow",selector:"div[role=button]"}),Gd.config({disabled:e.isDisabled}),Wy(),Zw.config({}),op.config({}),rp("elementPathEvents",[Li((function(n,e){t.shortcuts.add("alt+F11","focus statusbar elementpath",(function(){return $g.focusIn(n)})),t.on("NodeChange",(function(t){var e=r(t.parents);e.length>0?op.set(n,o(e)):op.set(n,[])}))}))])]),components:[]}}(t,{},n)),t.hasPlugin("wordcount")&&e.push(function(t,n){var e,o=function(t,e,o){return op.set(t,[Gu(n.translate(["{0} "+o,e[o]]))])};return mh.sketch({dom:{tag:"button",classes:["tox-statusbar__wordcount"]},components:[],buttonBehaviours:gc([Xy(n.isDisabled),Wy(),Zw.config({}),op.config({}),Sl.config({store:{mode:"memory",initialValue:{mode:"words",count:{words:0,characters:0}}}}),rp("wordcount-events",[ji((function(t){var n=Sl.getValue(t),e="words"===n.mode?"characters":"words";Sl.setValue(t,{mode:e,count:n.count}),o(t,n.count,e)})),Li((function(n){t.on("wordCountUpdate",(function(t){var e=Sl.getValue(n).mode;Sl.setValue(n,{mode:e,count:t.wordCount}),o(n,t.wordCount,e)}))}))])]),eventOrder:(e={},e[ei()]=["disabling","alloy.base.behaviour","wordcount-events"],e)})}(t,n)),t.getParam("branding",!0,"boolean")&&e.push(function(){var t=hv.translate(["Powered by {0}","Tiny"]);return{dom:{tag:"span",classes:["tox-statusbar__branding"],innerHtml:'<a href="https://www.tiny.cloud/?utm_campaign=editor_referral&amp;utm_medium=poweredby&amp;utm_source=tinymce&amp;utm_content=v5" rel="noopener" target="_blank" tabindex="-1" aria-label="'+t+'">'+t+"</a>"}}}()),e.length>0?[{dom:{tag:"div",classes:["tox-statusbar__text-container"]},components:e}]:[]};return{dom:{tag:"div",classes:["tox-statusbar"]},components:function(){var o=e(),r=VI(t,n);return o.concat(r.toArray())}()}},LI=function(t){var n,e=t.inline,o=e?RM:TM,r=Ry(t)?UD:lD,i=F.none(),u=ln(),a=u.browser.isIE()?["tox-platform-ie"]:[],c=u.deviceType.isTouch()?["tox-platform-touch"]:[],s=Ay(t),f=Fy(t),l=hv.isRtl()?{attributes:{dir:"rtl"}}:{},d={attributes:(n={},n[bs]=s?Nc.BottomToTop:Nc.TopToBottom,n)},m=function(){return i.bind(xB.getHeader)},g=function(){qn(U.element,"width",document.body.clientWidth+"px")},h=Yu(function(){var t=gn(Nn(),f)&&"grid"===Jn(f,"display"),n={dom:T({tag:"div",classes:["tox","tox-silver-sink","tox-tinymce-aux"].concat(a).concat(c)},l),behaviours:gc([Ff.config({useFixed:function(){return r.isDocked(m)}})])},e={dom:{styles:{width:document.body.clientWidth+"px"}},events:Di([Mi(di(),g)])};return eo(n,t?e:{})}()),v=function(){return He.value(h)},b=ph({dom:{tag:"div",classes:["tox-anchorbar"]}}),y=function(){return i.bind((function(t){return xB.getThrobber(t)})).getOrDie("Could not find throbber element")},x=JE(h,t,(function(){return i.bind((function(t){return b.getOpt(t)})).getOrDie("Could not find a anchor bar element")})),w=xB.parts.menubar({dom:{tag:"div",classes:["tox-menubar"]},backstage:x,onEscape:function(){t.focus()}}),S=Ty(t),k=xB.parts.toolbar(T({dom:{tag:"div",classes:["tox-toolbar"]},getSink:v,providers:x.shared.providers,onEscape:function(){t.focus()},type:S,lazyToolbar:function(){return i.bind((function(t){return xB.getToolbar(t)})).getOrDie("Could not find more toolbar element")},lazyHeader:function(){return m().getOrDie("Could not find header element")}},d)),C=xB.parts["multiple-toolbar"]({dom:{tag:"div",classes:["tox-toolbar-overlord"]},providers:x.shared.providers,onEscape:function(){t.focus()},type:S}),O=xB.parts.socket({dom:{tag:"div",classes:["tox-edit-area"]}}),_=xB.parts.sidebar({dom:{tag:"div",classes:["tox-sidebar"]}}),E=xB.parts.throbber({dom:{tag:"div",classes:["tox-throbber"]},backstage:x}),D=t.getParam("statusbar",!0,"boolean")&&!e?F.some(HI(t,x.shared.providers)):F.none(),A={dom:{tag:"div",classes:["tox-sidebar-wrap"]},components:[O,_]},B=Oy(t),M=ky(t),I=Sy(t),R=xB.parts.header({dom:T({tag:"div",classes:["tox-editor-header"]},d),components:J([I?[w]:[],B?[C]:M?[k]:[],My(t)?[]:[b.asSpec()]]),sticky:Ry(t),editor:t,sharedBackstage:x.shared}),N=J([s?[]:[R],e?[]:[A],s?[R]:[]]),P=J([[{dom:{tag:"div",classes:["tox-editor-container"]},components:N}],e?[]:D.toArray(),[E]]),V=Iy(t),H=T(T({role:"application"},hv.isRtl()?{dir:"rtl"}:{}),V?{"aria-hidden":"true"}:{}),L=Yu(xB.sketch({dom:{tag:"div",classes:["tox","tox-tinymce"].concat(e?["tox-tinymce-inline"]:[]).concat(s?["tox-tinymce--toolbar-bottom"]:[]).concat(c).concat(a),styles:T({visibility:"hidden"},V?{opacity:"0",border:"0"}:{}),attributes:H},components:P,behaviours:gc([Wy(),Gd.config({disableClass:"tox-tinymce--disabled"}),$g.config({mode:"cyclic",selector:".tox-menubar, .tox-toolbar, .tox-toolbar__primary, .tox-toolbar__overflow--open, .tox-sidebar__overflow--open, .tox-statusbar__path, .tox-statusbar__wordcount, .tox-statusbar__branding a, .tox-statusbar__resize-handle"})])}));i=F.some(L),t.shortcuts.add("alt+F9","focus menubar",(function(){xB.focusMenubar(L)})),t.shortcuts.add("alt+F10","focus toolbar",(function(){xB.focusToolbar(L)})),t.addCommand("ToggleToolbarDrawer",(function(){xB.toggleToolbarDrawer(L)})),t.addQueryStateHandler("ToggleToolbarDrawer",(function(){return xB.isToolbarDrawerToggled(L)}));var z=qw(L),U=qw(h);$E(t,z,U);var j=function(){var n=DM(BM(t)),e=DM(function(t){return MM(t).getOr(vy(t))}(t));return t.inline||(te("div","width",e)&&qn(L.element,"width",e),te("div","height",n)?qn(L.element,"height",n):qn(L.element,"height","200px")),n};return{mothership:z,uiMothership:U,backstage:x,renderUI:function(){r.setup(t,x.shared,m),wF(t,x),jF(t,v,x),yA(t),MA(t,y,x.shared),dt(function(t){return t.getParam("toolbar_groups",{},"object")}(t),(function(n,e){t.ui.registry.addGroupToolbarButton(e,n)}));var n=t.ui.registry.getAll(),e=n.buttons,i=n.menuItems,u=n.contextToolbars,a=n.sidebars,c=Cy(t),s={menuItems:i,menus:Ny(t),menubar:Py(t),toolbar:c.getOrThunk((function(){return function(t){return t.getParam("toolbar",!0)}(t)})),allowToolbarGroups:S===mb.floating,buttons:e,sidebar:a};rF(t,u,h,{backstage:x}),II(t,h);var f=t.getElement(),l=j(),d={mothership:z,uiMothership:U,outerContainer:L},g={targetNode:f,height:l};return o.render(t,d,s,x,g)},getUi:function(){return{channels:{broadcastAll:U.broadcast,broadcastOn:U.broadcastOn,register:p}}}}},zI=b([jo("lazySink"),Qo("dragBlockClass"),dr("getBounds",Ne),ur("useTabstopAt",O),ur("eventOrder",{}),kl("modalBehaviours",[$g]),Sa("onExecute"),Ca("onEscape")]),UI={sketch:y},jI=b([td({name:"draghandle",overrides:function(t,n){return{behaviours:gc([AI.config({mode:"mouse",getTarget:function(t){return na(t,'[role="dialog"]').getOr(t)},blockerClass:t.dragBlockClass.getOrDie(new Error("The drag blocker class was not specified for a dialog with a drag handle: \n"+JSON.stringify(n,null,2)).message),getBounds:t.getDragBounds})])}}}),Ql({schema:[jo("dom")],name:"title"}),Ql({factory:UI,schema:[jo("dom")],name:"close"}),Ql({factory:UI,schema:[jo("dom")],name:"body"}),td({factory:UI,schema:[jo("dom")],name:"footer"}),Zl({factory:{sketch:function(t,n){return T(T({},t),{dom:n.dom,components:n.components})}},schema:[ur("dom",{tag:"div",styles:{position:"fixed",left:"0px",top:"0px",right:"0px",bottom:"0px"}}),ur("components",[])],name:"blocker"})]),WI=Td({name:"ModalDialog",configFields:zI(),partFields:jI(),factory:function(t,n,e,o){var r,i=qc(),u=Qi("modal-events"),a=T(T({},t.eventOrder),((r={})[mi()]=[u].concat(t.eventOrder["alloy.system.attached"]||[]),r));return{uid:t.uid,dom:t.dom,components:n,apis:{show:function(n){i.set(n);var e=t.lazySink(n).getOrDie(),r=o.blocker(),u=e.getSystem().build(T(T({},r),{components:r.components.concat([Ku(n)]),behaviours:gc([sp.config({}),rp("dialog-blocker-events",[Hi(Hr(),(function(){$g.focusIn(n)}))])])}));Vf(e,u),$g.focusIn(n)},hide:function(t){i.clear(),wn(t.element).each((function(n){t.getSystem().getByDom(n).each((function(t){zf(t)}))}))},getBody:function(n){return md(n,t,"body")},getFooter:function(n){return md(n,t,"footer")},setIdle:function(t){DA.unblock(t)},setBusy:function(t,n){DA.block(t,n)}},eventOrder:a,domModification:{attributes:{role:"dialog","aria-modal":"true"}},behaviours:Ol(t.modalBehaviours,[op.config({}),$g.config({mode:"cyclic",onEnter:t.onExecute,onEscape:t.onEscape,useTabstopAt:t.useTabstopAt}),DA.config({getRoot:i.get}),rp(u,[Li((function(n){(function(t,n){var e=Un(t,"id").fold((function(){var t=Qi("dialog-label");return Hn(n,"id",t),t}),y);Hn(t,"aria-labelledby",e)})(n.element,md(n,t,"title").element),function(t,n){var e=F.from(zn(t,"id")).fold((function(){var t=Qi("dialog-describe");return Hn(n,"id",t),t}),y);Hn(t,"aria-describedby",e)}(n.element,md(n,t,"body").element)}))])])}},apis:{show:function(t,n){t.show(n)},hide:function(t,n){t.hide(n)},getBody:function(t,n){return t.getBody(n)},getFooter:function(t,n){return t.getFooter(n)},setBusy:function(t,n,e){t.setBusy(n,e)},setIdle:function(t,n){t.setIdle(n)}}}),GI=yo([Xo("type"),Xo("name")].concat(Xb)),XI=To,qI=[Lo("name","name",ro((function(){return Qi("button-name")})),_o),nr("icon"),fr("align","end",["start","end"]),lr("primary",!1),lr("disabled",!1)],YI=D(D([],qI,!0),[Xo("text")],!1),KI=D([qo("type",["submit","cancel","custom"])],YI,!0),JI=D([qo("type",["menu"]),nr("text"),nr("tooltip"),nr("icon"),$o("items",GI)],qI,!0),$I=Ho("type",{submit:KI,cancel:KI,custom:KI,menu:JI}),QI=[Xo("type"),Xo("text"),qo("level",["info","warn","error","success"]),Xo("icon"),ur("url","")],ZI=yo(QI),tR=function(t){return[Xo("type"),t]},nR=[Xo("type"),Xo("text"),lr("disabled",!1),lr("primary",!1),Lo("name","name",ro((function(){return Qi("button-name")})),_o),nr("icon"),lr("borderless",!1)],eR=yo(nR),oR=[Xo("type"),Xo("name"),Xo("label"),lr("disabled",!1)],rR=yo(oR),iR=To,uR=[Xo("type"),Xo("name")],aR=uR.concat([nr("label")]),cR=aR.concat([ur("columns","auto")]),sR=yo(cR),fR=So([Xo("value"),Xo("text"),Xo("icon")]),lR=yo(aR),dR=_o,mR=yo(aR),gR=_o,pR=uR.concat([sr("tag","textarea"),Xo("scriptId"),Xo("scriptUrl"),function(t,n){return ar(t,n,Ao)}("settings",void 0)]),hR=uR.concat([sr("tag","textarea"),Yo("init")]),vR=Fo((function(t){return Ro("customeditor.old",bo(hR),t).orThunk((function(){return Ro("customeditor.new",bo(pR),t)}))})),bR=_o,yR=yo(aR),xR=xo(mo),wR=function(t){return[Xo("type"),Go("columns"),t]},SR=[Xo("type"),Xo("html"),fr("presets","presentation",["presentation","document"])],kR=yo(SR),CR=aR.concat([lr("sandboxed",!0)]),OR=yo(CR),_R=_o,TR=aR.concat([Wo("currentState",yo([jo("blob"),Xo("url")]))]),ER=yo(TR),DR=aR.concat([nr("inputMode"),nr("placeholder"),lr("maximized",!1),lr("disabled",!1)]),AR=yo(DR),BR=_o,MR=function(t){return[Xo("type"),Xo("label"),t]},FR=[Xo("text"),Xo("value")],IR=[Xo("text"),$o("items",function(t,n){return function(t,n){var e=zt(n);return{extract:function(t,n){return e().extract(t,n)},toString:function(){return e().toString()}}}(0,n)}(0,(function(){return RR})))],RR=wo([yo(FR),yo(IR)]),NR=aR.concat([$o("items",RR),lr("disabled",!1)]),PR=yo(NR),VR=_o,HR=aR.concat([Jo("items",[Xo("text"),Xo("value")]),cr("size",1),lr("disabled",!1)]),LR=yo(HR),zR=_o,UR=aR.concat([lr("constrain",!0),lr("disabled",!1)]),jR=yo(UR),WR=yo([Xo("width"),Xo("height")]),GR=[Xo("type"),$o("header",_o),$o("cells",xo(_o))],XR=yo(GR),qR=aR.concat([nr("placeholder"),lr("maximized",!1),lr("disabled",!1)]),YR=yo(qR),KR=_o,JR=aR.concat([fr("filetype","file",["image","media","file"]),ur("disabled",!1)]),$R=yo(JR),QR=yo([Xo("value"),ur("meta",{})]),ZR=function(t){return Lo("items","items",{tag:"required",process:{}},xo(Fo((function(n){return Ro("Checking item of "+t,tN,n).fold((function(t){return He.error(Vo(t))}),(function(t){return He.value(t)}))}))))},tN=vo((function(){return Mo("type",{alertbanner:ZI,bar:yo(tR(ZR("bar"))),button:eR,checkbox:rR,colorinput:lR,colorpicker:mR,dropzone:yR,grid:yo(wR(ZR("grid"))),iframe:OR,input:AR,listbox:PR,selectbox:LR,sizeinput:jR,textarea:YR,urlinput:$R,customeditor:vR,htmlpanel:kR,imagetools:ER,collection:sR,label:yo(MR(ZR("label"))),table:XR,panel:eN})})),nN=[Xo("type"),ur("classes",[]),$o("items",tN)],eN=yo(nN),oN=[Lo("name","name",ro((function(){return Qi("tab-name")})),_o),Xo("title"),$o("items",tN)],rN=[Xo("type"),Jo("tabs",oN)],iN=yo(rN),uN=YI,aN=$I,cN=yo([Xo("title"),Wo("body",Mo("type",{panel:eN,tabpanel:iN})),sr("size","normal"),$o("buttons",aN),ur("initialData",{}),dr("onAction",p),dr("onChange",p),dr("onSubmit",p),dr("onClose",p),dr("onCancel",p),ur("onTabChange",p)]),sN=yo(D([qo("type",["cancel","custom"])],uN,!0)),fN=yo([Xo("title"),Xo("url"),tr("height"),tr("width"),or("buttons",sN),dr("onAction",p),dr("onCancel",p),dr("onClose",p),dr("onMessage",p)]),lN=function(t){return i(t)?[t].concat($(vt(t),lN)):u(t)?$(t,lN):[]},dN=function(t){return r(t.type)&&r(t.name)},mN={checkbox:iR,colorinput:dR,colorpicker:gR,dropzone:xR,input:BR,iframe:_R,sizeinput:WR,selectbox:zR,listbox:VR,size:WR,textarea:KR,urlinput:QR,customeditor:bR,collection:fR,togglemenuitem:XI},gN=function(t){var n=function(t){return G(lN(t),dN)}(t),e=$(n,(function(t){return function(t){return F.from(mN[t.type])}(t).fold((function(){return[]}),(function(n){return[Wo(t.name,n)]}))}));return yo(e)},pN=function(t){return{internalDialog:No(function(t){return Ro("dialog",cN,t)}(t)),dataValidator:gN(t),initialData:t.initialData}},hN={open:function(t,n){var e=pN(n);return t(e.internalDialog,e.initialData,e.dataValidator)},openUrl:function(t,n){return t(No(function(t){return Ro("dialog",fN,t)}(n)))},redial:function(t){return pN(t)}},vN=function(t){var n=[],e={};return lt(t,(function(t,o){t.fold((function(){n.push(o)}),(function(t){e[o]=t}))})),n.length>0?He.error(n):He.value(e)},bN=function(t,n){var e=ph(tO.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"].concat(t.classes)},components:U(t.items,(function(t){return eE(e,t,n)}))}})));return{dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[e.asSpec()]}],behaviours:gc([$g.config({mode:"acyclic",useTabstopAt:S(DO)}),sO(e),bO(e,{postprocess:function(t){return vN(t).fold((function(t){return console.error(t),{}}),y)}})])}},yN=_d({name:"TabButton",configFields:[ur("uid",void 0),jo("value"),Lo("dom","dom",uo((function(){return{attributes:{role:"tab",id:Qi("aria"),"aria-selected":"false"}}})),ko()),Qo("action"),ur("domModification",{}),kl("tabButtonBehaviours",[sp,$g,Sl]),jo("view")],factory:function(t,n){return{uid:t.uid,dom:t.dom,components:t.components,events:kp(t.action),behaviours:Ol(t.tabButtonBehaviours,[sp.config({}),$g.config({mode:"execution",useSpace:!0,useEnter:!0}),Sl.config({store:{mode:"memory",initialValue:t.value}})]),domModification:t.domModification}}}),xN=b([jo("tabs"),jo("dom"),ur("clickToDismiss",!1),kl("tabbarBehaviours",[em,$g]),ya(["tabClass","selectedClass"])]),wN=nd({factory:yN,name:"tabs",unit:"tab",overrides:function(t){var n=function(t,n){em.dehighlight(t,n),Ci(t,xi(),{tabbar:t,button:n})},e=function(t,n){em.highlight(t,n),Ci(t,yi(),{tabbar:t,button:n})};return{action:function(o){var r=o.getSystem().getByUid(t.uid).getOrDie(),i=em.isHighlighted(r,o);(i&&t.clickToDismiss?n:i?p:e)(r,o)},domModification:{classes:[t.markers.tabClass]}}}}),SN=b([wN]),kN=Td({name:"Tabbar",configFields:xN(),partFields:SN(),factory:function(t,n,e,o){return{uid:t.uid,dom:t.dom,components:n,"debug.sketcher":"Tabbar",domModification:{attributes:{role:"tablist"}},behaviours:Ol(t.tabbarBehaviours,[em.config({highlightClass:t.markers.selectedClass,itemClass:t.markers.tabClass,onHighlight:function(t,n){Hn(n.element,"aria-selected","true")},onDehighlight:function(t,n){Hn(n.element,"aria-selected","false")}}),$g.config({mode:"flow",getInitial:function(t){return em.getHighlighted(t).map((function(t){return t.element}))},selector:"."+t.markers.tabClass,executeOnMove:!0})])}}}),CN=_d({name:"Tabview",configFields:[kl("tabviewBehaviours",[op])],factory:function(t,n){return{uid:t.uid,dom:t.dom,behaviours:Ol(t.tabviewBehaviours,[op.config({})]),domModification:{attributes:{role:"tabpanel"}}}}}),ON=b([ur("selectFirst",!0),wa("onChangeTab"),wa("onDismissTab"),ur("tabs",[]),kl("tabSectionBehaviours",[])]),_N=Ql({factory:kN,schema:[jo("dom"),Ko("markers",[jo("tabClass"),jo("selectedClass")])],name:"tabbar",defaults:function(t){return{tabs:t.tabs}}}),TN=Ql({factory:CN,name:"tabview"}),EN=b([_N,TN]),DN=Td({name:"TabSection",configFields:ON(),partFields:EN(),factory:function(t,n,e,o){var r=function(n){var e=Sl.getValue(n);dd(n,t,"tabview").each((function(o){Y(t.tabs,(function(t){return t.value===e})).each((function(e){var r=e.view();Un(n.element,"id").each((function(t){Hn(o.element,"aria-labelledby",t)})),op.set(o,r),t.onChangeTab(o,n,r)}))}))},i=function(n,e){dd(n,t,"tabbar").each((function(t){e(t).each(Oi)}))};return{uid:t.uid,dom:t.dom,components:n,behaviours:Cl(t.tabSectionBehaviours),events:Di(J([t.selectFirst?[Li((function(t,n){i(t,em.getFirst)}))]:[],[Mi(yi(),(function(t,n){var e=n.event.button;r(e)})),Mi(xi(),(function(n,e){var o=e.event.button;t.onDismissTab(n,o)}))]])),apis:{getViewItems:function(n){return dd(n,t,"tabview").map((function(t){return op.contents(t)})).getOr([])},showTab:function(t,n){i(t,(function(t){var e=em.getCandidates(t);return Y(e,(function(t){return Sl.getValue(t)===n})).filter((function(n){return!em.isHighlighted(t,n)}))}))}}}},apis:{getViewItems:function(t,n){return t.getViewItems(n)},showTab:function(t,n,e){t.showTab(n,e)}}}),AN=function(t,n){qn(t,"height",n+"px"),ln().browser.isIE()?ne(t,"flex-basis"):qn(t,"flex-basis",n+"px")},BN=function(t,n,e){na(t,'[role="dialog"]').each((function(t){oa(t,'[role="tablist"]').each((function(o){e.get().map((function(e){return qn(n,"height","0"),qn(n,"flex-basis","0"),Math.min(e,function(t,n,e){var o,r=yn(t).dom,i=na(t,".tox-dialog-wrap").getOr(t);o="fixed"===Jn(i,"position")?Math.max(r.clientHeight,window.innerHeight):Math.max(r.offsetHeight,r.scrollHeight);var u=ie(n),a=n.dom.offsetLeft>=e.dom.offsetLeft+me(e)?Math.max(ie(e),u):u,c=parseInt(Jn(t,"margin-top"),10)||0,s=parseInt(Jn(t,"margin-bottom"),10)||0;return o-(ie(t)+c+s-a)}(t,n,o))})).each((function(t){AN(n,t)}))}))}))},MN=function(t){return oa(t,'[role="tabpanel"]')},FN=function(t){return{smartTabHeight:function(){var n=qc(),e=[Li((function(e){var o=e.element;MN(o).each((function(r){qn(r,"visibility","hidden"),e.getSystem().getByDom(r).toOptional().each((function(e){(function(t){return it(ot(t,(function(t,n){return t>n?-1:t<n?1:0})))})(function(t,n,e){return U(t,(function(o,r){op.set(e,t[r].view());var i=n.dom.getBoundingClientRect();return op.set(e,[]),i.height}))}(t,r,e)).fold(n.clear,n.set)})),BN(o,r,n),ne(r,"visibility"),function(t,n){it(t).each((function(t){return DN.showTab(n,t.value)}))}(t,e),dh.requestAnimationFrame((function(){BN(o,r,n)}))}))})),Mi(di(),(function(t){var e=t.element;MN(e).each((function(t){BN(e,t,n)}))})),Mi(mS,(function(t,e){var o=t.element;MN(o).each((function(t){var e=Oc(An(t));qn(t,"visibility","hidden");var r=Qn(t,"height").map((function(t){return parseInt(t,10)}));ne(t,"height"),ne(t,"flex-basis");var i=t.dom.getBoundingClientRect().height;r.forall((function(t){return i>t}))?(n.set(i),BN(o,t,n)):r.each((function(n){AN(t,n)})),ne(t,"visibility"),e.each(kc)}))}))];return{extraEvents:e,selectFirst:!1}}(),naiveTabHeight:{extraEvents:[],selectFirst:!0}}},IN="send-data-to-section",RN="send-data-to-view",NN=function(t,n){var e=pr({}),o=function(t){var n=Sl.getValue(t),o=vN(n).getOr({}),r=e.get(),i=eo(r,o);e.set(i)},r=function(t){var n=e.get();Sl.setValue(t,n)},i=pr(null),u=U(t.tabs,(function(t){return{value:t.name,dom:{tag:"div",classes:["tox-dialog__body-nav-item"],innerHtml:n.shared.providers.translate(t.title)},view:function(){return[tO.sketch((function(e){return{dom:{tag:"div",classes:["tox-form"]},components:U(t.items,(function(t){return eE(e,t,n)})),formBehaviours:gc([$g.config({mode:"acyclic",useTabstopAt:S(DO)}),rp("TabView.form.events",[Li(r),zi(o)]),xc.config({channels:xr([{key:IN,value:{onReceive:o}},{key:RN,value:{onReceive:r}}])})])}}))]}}})),a=FN(u).smartTabHeight;return DN.sketch({dom:{tag:"div",classes:["tox-dialog__body"]},onChangeTab:function(t,n,e){var o=Sl.getValue(n);Ci(t,dS,{name:o,oldName:i.get()}),i.set(o)},tabs:u,components:[DN.parts.tabbar({dom:{tag:"div",classes:["tox-dialog__body-nav"]},components:[kN.parts.tabs({})],markers:{tabClass:"tox-tab",selectedClass:"tox-dialog__body-nav-item--active"},tabbarBehaviours:gc([Zw.config({})])}),DN.parts.tabview({dom:{tag:"div",classes:["tox-dialog__body-content"]}})],selectFirst:a.selectFirst,tabSectionBehaviours:gc([rp("tabpanel",a.extraEvents),$g.config({mode:"acyclic"}),Bd.config({find:function(t){return it(DN.getViewItems(t))}}),Sl.config({store:{mode:"manual",getValue:function(t){return t.getSystem().broadcastOn([IN],{}),e.get()},setValue:function(t,n){e.set(n),t.getSystem().broadcastOn([RN],{})}}})])})},PN=Qi("update-dialog"),VN=Qi("update-title"),HN=Qi("update-body"),LN=Qi("update-footer"),zN=Qi("body-send-message"),UN=function(t,n,e,o){return{dom:{tag:"div",classes:["tox-dialog__content-js"],attributes:T(T({},n.map((function(t){return{id:t}})).getOr({})),o?{"aria-live":"polite"}:{})},components:[],behaviours:gc([fO(0),eM.config({channel:HN,updateState:function(t,n){return F.some({isTabPanel:function(){return"tabpanel"===n.body.type}})},renderComponents:function(t){switch(t.body.type){case"tabpanel":return[NN(t.body,e)];default:return[bN(t.body,e)]}},initialData:t})])}},jN=ox.deviceType.isTouch(),WN=function(t,n){return{dom:{tag:"div",styles:{display:"none"},classes:["tox-dialog__header"]},components:[t,n]}},GN=function(t,n){return WI.parts.close(mh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":n.translate("Close")}},action:t,buttonBehaviours:gc([Zw.config({})])}))},XN=function(){return WI.parts.title({dom:{tag:"div",classes:["tox-dialog__title"],innerHtml:"",styles:{display:"none"}}})},qN=function(t,n){return WI.parts.body({dom:{tag:"div",classes:["tox-dialog__body"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-content"]},components:[{dom:gh("<p>"+pv(n.translate(t))+"</p>")}]}]})},YN=function(t){return WI.parts.footer({dom:{tag:"div",classes:["tox-dialog__footer"]},components:t})},KN=function(t,n){return[Xw.sketch({dom:{tag:"div",classes:["tox-dialog__footer-start"]},components:t}),Xw.sketch({dom:{tag:"div",classes:["tox-dialog__footer-end"]},components:n})]},JN=function(t){var n,e="tox-dialog",o=e+"-wrap",r=o+"__backdrop",i=e+"__disable-scroll";return WI.sketch({lazySink:t.lazySink,onEscape:function(n){return t.onEscape(n),F.some(!0)},useTabstopAt:function(t){return!DO(t)},dom:{tag:"div",classes:[e].concat(t.extraClasses),styles:T({position:"relative"},t.extraStyles)},components:D([t.header,t.body],t.footer.toArray(),!0),parts:{blocker:{dom:gh('<div class="'+o+'"></div>'),components:[{dom:{tag:"div",classes:jN?[r,r+"--opaque"]:[r]}}]}},dragBlockClass:o,modalBehaviours:gc(D([sp.config({}),rp("dialog-events",t.dialogEvents.concat([Hi(Hr(),(function(t,n){$g.focusIn(t)}))])),rp("scroll-lock",[Li((function(){Bu(Nn(),i)})),zi((function(){Fu(Nn(),i)}))])],t.extraBehaviours,!0)),eventOrder:T((n={},n[ei()]=["dialog-events"],n[mi()]=["scroll-lock","dialog-events","alloy.base.behaviour"],n[gi()]=["alloy.base.behaviour","dialog-events","scroll-lock"],n),t.eventOrder)})},$N=function(t){return mh.sketch({dom:{tag:"button",classes:["tox-button","tox-button--icon","tox-button--naked"],attributes:{type:"button","aria-label":t.translate("Close"),title:t.translate("Close")}},components:[Ov("close",{tag:"div",classes:["tox-icon"]},t.icons)],action:function(t){ki(t,aS)}})},QN=function(t,n,e){var o=function(t){return[Gu(e.translate(t.title))]};return{dom:{tag:"div",classes:["tox-dialog__title"],attributes:T({},n.map((function(t){return{id:t}})).getOr({}))},components:o(t),behaviours:gc([eM.config({channel:VN,renderComponents:o})])}},ZN=function(){return{dom:gh('<div class="tox-dialog__draghandle"></div>')}},tP=function(t,n){return function(t,n){var e=WI.parts.title(QN(t,F.none(),n)),o=WI.parts.draghandle(ZN()),r=WI.parts.close($N(n)),i=[e].concat(t.draggable?[o]:[]).concat([r]);return Xw.sketch({dom:gh('<div class="tox-dialog__header"></div>'),components:i})}({title:n.shared.providers.translate(t),draggable:n.dialog.isDraggableModal()},n.shared.providers)},nP=function(t,n,e){return{dom:{tag:"div",classes:["tox-dialog__busy-spinner"],attributes:{"aria-label":e.translate(t)},styles:{left:"0px",right:"0px",bottom:"0px",top:"0px",position:"absolute"}},behaviours:n,components:[{dom:gh('<div class="tox-spinner"><div></div><div></div><div></div></div>')}]}},eP=function(t,n,e){return{onClose:function(){return e.closeWindow()},onBlock:function(e){WI.setBusy(t(),(function(t,o){return nP(e.message,o,n)}))},onUnblock:function(){WI.setIdle(t())}}},oP=function(t,n,e,o){var r;return Yu(JN(T(T({},t),{lazySink:o.shared.getSink,extraBehaviours:D([eM.config({channel:PN,updateState:function(t,n){return F.some(n)},initialData:n}),wO({})],t.extraBehaviours,!0),onEscape:function(t){ki(t,aS)},dialogEvents:e,eventOrder:(r={},r[ni()]=[eM.name(),xc.name()],r[mi()]=["scroll-lock",eM.name(),"messages","dialog-events","alloy.base.behaviour"],r[gi()]=["alloy.base.behaviour","dialog-events","messages",eM.name(),"scroll-lock"],r)})))},rP=function(t){return U(t,(function(t){return"menu"===t.type?function(t){var n=U(t.items,(function(t){var n=pr(!1);return T(T({},t),{storage:n})}));return T(T({},t),{items:n})}(t):t}))},iP=function(t){return q(t,(function(t,n){return"menu"===n.type?q(n.items,(function(t,n){return t[n.name]=n.storage,t}),t):t}),{})},uP=function(t,n){return[Ni(Hr(),EO),t(uS,(function(t,e){n.onClose(),e.onClose()})),t(aS,(function(t,n,e,o){n.onCancel(t),ki(o,uS)})),Mi(lS,(function(t,e){return n.onUnblock()})),Mi(fS,(function(t,e){return n.onBlock(e.event)}))]},aP=function(t,n){var e=function(n,e){return Mi(n,(function(n,r){o(n,(function(o,i){e(t(),o,r.event,n)}))}))},o=function(t,n){eM.getState(t).get().each((function(e){n(e,t)}))};return D(D([],uP(e,n),!0),[e(cS,(function(t,n,e){n.onAction(t,{name:e.name})}))],!1)},cP=function(t,n,e){var o=function(n,e){return Mi(n,(function(n,o){r(n,(function(r,i){e(t(),r,o.event,n)}))}))},r=function(t,n){eM.getState(t).get().each((function(e){n(e.internalDialog,t)}))};return D(D([],uP(o,n),!0),[o(sS,(function(t,n){return n.onSubmit(t)})),o(iS,(function(t,n,e){n.onChange(t,{name:e.name})})),o(cS,(function(t,n,o,r){var i=function(){return $g.focusIn(r)},u=function(t){return jn(t,"disabled")||Un(t,"aria-disabled").exists((function(t){return"true"===t}))},a=An(r.element),c=Oc(a);n.onAction(t,{name:o.name,value:o.value}),Oc(a).fold(i,(function(t){u(t)||c.exists((function(n){return hn(t,n)&&u(n)}))?i():e().toOptional().filter((function(n){return!hn(n.element,t)})).each(i)}))})),o(dS,(function(t,n,e){n.onTabChange(t,{newTabName:e.name,oldTabName:e.oldName})})),zi((function(n){var e=t();Sl.setValue(n,e.getData())}))],!1)},sP=function(t,n){var e=n.map((function(t){return t.footerButtons})).getOr([]),o=W(e,(function(t){return"start"===t.align})),r=function(t,n){return Xw.sketch({dom:{tag:"div",classes:["tox-dialog__footer-"+t]},components:U(n,(function(t){return t.memento.asSpec()}))})};return[r("start",o.pass),r("end",o.fail)]},fP=function(t,n){return{dom:gh('<div class="tox-dialog__footer"></div>'),components:[],behaviours:gc([eM.config({channel:LN,initialData:t,updateState:function(t,e){var o=U(e.buttons,(function(t){var e=ph(function(t,n){return W_(t,t.type,n)}(t,n));return{name:t.name,align:t.align,memento:e}}));return F.some({lookupByName:function(t,n){return function(t,n,e){return Y(n,(function(t){return t.name===e})).bind((function(n){return n.memento.getOpt(t)}))}(t,o,n)},footerButtons:o})},renderComponents:sP})])}},lP=function(t,n){return WI.parts.footer(fP(t,n))},dP=function(t,n){if(t.getRoot().getSystem().isConnected()){var e=Bd.getCurrent(t.getFormWrapper()).getOr(t.getFormWrapper());return tO.getField(e,n).fold((function(){var o=t.getFooter();return eM.getState(o).get().bind((function(t){return t.lookupByName(e,n)}))}),(function(t){return F.some(t)}))}return F.none()},mP=function(t,n,e){var o=function(n){var e=t.getRoot();e.getSystem().isConnected()&&n(e)},i={getData:function(){var n=t.getRoot(),o=n.getSystem().isConnected()?t.getFormWrapper():n,r=Sl.getValue(o),i=dt(e,(function(t){return t.get()}));return T(T({},r),i)},setData:function(n){o((function(o){var r=i.getData(),u=T(T({},r),n),a=function(t,n){var e=t.getRoot();return eM.getState(e).get().map((function(t){return No(Ro("data",t.dataValidator,n))})).getOr(n)}(t,u),c=t.getFormWrapper();Sl.setValue(c,a),lt(e,(function(t,n){yt(u,n)&&t.set(u[n])}))}))},disable:function(n){dP(t,n).each(Gd.disable)},enable:function(n){dP(t,n).each(Gd.enable)},focus:function(n){dP(t,n).each(sp.focus)},block:function(t){if(!r(t))throw new Error("The dialogInstanceAPI.block function should be passed a blocking message of type string as an argument");o((function(n){Ci(n,fS,{message:t})}))},unblock:function(){o((function(t){ki(t,lS)}))},showTab:function(n){o((function(e){var o=t.getBody();eM.getState(o).get().exists((function(t){return t.isTabPanel()}))&&Bd.getCurrent(o).each((function(t){DN.showTab(t,n)}))}))},redial:function(t){o((function(e){var o=n(t);e.getSystem().broadcastOn([PN],o),e.getSystem().broadcastOn([VN],o.internalDialog),e.getSystem().broadcastOn([HN],o.internalDialog),e.getSystem().broadcastOn([LN],o.internalDialog),i.setData(o.initialData)}))},close:function(){o((function(t){ki(t,uS)}))}};return i},gP=function(t,n,e){var o=tP(t.internalDialog.title,e),r=function(t,n){var e=UN(t,F.none(),n,!1);return WI.parts.body(e)}({body:t.internalDialog.body},e),i=rP(t.internalDialog.buttons),u=iP(i),a=lP({buttons:i},e),c=cP((function(){return m}),eP((function(){return l}),e.shared.providers,n),e.shared.getSink),s=function(t){switch(t){case"large":return["tox-dialog--width-lg"];case"medium":return["tox-dialog--width-md"];default:return[]}}(t.internalDialog.size),f={header:o,body:r,footer:F.some(a),extraClasses:s,extraBehaviours:[],extraStyles:{}},l=oP(f,t,c,e),d={getRoot:b(l),getBody:function(){return WI.getBody(l)},getFooter:function(){return WI.getFooter(l)},getFormWrapper:function(){var t=WI.getBody(l);return Bd.getCurrent(t).getOr(t)}},m=mP(d,n.redial,u);return{dialog:l,instanceApi:m}},pP=function(t,n,e,o){var r,i,u=Qi("dialog-label"),a=Qi("dialog-content"),c=ph(function(t,n,e){return Xw.sketch({dom:gh('<div class="tox-dialog__header"></div>'),components:[QN(t,F.some(n),e),ZN(),$N(e)],containerBehaviours:gc([AI.config({mode:"mouse",blockerClass:"blocker",getTarget:function(t){return ra(t,'[role="dialog"]').getOrDie()},snaps:{getSnapPoints:function(){return[]},leftAttr:"data-drag-left",topAttr:"data-drag-top"}})])})}({title:t.internalDialog.title,draggable:!0},u,e.shared.providers)),s=ph(function(t,n,e,o){return UN(t,F.some(n),e,o)}({body:t.internalDialog.body},a,e,o)),f=rP(t.internalDialog.buttons),l=iP(f),d=ph(function(t,n){return fP(t,n)}({buttons:f},e)),m=cP((function(){return p}),{onBlock:function(t){DA.block(g,(function(n,o){return nP(t.message,o,e.shared.providers)}))},onUnblock:function(){DA.unblock(g)},onClose:function(){return n.closeWindow()}},e.shared.getSink),g=Yu({dom:{tag:"div",classes:["tox-dialog","tox-dialog-inline"],attributes:(r={role:"dialog"},r["aria-labelledby"]=u,r["aria-describedby"]=a,r)},eventOrder:(i={},i[ni()]=[eM.name(),xc.name()],i[ei()]=["execute-on-form"],i[mi()]=["reflecting","execute-on-form"],i),behaviours:gc([$g.config({mode:"cyclic",onEscape:function(t){return ki(t,uS),F.some(!0)},useTabstopAt:function(t){return!DO(t)&&("button"!==Rt(t)||"disabled"!==zn(t,"disabled"))}}),eM.config({channel:PN,updateState:function(t,n){return F.some(n)},initialData:t}),sp.config({}),rp("execute-on-form",m.concat([Hi(Hr(),(function(t,n){$g.focusIn(t)}))])),DA.config({getRoot:function(){return F.some(g)}}),op.config({}),wO({})]),components:[c.asSpec(),s.asSpec(),d.asSpec()]}),p=mP({getRoot:b(g),getFooter:function(){return d.get(g)},getBody:function(){return s.get(g)},getFormWrapper:function(){var t=s.get(g);return Bd.getCurrent(t).getOr(t)}},n.redial,l);return{dialog:g,instanceApi:p}},hP=tinymce.util.Tools.resolve("tinymce.util.URI"),vP=function(t){var n=function(n){t.getSystem().isConnected()&&n(t)};return{block:function(t){if(!r(t))throw new Error("The urlDialogInstanceAPI.block function should be passed a blocking message of type string as an argument");n((function(n){Ci(n,fS,{message:t})}))},unblock:function(){n((function(t){ki(t,lS)}))},close:function(){n((function(t){ki(t,uS)}))},sendMessage:function(t){n((function(n){n.getSystem().broadcastOn([zN],t)}))}}},bP=["insertContent","setContent","execCommand","close","block","unblock"],yP=function(t){return i(t)&&-1!==bP.indexOf(t.mceAction)},xP=function(t){return!yP(t)&&i(t)&&yt(t,"mceAction")},wP=function(t,n,e){switch(e.mceAction){case"insertContent":t.insertContent(e.content);break;case"setContent":t.setContent(e.content);break;case"execCommand":var o=!!c(e.ui)&&e.ui;t.execCommand(e.cmd,o,e.value);break;case"close":n.close();break;case"block":n.block(e.message);break;case"unblock":n.unblock()}},SP=function(t,n,e,o){var r,i=tP(t.title,o),u=function(t){var n={dom:{tag:"div",classes:["tox-dialog__content-js"]},components:[{dom:{tag:"div",classes:["tox-dialog__body-iframe"]},components:[_O({dom:{tag:"iframe",attributes:{src:t.url}},behaviours:gc([Zw.config({}),sp.config({})])})]}],behaviours:gc([$g.config({mode:"acyclic",useTabstopAt:S(DO)})])};return WI.parts.body(n)}(t),a=t.buttons.bind((function(t){return 0===t.length?F.none():F.some(lP({buttons:t},o))})),c=aP((function(){return h}),eP((function(){return p}),o.shared.providers,n)),s=T(T({},t.height.fold((function(){return{}}),(function(t){return{height:t+"px","max-height":t+"px"}}))),t.width.fold((function(){return{}}),(function(t){return{width:t+"px","max-width":t+"px"}}))),f=t.width.isNone()&&t.height.isNone()?["tox-dialog--width-lg"]:[],l=new hP(t.url,{base_uri:new hP(window.location.href)}),d=l.protocol+"://"+l.host+(l.port?":"+l.port:""),m=Xc(),g=[rp("messages",[Li((function(){var n=Kc(Ft.fromDom(window),"message",(function(n){if(l.isSameOrigin(new hP(n.raw.origin))){var o=n.raw.data;yP(o)?wP(e,h,o):xP(o)&&t.onMessage(h,o)}}));m.set(n)})),zi(m.clear)]),xc.config({channels:(r={},r[zN]={onReceive:function(t,n){oa(t.element,"iframe").each((function(t){t.dom.contentWindow.postMessage(n,d)}))}},r)})],p=oP({header:i,body:u,footer:a,extraClasses:f,extraBehaviours:g,extraStyles:s},t,c,o),h=vP(p);return{dialog:p,instanceApi:h}},kP=function(t,n,e){return n&&e?[]:[MD.config({contextual:{lazyContext:function(){return F.some(Ie(Ft.fromDom(t.getContentAreaContainer())))},fadeInClass:"tox-dialog-dock-fadein",fadeOutClass:"tox-dialog-dock-fadeout",transitionClass:"tox-dialog-dock-transition"},modes:["top"]})]},CP=function(t){var n=t.backstage,e=t.editor,o=Ry(e),r=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(){WI.hide(c),o()},i=ph(W_({name:"close-alert",text:"OK",primary:!0,align:"end",disabled:!1,icon:F.none()},"cancel",t.backstage)),u=XN(),a=GN(r,n.providers),c=Yu(JN({lazySink:function(){return n.getSink()},header:WN(u,a),body:qN(e,n.providers),footer:F.some(YN(KN([],[i.asSpec()]))),onEscape:r,extraClasses:["tox-alert-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Mi(aS,r)],eventOrder:{}}));WI.show(c);var s=i.get(c);sp.focus(s)}}}(t),i=function(t){var n=t.backstage.shared;return{open:function(e,o){var r=function(t){WI.hide(s),o(t)},i=ph(W_({name:"yes",text:"Yes",primary:!0,align:"end",disabled:!1,icon:F.none()},"submit",t.backstage)),u=W_({name:"no",text:"No",primary:!1,align:"end",disabled:!1,icon:F.none()},"cancel",t.backstage),a=XN(),c=GN((function(){return r(!1)}),n.providers),s=Yu(JN({lazySink:function(){return n.getSink()},header:WN(a,c),body:qN(e,n.providers),footer:F.some(YN(KN([],[u,i.asSpec()]))),onEscape:function(){return r(!1)},extraClasses:["tox-confirm-dialog"],extraBehaviours:[],extraStyles:{},dialogEvents:[Mi(aS,(function(){return r(!1)})),Mi(sS,(function(){return r(!0)}))],eventOrder:{}}));WI.show(s);var f=i.get(s);sp.focus(f)}}}(t),u=function(t,o){return hN.openUrl((function(t){var r=SP(t,{closeWindow:function(){WI.hide(r.dialog),o(r.instanceApi)}},e,n);return WI.show(r.dialog),r.instanceApi}),t)},a=function(t,e){return hN.open((function(t,o,r){var i=o,u=gP({dataValidator:r,initialData:i,internalDialog:t},{redial:hN.redial,closeWindow:function(){WI.hide(u.dialog),e(u.instanceApi)}},n);return WI.show(u.dialog),u.instanceApi.setData(i),u.instanceApi}),t)},c=function(t,r,i,u){return hN.open((function(t,a,c){var s=function(t,n){return No(Ro("data",n,t))}(a,c),f=qc(),l=n.shared.header.isPositionedAtTop(),d=function(){return f.on((function(t){Xp.reposition(t),MD.refresh(t)}))},m=pP({dataValidator:c,initialData:s,internalDialog:t},{redial:hN.redial,closeWindow:function(){f.on(Xp.hide),e.off("ResizeEditor",d),f.clear(),i(m.instanceApi)}},n,u),g=Yu(Xp.sketch(T(T({lazySink:n.shared.getSink,dom:{tag:"div",classes:[]},fireDismissalEventInstead:{}},l?{}:{fireRepositionEventInstead:{}}),{inlineBehaviours:gc(D([rp("window-manager-inline-events",[Mi(pi(),(function(t,n){ki(m.dialog,aS)}))])],kP(e,o,l),!0)),isExtraPart:function(t,n){return function(t){return Mw(t,".tox-alert-dialog")||Mw(t,".tox-confirm-dialog")}(n)}})));return f.set(g),Xp.showWithin(g,Ku(m.dialog),{anchor:r},F.some(Nn())),o&&l||(MD.refresh(g),e.on("ResizeEditor",d)),m.instanceApi.setData(s),$g.focusIn(m.dialog),m.instanceApi}),t)};return{open:function(t,e,o){return void 0!==e&&"toolbar"===e.inline?c(t,n.shared.anchors.inlineDialog(),o,e.ariaAttrs):void 0!==e&&"cursor"===e.inline?c(t,n.shared.anchors.cursor(),o,e.ariaAttrs):a(t,o)},openUrl:function(t,n){return u(t,n)},alert:function(t,n){r.open(t,(function(){n()}))},close:function(t){t.close()},confirm:function(t,n){i.open(t,(function(t){n(t)}))}}};_.add("silver",(function(t){var n=LI(t),e=n.uiMothership,o=n.backstage,r=n.renderUI,i=n.getUi;Bw(t,o.shared);var u=CP({editor:t,backstage:o});return{renderUI:r,getWindowManagerImpl:b(u),getNotificationManagerImpl:function(){return Ev(t,{backstage:o},e)},ui:i()}}))}()}).call(this,e("c8ba"))}}]);